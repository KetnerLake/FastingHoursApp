var ev=Object.defineProperty;var Qc=t=>{throw TypeError(t)};var tv=(t,e,n)=>e in t?ev(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Xc=(t,e,n)=>tv(t,typeof e!="symbol"?e+"":e,n),Aa=(t,e,n)=>e.has(t)||Qc("Cannot "+n);var Bn=(t,e,n)=>(Aa(t,e,"read from private field"),n?n.call(t):e.get(t)),Li=(t,e,n)=>e.has(t)?Qc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Oa=(t,e,n,r)=>(Aa(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Zc=(t,e,n)=>(Aa(t,e,"access private method"),n);import"../chunks/Bzak7iHL.js";import{i as nv,c as rv,d as _t,n as iv,a as ov,o as Gn,b as sv,s as Re}from"../chunks/CTKRTV8e.js";import{T as Hl,aB as Nf,aC as av,j as Ff,b as Vl,g as ts,h as Nt,Y as Wi,d as al,y as _,A as lv,r as cv,H as uv,e as $c,i as Yi,o as Dr,Z as Bf,a1 as fv,k as no,m as dv,l as Yr,aD as eu,ax as hv,aE as tu,a5 as Kf,aF as Ls,n as qf,p as pv,aG as Rs,aH as vv,aI as Ma,aJ as ro,$ as Hf,aK as gv,a4 as yv,aL as mv,D as Vf,aM as zf,u as bv,aN as wv,at as qe,aO as _v,a2 as kv,a0 as Sv,a9 as nu,aP as xv,q as zl,aQ as Ev,aR as Cv,aS as Iv,aT as Dv,aU as Tv,aV as Av,aW as Ov,aX as Mv,aY as Pv,aZ as jv,a_ as Lv,U as Rv,a$ as Uv,b0 as Nv,v as Wf,t as Fv,b1 as Bv,a7 as ht,c as Ft,f as ut,a as pe,aa as pt,C as X,ay as Ce,az as Ke,b2 as Kv,b3 as yo,au as V,av as K,as as Le,aw as Q,b4 as Ar,b5 as Yf,B as zo}from"../chunks/MoBfWj5a.js";import{i as st,r as qv,p as Oe,b as yt}from"../chunks/dbYhXwBz.js";const Hv=[];function Ri(t,e=!1,n=!1){return ns(t,new Map,"",Hv,null,n)}function ns(t,e,n,r,i=null,o=!1){if(typeof t=="object"&&t!==null){var a=e.get(t);if(a!==void 0)return a;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(Hl(t)){var l=Array(t.length);e.set(t,l),i!==null&&e.set(i,l);for(var u=0;u<t.length;u+=1){var d=t[u];u in t&&(l[u]=ns(d,e,n,r,null,o))}return l}if(Nf(t)===av){l={},e.set(t,l),i!==null&&e.set(i,l);for(var f in t)l[f]=ns(t[f],e,n,r,null,o);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!o)return ns(t.toJSON(),e,n,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}function Jt(t,e){return e}function Vv(t,e,n){for(var r=t.items,i=[],o=e.length,a=0;a<o;a++)gv(e[a].e,i,!0);var l=o>0&&i.length===0&&n!==null;if(l){var u=n.parentNode;yv(u),u.append(n),r.clear(),Dn(t,e[0].prev,e[o-1].next)}mv(i,()=>{for(var d=0;d<o;d++){var f=e[d];l||(r.delete(f.k),Dn(t,f.prev,f.next)),ro(f.e,!l)}})}function Qt(t,e,n,r,i,o=null){var a=t,l={flags:e,items:new Map,first:null},u=(e&zf)!==0;if(u){var d=t;a=Nt?ts(Wi(d)):d.appendChild(Ff())}Nt&&al();var f=null,p=!1,v=new Map,y=lv(()=>{var I=n();return Hl(I)?I:I==null?[]:Kf(I)}),b,k;function x(){zv(k,b,l,v,a,i,e,r,n),o!==null&&(b.length===0?f?qf(f):f=no(()=>o(a)):f!==null&&pv(f,()=>{f=null}))}Vl(()=>{k??(k=Vf),b=_(y);var I=b.length;if(p&&I===0)return;p=I===0;let E=!1;if(Nt){var S=cv(a)===uv;S!==(I===0)&&(a=$c(),ts(a),Yi(!1),E=!0)}if(Nt){for(var D=null,j,O=0;O<I;O++){if(Dr.nodeType===Bf&&Dr.data===fv){a=Dr,E=!0,Yi(!1);break}var M=b[O],ie=r(M,O);j=ll(Dr,l,D,null,M,ie,O,i,e,n),l.items.set(ie,j),D=j}I>0&&ts($c())}if(Nt)I===0&&o&&(f=no(()=>o(a)));else if(dv()){var ne=new Set,re=Yr;for(O=0;O<I;O+=1){M=b[O],ie=r(M,O);var W=l.items.get(ie)??v.get(ie);W?(e&(Rs|Ls))!==0&&Gf(W,M,O,e):(j=ll(null,l,null,null,M,ie,O,i,e,n,!0),v.set(ie,j)),ne.add(ie)}for(const[le,ce]of l.items)ne.has(le)||re.skipped_effects.add(ce.e);re.add_callback(x)}else x();E&&Yi(!0),_(y)}),Nt&&(a=Dr)}function zv(t,e,n,r,i,o,a,l,u){var ge,_e,G,U;var d=(a&wv)!==0,f=(a&(Rs|Ls))!==0,p=e.length,v=n.items,y=n.first,b=y,k,x=null,I,E=[],S=[],D,j,O,M;if(d)for(M=0;M<p;M+=1)D=e[M],j=l(D,M),O=v.get(j),O!==void 0&&((ge=O.a)==null||ge.measure(),(I??(I=new Set)).add(O));for(M=0;M<p;M+=1){if(D=e[M],j=l(D,M),O=v.get(j),O===void 0){var ie=r.get(j);if(ie!==void 0){r.delete(j),v.set(j,ie);var ne=x?x.next:b;Dn(n,x,ie),Dn(n,ie,ne),Pa(ie,ne,i),x=ie}else{var re=b?b.e.nodes_start:i;x=ll(re,n,x,x===null?n.first:x.next,D,j,M,o,a,u)}v.set(j,x),E=[],S=[],b=x.next;continue}if(f&&Gf(O,D,M,a),(O.e.f&Ma)!==0&&(qf(O.e),d&&((_e=O.a)==null||_e.unfix(),(I??(I=new Set)).delete(O))),O!==b){if(k!==void 0&&k.has(O)){if(E.length<S.length){var W=S[0],le;x=W.prev;var ce=E[0],Ie=E[E.length-1];for(le=0;le<E.length;le+=1)Pa(E[le],W,i);for(le=0;le<S.length;le+=1)k.delete(S[le]);Dn(n,ce.prev,Ie.next),Dn(n,x,ce),Dn(n,Ie,W),b=W,x=Ie,M-=1,E=[],S=[]}else k.delete(O),Pa(O,b,i),Dn(n,O.prev,O.next),Dn(n,O,x===null?n.first:x.next),Dn(n,x,O),x=O;continue}for(E=[],S=[];b!==null&&b.k!==j;)(b.e.f&Ma)===0&&(k??(k=new Set)).add(b),S.push(b),b=b.next;if(b===null)continue;O=b}E.push(O),x=O,b=O.next}if(b!==null||k!==void 0){for(var De=k===void 0?[]:Kf(k);b!==null;)(b.e.f&Ma)===0&&De.push(b),b=b.next;var te=De.length;if(te>0){var $=(a&zf)!==0&&p===0?i:null;if(d){for(M=0;M<te;M+=1)(G=De[M].a)==null||G.measure();for(M=0;M<te;M+=1)(U=De[M].a)==null||U.fix()}Vv(n,De,$)}}d&&bv(()=>{var Y;if(I!==void 0)for(O of I)(Y=O.a)==null||Y.apply()}),t.first=n.first&&n.first.e,t.last=x&&x.e;for(var se of r.values())ro(se.e);r.clear()}function Gf(t,e,n,r){(r&Rs)!==0&&eu(t.v,e),(r&Ls)!==0?eu(t.i,n):t.i=n}function ll(t,e,n,r,i,o,a,l,u,d,f){var p=(u&Rs)!==0,v=(u&vv)===0,y=p?v?hv(i,!1,!1):tu(i):i,b=(u&Ls)===0?a:tu(a),k={i:b,v:y,k:o,a:null,e:null,prev:n,next:r};try{if(t===null){var x=document.createDocumentFragment();x.append(t=Ff())}return k.e=no(()=>l(t,y,b,d),Nt),k.e.prev=n&&n.e,k.e.next=r&&r.e,n===null?f||(e.first=k):(n.next=k,n.e.next=k.e),r!==null&&(r.prev=k,r.e.prev=k.e),k}finally{}}function Pa(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,o=t.e.nodes_start;o!==null&&o!==r;){var a=Hf(o);i.before(o),o=a}}function Dn(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function Wv(t,e,n=!1,r=!1,i=!1){var o=t,a="";qe(()=>{var l=Vf;if(a===(a=e()??"")){Nt&&al();return}if(l.nodes_start!==null&&(_v(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),a!==""){if(Nt){Dr.data;for(var u=al(),d=u;u!==null&&(u.nodeType!==Bf||u.data!=="");)d=u,u=Hf(u);if(u===null)throw kv(),Sv;nu(Dr,d),o=ts(u);return}var f=a+"";n?f=`<svg>${f}</svg>`:r&&(f=`<math>${f}</math>`);var p=xv(f);if((n||r)&&(p=Wi(p)),nu(Wi(p),p.lastChild),n||r)for(;Wi(p);)o.before(Wi(p));else o.before(p)}})}function Yv(t,e){var n=void 0,r;Vl(()=>{n!==(n=e())&&(r&&(ro(r),r=null),n&&(r=no(()=>{zl(()=>n(t))})))})}function Jf(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=Jf(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Gv(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=Jf(t))&&(r&&(r+=" "),r+=e);return r}function Jv(t){return typeof t=="object"?Gv(t):t??""}const ru=[...` 	
\r\f \v\uFEFF`];function Qv(t,e,n){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var o=i.length,a=0;(a=r.indexOf(i,a))>=0;){var l=a+o;(a===0||ru.includes(r[a-1]))&&(l===r.length||ru.includes(r[l]))?r=(a===0?"":r.substring(0,a))+r.substring(l+1):a=l}}return r===""?null:r}function iu(t,e=!1){var n=e?" !important;":";",r="";for(var i in t){var o=t[i];o!=null&&o!==""&&(r+=" "+i+": "+o+n)}return r}function ja(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Xv(t,e){if(e){var n="",r,i;if(Array.isArray(e)?(r=e[0],i=e[1]):r=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,a=0,l=!1,u=[];r&&u.push(...Object.keys(r).map(ja)),i&&u.push(...Object.keys(i).map(ja));var d=0,f=-1;const k=t.length;for(var p=0;p<k;p++){var v=t[p];if(l?v==="/"&&t[p-1]==="*"&&(l=!1):o?o===v&&(o=!1):v==="/"&&t[p+1]==="*"?l=!0:v==='"'||v==="'"?o=v:v==="("?a++:v===")"&&a--,!l&&o===!1&&a===0){if(v===":"&&f===-1)f=p;else if(v===";"||p===k-1){if(f!==-1){var y=ja(t.substring(d,f).trim());if(!u.includes(y)){v!==";"&&p++;var b=t.substring(d,p).trim();n+=" "+b+";"}}d=p+1,f=-1}}}}return r&&(n+=iu(r)),i&&(n+=iu(i,!0)),n=n.trim(),n===""?null:n}return t==null?null:String(t)}function at(t,e,n,r,i,o){var a=t.__className;if(Nt||a!==n||a===void 0){var l=Qv(n,r,o);(!Nt||l!==t.getAttribute("class"))&&(l==null?t.removeAttribute("class"):e?t.className=l:t.setAttribute("class",l)),t.__className=n}else if(o&&i!==o)for(var u in o){var d=!!o[u];(i==null||d!==!!i[u])&&t.classList.toggle(u,d)}return o}function La(t,e={},n,r){for(var i in n){var o=n[i];e[i]!==o&&(n[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,r))}}function Qr(t,e,n,r){var i=t.__style;if(Nt||i!==e){var o=Xv(e,r);(!Nt||o!==t.getAttribute("style"))&&(o==null?t.removeAttribute("style"):t.style.cssText=o),t.__style=e}else r&&(Array.isArray(r)?(La(t,n==null?void 0:n[0],r[0]),La(t,n==null?void 0:n[1],r[1],"important")):La(t,n,r));return r}function cl(t,e,n=!1){if(t.multiple){if(e==null)return;if(!Hl(e))return Ev();for(var r of t.options)r.selected=e.includes(ou(r));return}for(r of t.options){var i=ou(r);if(Cv(i,e)){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Zv(t){var e=new MutationObserver(()=>{cl(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Iv(()=>{e.disconnect()})}function ou(t){return"__value"in t?t.__value:t.value}const Ui=Symbol("class"),Ni=Symbol("style"),Qf=Symbol("is custom element"),Xf=Symbol("is html");function Us(t){if(Nt){var e=!1,n=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var r=t.value;Ct(t,"value",null),t.value=r}if(t.hasAttribute("checked")){var i=t.checked;Ct(t,"checked",null),t.checked=i}}};t.__on_r=n,Tv(n),Av()}}function Zf(t,e){var n=Wl(t);n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function $v(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function Ct(t,e,n,r){var i=Wl(t);Nt&&(i[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||i[e]!==(i[e]=n)&&(e==="loading"&&(t[Ov]=n),n==null?t.removeAttribute(e):typeof n!="string"&&$f(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function eg(t,e,n,r,i=!1){var o=Wl(t),a=o[Qf],l=!o[Xf];let u=Nt&&a;u&&Yi(!1);var d=e||{},f=t.tagName==="OPTION";for(var p in e)p in n||(n[p]=null);n.class?n.class=Jv(n.class):n[Ui]&&(n.class=null),n[Ni]&&(n.style??(n.style=null));var v=$f(t);for(const S in n){let D=n[S];if(f&&S==="value"&&D==null){t.value=t.__value="",d[S]=D;continue}if(S==="class"){var y=t.namespaceURI==="http://www.w3.org/1999/xhtml";at(t,y,D,r,e==null?void 0:e[Ui],n[Ui]),d[S]=D,d[Ui]=n[Ui];continue}if(S==="style"){Qr(t,D,e==null?void 0:e[Ni],n[Ni]),d[S]=D,d[Ni]=n[Ni];continue}var b=d[S];if(!(D===b&&!(D===void 0&&t.hasAttribute(S)))){d[S]=D;var k=S[0]+S[1];if(k!=="$$")if(k==="on"){const j={},O="$$"+S;let M=S.slice(2);var x=ov(M);if(nv(M)&&(M=M.slice(0,-7),j.capture=!0),!x&&b){if(D!=null)continue;t.removeEventListener(M,d[O],j),d[O]=null}if(D!=null)if(x)t[`__${M}`]=D,_t([M]);else{let ie=function(ne){d[S].call(this,ne)};d[O]=rv(M,t,ie,j)}else x&&(t[`__${M}`]=void 0)}else if(S==="style")Ct(t,S,D);else if(S==="autofocus")Lv(t,!!D);else if(!a&&(S==="__value"||S==="value"&&D!=null))t.value=t.__value=D;else if(S==="selected"&&f)$v(t,D);else{var I=S;l||(I=iv(I));var E=I==="defaultValue"||I==="defaultChecked";if(D==null&&!a&&!E)if(o[S]=null,I==="value"||I==="checked"){let j=t;const O=e===void 0;if(I==="value"){let M=j.defaultValue;j.removeAttribute(I),j.defaultValue=M,j.value=j.__value=O?M:null}else{let M=j.defaultChecked;j.removeAttribute(I),j.defaultChecked=M,j.checked=O?M:!1}}else t.removeAttribute(S);else E||v.includes(I)&&(a||typeof D!="string")?(t[I]=D,I in o&&(o[I]=Rv)):typeof D!="function"&&Ct(t,I,D)}}}return u&&Yi(!0),d}function su(t,e,n=[],r=[],i,o=!1){Pv(n,r,a=>{var l=void 0,u={},d=t.nodeName==="SELECT",f=!1;if(Vl(()=>{var v=e(...a.map(_)),y=eg(t,l,v,i,o);f&&d&&"value"in v&&cl(t,v.value);for(let k of Object.getOwnPropertySymbols(u))v[k]||ro(u[k]);for(let k of Object.getOwnPropertySymbols(v)){var b=v[k];k.description===jv&&(!l||b!==l[k])&&(u[k]&&ro(u[k]),u[k]=no(()=>Yv(t,()=>b))),y[k]=b}l=y}),d){var p=t;zl(()=>{cl(p,l.value,!0),Zv(p)})}f=!0})}function Wl(t){return t.__attributes??(t.__attributes={[Qf]:t.nodeName.includes("-"),[Xf]:t.namespaceURI===Dv})}var au=new Map;function $f(t){var e=au.get(t.nodeName);if(e)return e;au.set(t.nodeName,e=[]);for(var n,r=t,i=Element.prototype;i!==r;){n=Mv(r);for(var o in n)n[o].set&&e.push(o);r=Nf(r)}return e}function vs(t,e,n=e){var r=Uv(),i=new WeakSet;Nv(t,"input",o=>{var a=o?t.defaultValue:t.value;if(a=Ra(t)?Ua(a):a,n(a),Yr!==null&&i.add(Yr),r&&a!==(a=e())){var l=t.selectionStart,u=t.selectionEnd;t.value=a??"",u!==null&&(t.selectionStart=l,t.selectionEnd=Math.min(u,t.value.length))}}),(Nt&&t.defaultValue!==t.value||Wf(e)==null&&t.value)&&(n(Ra(t)?Ua(t.value):t.value),Yr!==null&&i.add(Yr)),Fv(()=>{var o=e();if(t===document.activeElement){var a=Bv??Yr;if(i.has(a))return}Ra(t)&&o===Ua(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function Ra(t){var e=t.type;return e==="number"||e==="range"}function Ua(t){return t===""?null:+t}var sr,ti,go,Ps,ed;const js=class js{constructor(e){Li(this,Ps);Li(this,sr,new WeakMap);Li(this,ti);Li(this,go);Oa(this,go,e)}observe(e,n){var r=Bn(this,sr).get(e)||new Set;return r.add(n),Bn(this,sr).set(e,r),Zc(this,Ps,ed).call(this).observe(e,Bn(this,go)),()=>{var i=Bn(this,sr).get(e);i.delete(n),i.size===0&&(Bn(this,sr).delete(e),Bn(this,ti).unobserve(e))}}};sr=new WeakMap,ti=new WeakMap,go=new WeakMap,Ps=new WeakSet,ed=function(){return Bn(this,ti)??Oa(this,ti,new ResizeObserver(e=>{for(var n of e){js.entries.set(n.target,n);for(var r of Bn(this,sr).get(n.target)||[])r(n)}}))},Xc(js,"entries",new WeakMap);let ul=js;var tg=new ul({box:"border-box"});function lu(t,e,n){var r=tg.observe(t,()=>n(t[e]));zl(()=>(Wf(()=>n(t[e])),r))}var ng=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function td(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rs={exports:{}},rg=rs.exports,cu;function ig(){return cu||(cu=1,(function(t,e){(function(n,r){t.exports=r()})(rg,function(){var n=function(s,c){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var m in g)Object.prototype.hasOwnProperty.call(g,m)&&(h[m]=g[m])})(s,c)},r=function(){return(r=Object.assign||function(s){for(var c,h=1,g=arguments.length;h<g;h++)for(var m in c=arguments[h])Object.prototype.hasOwnProperty.call(c,m)&&(s[m]=c[m]);return s}).apply(this,arguments)};function i(s,c,h){for(var g,m=0,w=c.length;m<w;m++)!g&&m in c||((g=g||Array.prototype.slice.call(c,0,m))[m]=c[m]);return s.concat(g||Array.prototype.slice.call(c))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ng,a=Object.keys,l=Array.isArray;function u(s,c){return typeof c!="object"||a(c).forEach(function(h){s[h]=c[h]}),s}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var d=Object.getPrototypeOf,f={}.hasOwnProperty;function p(s,c){return f.call(s,c)}function v(s,c){typeof c=="function"&&(c=c(d(s))),(typeof Reflect>"u"?a:Reflect.ownKeys)(c).forEach(function(h){b(s,h,c[h])})}var y=Object.defineProperty;function b(s,c,h,g){y(s,c,u(h&&p(h,"get")&&typeof h.get=="function"?{get:h.get,set:h.set,configurable:!0}:{value:h,configurable:!0,writable:!0},g))}function k(s){return{from:function(c){return s.prototype=Object.create(c.prototype),b(s.prototype,"constructor",s),{extend:v.bind(null,s.prototype)}}}}var x=Object.getOwnPropertyDescriptor,I=[].slice;function E(s,c,h){return I.call(s,c,h)}function S(s,c){return c(s)}function D(s){if(!s)throw new Error("Assertion Failed")}function j(s){o.setImmediate?setImmediate(s):setTimeout(s,0)}function O(s,c){if(typeof c=="string"&&p(s,c))return s[c];if(!c)return s;if(typeof c!="string"){for(var h=[],g=0,m=c.length;g<m;++g){var w=O(s,c[g]);h.push(w)}return h}var C=c.indexOf(".");if(C!==-1){var T=s[c.substr(0,C)];return T==null?void 0:O(T,c.substr(C+1))}}function M(s,c,h){if(s&&c!==void 0&&!("isFrozen"in Object&&Object.isFrozen(s)))if(typeof c!="string"&&"length"in c){D(typeof h!="string"&&"length"in h);for(var g=0,m=c.length;g<m;++g)M(s,c[g],h[g])}else{var w,C,T=c.indexOf(".");T!==-1?(w=c.substr(0,T),(C=c.substr(T+1))===""?h===void 0?l(s)&&!isNaN(parseInt(w))?s.splice(w,1):delete s[w]:s[w]=h:M(T=!(T=s[w])||!p(s,w)?s[w]={}:T,C,h)):h===void 0?l(s)&&!isNaN(parseInt(c))?s.splice(c,1):delete s[c]:s[c]=h}}function ie(s){var c,h={};for(c in s)p(s,c)&&(h[c]=s[c]);return h}var ne=[].concat;function re(s){return ne.apply([],s)}var yn="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(re([8,16,32,64].map(function(s){return["Int","Uint","Float"].map(function(c){return c+s+"Array"})}))).filter(function(s){return o[s]}),W=new Set(yn.map(function(s){return o[s]})),le=null;function ce(s){return le=new WeakMap,s=(function c(h){if(!h||typeof h!="object")return h;var g=le.get(h);if(g)return g;if(l(h)){g=[],le.set(h,g);for(var m=0,w=h.length;m<w;++m)g.push(c(h[m]))}else if(W.has(h.constructor))g=h;else{var C,T=d(h);for(C in g=T===Object.prototype?{}:Object.create(T),le.set(h,g),h)p(h,C)&&(g[C]=c(h[C]))}return g})(s),le=null,s}var Ie={}.toString;function De(s){return Ie.call(s).slice(8,-1)}var te=typeof Symbol<"u"?Symbol.iterator:"@@iterator",$=typeof te=="symbol"?function(s){var c;return s!=null&&(c=s[te])&&c.apply(s)}:function(){return null};function se(s,c){return c=s.indexOf(c),0<=c&&s.splice(c,1),0<=c}var ge={};function _e(s){var c,h,g,m;if(arguments.length===1){if(l(s))return s.slice();if(this===ge&&typeof s=="string")return[s];if(m=$(s)){for(h=[];!(g=m.next()).done;)h.push(g.value);return h}if(s==null)return[s];if(typeof(c=s.length)!="number")return[s];for(h=new Array(c);c--;)h[c]=s[c];return h}for(c=arguments.length,h=new Array(c);c--;)h[c]=arguments[c];return h}var G=typeof Symbol<"u"?function(s){return s[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Rn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],un=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Rn),U={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Y(s,c){this.name=s,this.message=c}function ve(s,c){return s+". Errors: "+Object.keys(c).map(function(h){return c[h].toString()}).filter(function(h,g,m){return m.indexOf(h)===g}).join(`
`)}function Ee(s,c,h,g){this.failures=c,this.failedKeys=g,this.successCount=h,this.message=ve(s,c)}function Me(s,c){this.name="BulkError",this.failures=Object.keys(c).map(function(h){return c[h]}),this.failuresByPos=c,this.message=ve(s,this.failures)}k(Y).from(Error).extend({toString:function(){return this.name+": "+this.message}}),k(Ee).from(Y),k(Me).from(Y);var ye=un.reduce(function(s,c){return s[c]=c+"Error",s},{}),ke=Y,oe=un.reduce(function(s,c){var h=c+"Error";function g(m,w){this.name=h,m?typeof m=="string"?(this.message="".concat(m).concat(w?`
 `+w:""),this.inner=w||null):typeof m=="object"&&(this.message="".concat(m.name," ").concat(m.message),this.inner=m):(this.message=U[c]||h,this.inner=null)}return k(g).from(ke),s[c]=g,s},{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var Pe=Rn.reduce(function(s,c){return s[c+"Error"]=oe[c],s},{}),Be=un.reduce(function(s,c){return["Syntax","Type","Range"].indexOf(c)===-1&&(s[c+"Error"]=oe[c]),s},{});function Se(){}function Ne(s){return s}function Ue(s,c){return s==null||s===Ne?c:function(h){return c(s(h))}}function Ve(s,c){return function(){s.apply(this,arguments),c.apply(this,arguments)}}function mt(s,c){return s===Se?c:function(){var h=s.apply(this,arguments);h!==void 0&&(arguments[0]=h);var g=this.onsuccess,m=this.onerror;this.onsuccess=null,this.onerror=null;var w=c.apply(this,arguments);return g&&(this.onsuccess=this.onsuccess?Ve(g,this.onsuccess):g),m&&(this.onerror=this.onerror?Ve(m,this.onerror):m),w!==void 0?w:h}}function kt(s,c){return s===Se?c:function(){s.apply(this,arguments);var h=this.onsuccess,g=this.onerror;this.onsuccess=this.onerror=null,c.apply(this,arguments),h&&(this.onsuccess=this.onsuccess?Ve(h,this.onsuccess):h),g&&(this.onerror=this.onerror?Ve(g,this.onerror):g)}}function vt(s,c){return s===Se?c:function(h){var g=s.apply(this,arguments);u(h,g);var m=this.onsuccess,w=this.onerror;return this.onsuccess=null,this.onerror=null,h=c.apply(this,arguments),m&&(this.onsuccess=this.onsuccess?Ve(m,this.onsuccess):m),w&&(this.onerror=this.onerror?Ve(w,this.onerror):w),g===void 0?h===void 0?void 0:h:u(g,h)}}function Yt(s,c){return s===Se?c:function(){return c.apply(this,arguments)!==!1&&s.apply(this,arguments)}}function Xt(s,c){return s===Se?c:function(){var h=s.apply(this,arguments);if(h&&typeof h.then=="function"){for(var g=this,m=arguments.length,w=new Array(m);m--;)w[m]=arguments[m];return h.then(function(){return c.apply(g,w)})}return c.apply(this,arguments)}}Be.ModifyError=Ee,Be.DexieError=Y,Be.BulkError=Me;var bt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ln(s){bt=s}var yr={},_i=100,yn=typeof Promise>"u"?[]:(function(){var s=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[s,d(s),s];var c=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[c,d(c),s]})(),Rn=yn[0],un=yn[1],yn=yn[2],un=un&&un.then,ln=Rn&&Rn.constructor,ki=!!yn,$n=function(s,c){tr.push([s,c]),Nr&&(queueMicrotask($e),Nr=!1)},mr=!0,Nr=!0,mn=[],er=[],Si=Ne,bn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Se,pgp:!1,env:{},finalize:Se},je=bn,tr=[],kn=0,br=[];function be(s){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var c=this._PSD=je;if(typeof s!="function"){if(s!==yr)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ae(this,this._value))}this._state=null,this._value=null,++c.ref,(function h(g,m){try{m(function(w){if(g._state===null){if(w===g)throw new TypeError("A promise cannot be resolved with itself.");var C=g._lib&&Xe();w&&typeof w.then=="function"?h(g,function(T,P){w instanceof be?w._then(T,P):w.then(T,P)}):(g._state=!0,g._value=w,Fe(g)),C&&nt()}},Ae.bind(null,g))}catch(w){Ae(g,w)}})(this,s)}var xi={get:function(){var s=je,c=_r;function h(g,m){var w=this,C=!s.global&&(s!==je||c!==_r),T=C&&!xn(),P=new be(function(R,F){ct(w,new ue(_c(g,s,C,T),_c(m,s,C,T),R,F,s))});return this._consoleTask&&(P._consoleTask=this._consoleTask),P}return h.prototype=yr,h},set:function(s){b(this,"then",s&&s.prototype===yr?xi:{get:function(){return s},set:xi.set})}};function ue(s,c,h,g,m){this.onFulfilled=typeof s=="function"?s:null,this.onRejected=typeof c=="function"?c:null,this.resolve=h,this.reject=g,this.psd=m}function Ae(s,c){var h,g;er.push(c),s._state===null&&(h=s._lib&&Xe(),c=Si(c),s._state=!1,s._value=c,g=s,mn.some(function(m){return m._value===g._value})||mn.push(g),Fe(s),h&&nt())}function Fe(s){var c=s._listeners;s._listeners=[];for(var h=0,g=c.length;h<g;++h)ct(s,c[h]);var m=s._PSD;--m.ref||m.finalize(),kn===0&&(++kn,$n(function(){--kn==0&&wn()},[]))}function ct(s,c){if(s._state!==null){var h=s._state?c.onFulfilled:c.onRejected;if(h===null)return(s._state?c.resolve:c.reject)(s._value);++c.psd.ref,++kn,$n(Je,[h,s,c])}else s._listeners.push(c)}function Je(s,c,h){try{var g,m=c._value;!c._state&&er.length&&(er=[]),g=bt&&c._consoleTask?c._consoleTask.run(function(){return s(m)}):s(m),c._state||er.indexOf(m)!==-1||(function(w){for(var C=mn.length;C;)if(mn[--C]._value===w._value)return mn.splice(C,1)})(c),h.resolve(g)}catch(w){h.reject(w)}finally{--kn==0&&wn(),--h.psd.ref||h.psd.finalize()}}function $e(){kr(bn,function(){Xe()&&nt()})}function Xe(){var s=mr;return Nr=mr=!1,s}function nt(){var s,c,h;do for(;0<tr.length;)for(s=tr,tr=[],h=s.length,c=0;c<h;++c){var g=s[c];g[0].apply(null,g[1])}while(0<tr.length);Nr=mr=!0}function wn(){var s=mn;mn=[],s.forEach(function(g){g._PSD.onunhandled.call(null,g._value,g)});for(var c=br.slice(0),h=c.length;h;)c[--h]()}function Fr(s){return new be(yr,!1,s)}function ze(s,c){var h=je;return function(){var g=Xe(),m=je;try{return nr(h,!0),s.apply(this,arguments)}catch(w){c&&c(w)}finally{nr(m,!1),g&&nt()}}}v(be.prototype,{then:xi,_then:function(s,c){ct(this,new ue(null,null,s,c,je))},catch:function(s){if(arguments.length===1)return this.then(null,s);var c=s,h=arguments[1];return typeof c=="function"?this.then(null,function(g){return(g instanceof c?h:Fr)(g)}):this.then(null,function(g){return(g&&g.name===c?h:Fr)(g)})},finally:function(s){return this.then(function(c){return be.resolve(s()).then(function(){return c})},function(c){return be.resolve(s()).then(function(){return Fr(c)})})},timeout:function(s,c){var h=this;return s<1/0?new be(function(g,m){var w=setTimeout(function(){return m(new oe.Timeout(c))},s);h.then(g,m).finally(clearTimeout.bind(null,w))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&b(be.prototype,Symbol.toStringTag,"Dexie.Promise"),bn.env=wc(),v(be,{all:function(){var s=_e.apply(null,arguments).map(Co);return new be(function(c,h){s.length===0&&c([]);var g=s.length;s.forEach(function(m,w){return be.resolve(m).then(function(C){s[w]=C,--g||c(s)},h)})})},resolve:function(s){return s instanceof be?s:s&&typeof s.then=="function"?new be(function(c,h){s.then(c,h)}):new be(yr,!0,s)},reject:Fr,race:function(){var s=_e.apply(null,arguments).map(Co);return new be(function(c,h){s.map(function(g){return be.resolve(g).then(c,h)})})},PSD:{get:function(){return je},set:function(s){return je=s}},totalEchoes:{get:function(){return _r}},newPSD:cn,usePSD:kr,scheduler:{get:function(){return $n},set:function(s){$n=s}},rejectionMapper:{get:function(){return Si},set:function(s){Si=s}},follow:function(s,c){return new be(function(h,g){return cn(function(m,w){var C=je;C.unhandleds=[],C.onunhandled=w,C.finalize=Ve(function(){var T,P=this;T=function(){P.unhandleds.length===0?m():w(P.unhandleds[0])},br.push(function R(){T(),br.splice(br.indexOf(R),1)}),++kn,$n(function(){--kn==0&&wn()},[])},C.finalize),s()},c,h,g)})}}),ln&&(ln.allSettled&&b(be,"allSettled",function(){var s=_e.apply(null,arguments).map(Co);return new be(function(c){s.length===0&&c([]);var h=s.length,g=new Array(h);s.forEach(function(m,w){return be.resolve(m).then(function(C){return g[w]={status:"fulfilled",value:C}},function(C){return g[w]={status:"rejected",reason:C}}).then(function(){return--h||c(g)})})})}),ln.any&&typeof AggregateError<"u"&&b(be,"any",function(){var s=_e.apply(null,arguments).map(Co);return new be(function(c,h){s.length===0&&h(new AggregateError([]));var g=s.length,m=new Array(g);s.forEach(function(w,C){return be.resolve(w).then(function(T){return c(T)},function(T){m[C]=T,--g||h(new AggregateError(m))})})})}),ln.withResolvers&&(be.withResolvers=ln.withResolvers));var et={awaits:0,echoes:0,id:0},Ei=0,Br=[],wr=0,_r=0,Sn=0;function cn(s,c,h,g){var m=je,w=Object.create(m);return w.parent=m,w.ref=0,w.global=!1,w.id=++Sn,bn.env,w.env=ki?{Promise:be,PromiseProp:{value:be,configurable:!0,writable:!0},all:be.all,race:be.race,allSettled:be.allSettled,any:be.any,resolve:be.resolve,reject:be.reject}:{},c&&u(w,c),++m.ref,w.finalize=function(){--this.parent.ref||this.parent.finalize()},g=kr(w,s,h,g),w.ref===0&&w.finalize(),g}function Un(){return et.id||(et.id=++Ei),++et.awaits,et.echoes+=_i,et.id}function xn(){return!!et.awaits&&(--et.awaits==0&&(et.id=0),et.echoes=et.awaits*_i,!0)}function Co(s){return et.echoes&&s&&s.constructor===ln?(Un(),s.then(function(c){return xn(),c},function(c){return xn(),xt(c)})):s}function Pp(){var s=Br[Br.length-1];Br.pop(),nr(s,!1)}function nr(s,c){var h,g=je;(c?!et.echoes||wr++&&s===je:!wr||--wr&&s===je)||queueMicrotask(c?(function(m){++_r,et.echoes&&--et.echoes!=0||(et.echoes=et.awaits=et.id=0),Br.push(je),nr(m,!0)}).bind(null,s):Pp),s!==je&&(je=s,g===bn&&(bn.env=wc()),ki&&(h=bn.env.Promise,c=s.env,(g.global||s.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),h.all=c.all,h.race=c.race,h.resolve=c.resolve,h.reject=c.reject,c.allSettled&&(h.allSettled=c.allSettled),c.any&&(h.any=c.any))))}function wc(){var s=o.Promise;return ki?{Promise:s,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:s.all,race:s.race,allSettled:s.allSettled,any:s.any,resolve:s.resolve,reject:s.reject}:{}}function kr(s,c,h,g,m){var w=je;try{return nr(s,!0),c(h,g,m)}finally{nr(w,!1)}}function _c(s,c,h,g){return typeof s!="function"?s:function(){var m=je;h&&Un(),nr(c,!0);try{return s.apply(this,arguments)}finally{nr(m,!1),g&&queueMicrotask(xn)}}}function ra(s){Promise===ln&&et.echoes===0?wr===0?s():enqueueNativeMicroTask(s):setTimeout(s,0)}(""+un).indexOf("[native code]")===-1&&(Un=xn=Se);var xt=be.reject,Sr="￿",Nn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",kc="String expected.",Kr=[],Io="__dbnames",ia="readonly",oa="readwrite";function xr(s,c){return s?c?function(){return s.apply(this,arguments)&&c.apply(this,arguments)}:s:c}var Sc={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Do(s){return typeof s!="string"||/\./.test(s)?function(c){return c}:function(c){return c[s]===void 0&&s in c&&delete(c=ce(c))[s],c}}function xc(){throw oe.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ze(s,c){try{var h=Ec(s),g=Ec(c);if(h!==g)return h==="Array"?1:g==="Array"?-1:h==="binary"?1:g==="binary"?-1:h==="string"?1:g==="string"?-1:h==="Date"?1:g!=="Date"?NaN:-1;switch(h){case"number":case"Date":case"string":return c<s?1:s<c?-1:0;case"binary":return(function(m,w){for(var C=m.length,T=w.length,P=C<T?C:T,R=0;R<P;++R)if(m[R]!==w[R])return m[R]<w[R]?-1:1;return C===T?0:C<T?-1:1})(Cc(s),Cc(c));case"Array":return(function(m,w){for(var C=m.length,T=w.length,P=C<T?C:T,R=0;R<P;++R){var F=Ze(m[R],w[R]);if(F!==0)return F}return C===T?0:C<T?-1:1})(s,c)}}catch{}return NaN}function Ec(s){var c=typeof s;return c!="object"?c:ArrayBuffer.isView(s)?"binary":(s=De(s),s==="ArrayBuffer"?"binary":s)}function Cc(s){return s instanceof Uint8Array?s:ArrayBuffer.isView(s)?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s)}function To(s,c,h){var g=s.schema.yProps;return g?(c&&0<h.numFailures&&(c=c.filter(function(m,w){return!h.failures[w]})),Promise.all(g.map(function(m){return m=m.updatesTable,c?s.db.table(m).where("k").anyOf(c).delete():s.db.table(m).clear()})).then(function(){return h})):h}var Ic=(wt.prototype._trans=function(s,c,h){var g=this._tx||je.trans,m=this.name,w=bt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(s==="readonly"?"read":"write"," ").concat(this.name));function C(R,F,A){if(!A.schema[m])throw new oe.NotFound("Table "+m+" not part of transaction");return c(A.idbtrans,A)}var T=Xe();try{var P=g&&g.db._novip===this.db._novip?g===je.trans?g._promise(s,C,h):cn(function(){return g._promise(s,C,h)},{trans:g,transless:je.transless||je}):(function R(F,A,H,L){if(F.idbdb&&(F._state.openComplete||je.letThrough||F._vip)){var N=F._createTransaction(A,H,F._dbSchema);try{N.create(),F._state.PR1398_maxLoop=3}catch(q){return q.name===ye.InvalidState&&F.isOpen()&&0<--F._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),F.close({disableAutoOpen:!1}),F.open().then(function(){return R(F,A,H,L)})):xt(q)}return N._promise(A,function(q,B){return cn(function(){return je.trans=N,L(q,B,N)})}).then(function(q){if(A==="readwrite")try{N.idbtrans.commit()}catch{}return A==="readonly"?q:N._completion.then(function(){return q})})}if(F._state.openComplete)return xt(new oe.DatabaseClosed(F._state.dbOpenError));if(!F._state.isBeingOpened){if(!F._state.autoOpen)return xt(new oe.DatabaseClosed);F.open().catch(Se)}return F._state.dbReadyPromise.then(function(){return R(F,A,H,L)})})(this.db,s,[this.name],C);return w&&(P._consoleTask=w,P=P.catch(function(R){return console.trace(R),xt(R)})),P}finally{T&&nt()}},wt.prototype.get=function(s,c){var h=this;return s&&s.constructor===Object?this.where(s).first(c):s==null?xt(new oe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(g){return h.core.get({trans:g,key:s}).then(function(m){return h.hook.reading.fire(m)})}).then(c)},wt.prototype.where=function(s){if(typeof s=="string")return new this.db.WhereClause(this,s);if(l(s))return new this.db.WhereClause(this,"[".concat(s.join("+"),"]"));var c=a(s);if(c.length===1)return this.where(c[0]).equals(s[c[0]]);var h=this.schema.indexes.concat(this.schema.primKey).filter(function(T){if(T.compound&&c.every(function(R){return 0<=T.keyPath.indexOf(R)})){for(var P=0;P<c.length;++P)if(c.indexOf(T.keyPath[P])===-1)return!1;return!0}return!1}).sort(function(T,P){return T.keyPath.length-P.keyPath.length})[0];if(h&&this.db._maxKey!==Sr){var w=h.keyPath.slice(0,c.length);return this.where(w).equals(w.map(function(P){return s[P]}))}!h&&bt&&console.warn("The query ".concat(JSON.stringify(s)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(c.join("+"),"]"));var g=this.schema.idxByName;function m(T,P){return Ze(T,P)===0}var C=c.reduce(function(A,P){var R=A[0],F=A[1],A=g[P],H=s[P];return[R||A,R||!A?xr(F,A&&A.multi?function(L){return L=O(L,P),l(L)&&L.some(function(N){return m(H,N)})}:function(L){return m(H,O(L,P))}):F]},[null,null]),w=C[0],C=C[1];return w?this.where(w.name).equals(s[w.keyPath]).filter(C):h?this.filter(C):this.where(c).equals("")},wt.prototype.filter=function(s){return this.toCollection().and(s)},wt.prototype.count=function(s){return this.toCollection().count(s)},wt.prototype.offset=function(s){return this.toCollection().offset(s)},wt.prototype.limit=function(s){return this.toCollection().limit(s)},wt.prototype.each=function(s){return this.toCollection().each(s)},wt.prototype.toArray=function(s){return this.toCollection().toArray(s)},wt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},wt.prototype.orderBy=function(s){return new this.db.Collection(new this.db.WhereClause(this,l(s)?"[".concat(s.join("+"),"]"):s))},wt.prototype.reverse=function(){return this.toCollection().reverse()},wt.prototype.mapToClass=function(s){var c,h=this.db,g=this.name;function m(){return c!==null&&c.apply(this,arguments)||this}(this.schema.mappedClass=s).prototype instanceof xc&&((function(P,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");function F(){this.constructor=P}n(P,R),P.prototype=R===null?Object.create(R):(F.prototype=R.prototype,new F)})(m,c=s),Object.defineProperty(m.prototype,"db",{get:function(){return h},enumerable:!1,configurable:!0}),m.prototype.table=function(){return g},s=m);for(var w=new Set,C=s.prototype;C;C=d(C))Object.getOwnPropertyNames(C).forEach(function(P){return w.add(P)});function T(P){if(!P)return P;var R,F=Object.create(s.prototype);for(R in P)if(!w.has(R))try{F[R]=P[R]}catch{}return F}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=T,this.hook("reading",T),s},wt.prototype.defineClass=function(){return this.mapToClass(function(s){u(this,s)})},wt.prototype.add=function(s,c){var h=this,g=this.schema.primKey,m=g.auto,w=g.keyPath,C=s;return w&&m&&(C=Do(w)(s)),this._trans("readwrite",function(T){return h.core.mutate({trans:T,type:"add",keys:c!=null?[c]:null,values:[C]})}).then(function(T){return T.numFailures?be.reject(T.failures[0]):T.lastResult}).then(function(T){if(w)try{M(s,w,T)}catch{}return T})},wt.prototype.update=function(s,c){return typeof s!="object"||l(s)?this.where(":id").equals(s).modify(c):(s=O(s,this.schema.primKey.keyPath),s===void 0?xt(new oe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(s).modify(c))},wt.prototype.put=function(s,c){var h=this,g=this.schema.primKey,m=g.auto,w=g.keyPath,C=s;return w&&m&&(C=Do(w)(s)),this._trans("readwrite",function(T){return h.core.mutate({trans:T,type:"put",values:[C],keys:c!=null?[c]:null})}).then(function(T){return T.numFailures?be.reject(T.failures[0]):T.lastResult}).then(function(T){if(w)try{M(s,w,T)}catch{}return T})},wt.prototype.delete=function(s){var c=this;return this._trans("readwrite",function(h){return c.core.mutate({trans:h,type:"delete",keys:[s]}).then(function(g){return To(c,[s],g)}).then(function(g){return g.numFailures?be.reject(g.failures[0]):void 0})})},wt.prototype.clear=function(){var s=this;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"deleteRange",range:Sc}).then(function(h){return To(s,null,h)})}).then(function(c){return c.numFailures?be.reject(c.failures[0]):void 0})},wt.prototype.bulkGet=function(s){var c=this;return this._trans("readonly",function(h){return c.core.getMany({keys:s,trans:h}).then(function(g){return g.map(function(m){return c.hook.reading.fire(m)})})})},wt.prototype.bulkAdd=function(s,c,h){var g=this,m=Array.isArray(c)?c:void 0,w=(h=h||(m?void 0:c))?h.allKeys:void 0;return this._trans("readwrite",function(C){var R=g.schema.primKey,T=R.auto,R=R.keyPath;if(R&&m)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(m&&m.length!==s.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var P=s.length,R=R&&T?s.map(Do(R)):s;return g.core.mutate({trans:C,type:"add",keys:m,values:R,wantResults:w}).then(function(N){var A=N.numFailures,H=N.results,L=N.lastResult,N=N.failures;if(A===0)return w?H:L;throw new Me("".concat(g.name,".bulkAdd(): ").concat(A," of ").concat(P," operations failed"),N)})})},wt.prototype.bulkPut=function(s,c,h){var g=this,m=Array.isArray(c)?c:void 0,w=(h=h||(m?void 0:c))?h.allKeys:void 0;return this._trans("readwrite",function(C){var R=g.schema.primKey,T=R.auto,R=R.keyPath;if(R&&m)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(m&&m.length!==s.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var P=s.length,R=R&&T?s.map(Do(R)):s;return g.core.mutate({trans:C,type:"put",keys:m,values:R,wantResults:w}).then(function(N){var A=N.numFailures,H=N.results,L=N.lastResult,N=N.failures;if(A===0)return w?H:L;throw new Me("".concat(g.name,".bulkPut(): ").concat(A," of ").concat(P," operations failed"),N)})})},wt.prototype.bulkUpdate=function(s){var c=this,h=this.core,g=s.map(function(C){return C.key}),m=s.map(function(C){return C.changes}),w=[];return this._trans("readwrite",function(C){return h.getMany({trans:C,keys:g,cache:"clone"}).then(function(T){var P=[],R=[];s.forEach(function(A,H){var L=A.key,N=A.changes,q=T[H];if(q){for(var B=0,z=Object.keys(N);B<z.length;B++){var J=z[B],Z=N[J];if(J===c.schema.primKey.keyPath){if(Ze(Z,L)!==0)throw new oe.Constraint("Cannot update primary key in bulkUpdate()")}else M(q,J,Z)}w.push(H),P.push(L),R.push(q)}});var F=P.length;return h.mutate({trans:C,type:"put",keys:P,values:R,updates:{keys:g,changeSpecs:m}}).then(function(A){var H=A.numFailures,L=A.failures;if(H===0)return F;for(var N=0,q=Object.keys(L);N<q.length;N++){var B,z=q[N],J=w[Number(z)];J!=null&&(B=L[z],delete L[z],L[J]=B)}throw new Me("".concat(c.name,".bulkUpdate(): ").concat(H," of ").concat(F," operations failed"),L)})})})},wt.prototype.bulkDelete=function(s){var c=this,h=s.length;return this._trans("readwrite",function(g){return c.core.mutate({trans:g,type:"delete",keys:s}).then(function(m){return To(c,s,m)})}).then(function(C){var m=C.numFailures,w=C.lastResult,C=C.failures;if(m===0)return w;throw new Me("".concat(c.name,".bulkDelete(): ").concat(m," of ").concat(h," operations failed"),C)})},wt);function wt(){}function Ci(s){function c(C,T){if(T){for(var P=arguments.length,R=new Array(P-1);--P;)R[P-1]=arguments[P];return h[C].subscribe.apply(null,R),s}if(typeof C=="string")return h[C]}var h={};c.addEventType=w;for(var g=1,m=arguments.length;g<m;++g)w(arguments[g]);return c;function w(C,T,P){if(typeof C!="object"){var R;T=T||Yt;var F={subscribers:[],fire:P=P||Se,subscribe:function(A){F.subscribers.indexOf(A)===-1&&(F.subscribers.push(A),F.fire=T(F.fire,A))},unsubscribe:function(A){F.subscribers=F.subscribers.filter(function(H){return H!==A}),F.fire=F.subscribers.reduce(T,P)}};return h[C]=c[C]=F}a(R=C).forEach(function(A){var H=R[A];if(l(H))w(A,R[A][0],R[A][1]);else{if(H!=="asap")throw new oe.InvalidArgument("Invalid event config");var L=w(A,Ne,function(){for(var N=arguments.length,q=new Array(N);N--;)q[N]=arguments[N];L.subscribers.forEach(function(B){j(function(){B.apply(null,q)})})})}})}}function Ii(s,c){return k(c).from({prototype:s}),c}function qr(s,c){return!(s.filter||s.algorithm||s.or)&&(c?s.justLimit:!s.replayFilter)}function sa(s,c){s.filter=xr(s.filter,c)}function aa(s,c,h){var g=s.replayFilter;s.replayFilter=g?function(){return xr(g(),c())}:c,s.justLimit=h&&!g}function Ao(s,c){if(s.isPrimKey)return c.primaryKey;var h=c.getIndexByKeyPath(s.index);if(!h)throw new oe.Schema("KeyPath "+s.index+" on object store "+c.name+" is not indexed");return h}function Dc(s,c,h){var g=Ao(s,c.schema);return c.openCursor({trans:h,values:!s.keysOnly,reverse:s.dir==="prev",unique:!!s.unique,query:{index:g,range:s.range}})}function Oo(s,c,h,g){var m=s.replayFilter?xr(s.filter,s.replayFilter()):s.filter;if(s.or){var w={},C=function(T,P,R){var F,A;m&&!m(P,R,function(H){return P.stop(H)},function(H){return P.fail(H)})||((A=""+(F=P.primaryKey))=="[object ArrayBuffer]"&&(A=""+new Uint8Array(F)),p(w,A)||(w[A]=!0,c(T,P,R)))};return Promise.all([s.or._iterate(C,h),Tc(Dc(s,g,h),s.algorithm,C,!s.keysOnly&&s.valueMapper)])}return Tc(Dc(s,g,h),xr(s.algorithm,m),c,!s.keysOnly&&s.valueMapper)}function Tc(s,c,h,g){var m=ze(g?function(w,C,T){return h(g(w),C,T)}:h);return s.then(function(w){if(w)return w.start(function(){var C=function(){return w.continue()};c&&!c(w,function(T){return C=T},function(T){w.stop(T),C=Se},function(T){w.fail(T),C=Se})||m(w.value,w,function(T){return C=T}),C()})})}var Di=(Ac.prototype.execute=function(s){var c=this["@@propmod"];if(c.add!==void 0){var h=c.add;if(l(h))return i(i([],l(s)?s:[],!0),h).sort();if(typeof h=="number")return(Number(s)||0)+h;if(typeof h=="bigint")try{return BigInt(s)+h}catch{return BigInt(0)+h}throw new TypeError("Invalid term ".concat(h))}if(c.remove!==void 0){var g=c.remove;if(l(g))return l(s)?s.filter(function(m){return!g.includes(m)}).sort():[];if(typeof g=="number")return Number(s)-g;if(typeof g=="bigint")try{return BigInt(s)-g}catch{return BigInt(0)-g}throw new TypeError("Invalid subtrahend ".concat(g))}return h=(h=c.replacePrefix)===null||h===void 0?void 0:h[0],h&&typeof s=="string"&&s.startsWith(h)?c.replacePrefix[1]+s.substring(h.length):s},Ac);function Ac(s){this["@@propmod"]=s}var jp=(ot.prototype._read=function(s,c){var h=this._ctx;return h.error?h.table._trans(null,xt.bind(null,h.error)):h.table._trans("readonly",s).then(c)},ot.prototype._write=function(s){var c=this._ctx;return c.error?c.table._trans(null,xt.bind(null,c.error)):c.table._trans("readwrite",s,"locked")},ot.prototype._addAlgorithm=function(s){var c=this._ctx;c.algorithm=xr(c.algorithm,s)},ot.prototype._iterate=function(s,c){return Oo(this._ctx,s,c,this._ctx.table.core)},ot.prototype.clone=function(s){var c=Object.create(this.constructor.prototype),h=Object.create(this._ctx);return s&&u(h,s),c._ctx=h,c},ot.prototype.raw=function(){return this._ctx.valueMapper=null,this},ot.prototype.each=function(s){var c=this._ctx;return this._read(function(h){return Oo(c,s,h,c.table.core)})},ot.prototype.count=function(s){var c=this;return this._read(function(h){var g=c._ctx,m=g.table.core;if(qr(g,!0))return m.count({trans:h,query:{index:Ao(g,m.schema),range:g.range}}).then(function(C){return Math.min(C,g.limit)});var w=0;return Oo(g,function(){return++w,!1},h,m).then(function(){return w})}).then(s)},ot.prototype.sortBy=function(s,c){var h=s.split(".").reverse(),g=h[0],m=h.length-1;function w(P,R){return R?w(P[h[R]],R-1):P[g]}var C=this._ctx.dir==="next"?1:-1;function T(P,R){return Ze(w(P,m),w(R,m))*C}return this.toArray(function(P){return P.sort(T)}).then(c)},ot.prototype.toArray=function(s){var c=this;return this._read(function(h){var g=c._ctx;if(g.dir==="next"&&qr(g,!0)&&0<g.limit){var m=g.valueMapper,w=Ao(g,g.table.core.schema);return g.table.core.query({trans:h,limit:g.limit,values:!0,query:{index:w,range:g.range}}).then(function(T){return T=T.result,m?T.map(m):T})}var C=[];return Oo(g,function(T){return C.push(T)},h,g.table.core).then(function(){return C})},s)},ot.prototype.offset=function(s){var c=this._ctx;return s<=0||(c.offset+=s,qr(c)?aa(c,function(){var h=s;return function(g,m){return h===0||(h===1?--h:m(function(){g.advance(h),h=0}),!1)}}):aa(c,function(){var h=s;return function(){return--h<0}})),this},ot.prototype.limit=function(s){return this._ctx.limit=Math.min(this._ctx.limit,s),aa(this._ctx,function(){var c=s;return function(h,g,m){return--c<=0&&g(m),0<=c}},!0),this},ot.prototype.until=function(s,c){return sa(this._ctx,function(h,g,m){return!s(h.value)||(g(m),c)}),this},ot.prototype.first=function(s){return this.limit(1).toArray(function(c){return c[0]}).then(s)},ot.prototype.last=function(s){return this.reverse().first(s)},ot.prototype.filter=function(s){var c;return sa(this._ctx,function(h){return s(h.value)}),(c=this._ctx).isMatch=xr(c.isMatch,s),this},ot.prototype.and=function(s){return this.filter(s)},ot.prototype.or=function(s){return new this.db.WhereClause(this._ctx.table,s,this)},ot.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ot.prototype.desc=function(){return this.reverse()},ot.prototype.eachKey=function(s){var c=this._ctx;return c.keysOnly=!c.isMatch,this.each(function(h,g){s(g.key,g)})},ot.prototype.eachUniqueKey=function(s){return this._ctx.unique="unique",this.eachKey(s)},ot.prototype.eachPrimaryKey=function(s){var c=this._ctx;return c.keysOnly=!c.isMatch,this.each(function(h,g){s(g.primaryKey,g)})},ot.prototype.keys=function(s){var c=this._ctx;c.keysOnly=!c.isMatch;var h=[];return this.each(function(g,m){h.push(m.key)}).then(function(){return h}).then(s)},ot.prototype.primaryKeys=function(s){var c=this._ctx;if(c.dir==="next"&&qr(c,!0)&&0<c.limit)return this._read(function(g){var m=Ao(c,c.table.core.schema);return c.table.core.query({trans:g,values:!1,limit:c.limit,query:{index:m,range:c.range}})}).then(function(g){return g.result}).then(s);c.keysOnly=!c.isMatch;var h=[];return this.each(function(g,m){h.push(m.primaryKey)}).then(function(){return h}).then(s)},ot.prototype.uniqueKeys=function(s){return this._ctx.unique="unique",this.keys(s)},ot.prototype.firstKey=function(s){return this.limit(1).keys(function(c){return c[0]}).then(s)},ot.prototype.lastKey=function(s){return this.reverse().firstKey(s)},ot.prototype.distinct=function(){var s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];if(!s||!s.multi)return this;var c={};return sa(this._ctx,function(m){var g=m.primaryKey.toString(),m=p(c,g);return c[g]=!0,!m}),this},ot.prototype.modify=function(s){var c=this,h=this._ctx;return this._write(function(g){var m,w,C;C=typeof s=="function"?s:(m=a(s),w=m.length,function(z){for(var J=!1,Z=0;Z<w;++Z){var ee=m[Z],ae=s[ee],he=O(z,ee);ae instanceof Di?(M(z,ee,ae.execute(he)),J=!0):he!==ae&&(M(z,ee,ae),J=!0)}return J});var T=h.table.core,A=T.schema.primaryKey,P=A.outbound,R=A.extractKey,F=200,A=c.db._options.modifyChunkSize;A&&(F=typeof A=="object"?A[T.name]||A["*"]||200:A);function H(z,ee){var Z=ee.failures,ee=ee.numFailures;N+=z-ee;for(var ae=0,he=a(Z);ae<he.length;ae++){var fe=he[ae];L.push(Z[fe])}}var L=[],N=0,q=[],B=s===Oc;return c.clone().primaryKeys().then(function(z){function J(ee){var ae=Math.min(F,z.length-ee),he=z.slice(ee,ee+ae);return(B?Promise.resolve([]):T.getMany({trans:g,keys:he,cache:"immutable"})).then(function(fe){var de=[],we=[],me=P?[]:null,xe=B?he:[];if(!B)for(var Ye=0;Ye<ae;++Ye){var tt=fe[Ye],We={value:ce(tt),primKey:z[ee+Ye]};C.call(We,We.value,We)!==!1&&(We.value==null?xe.push(z[ee+Ye]):P||Ze(R(tt),R(We.value))===0?(we.push(We.value),P&&me.push(z[ee+Ye])):(xe.push(z[ee+Ye]),de.push(We.value)))}return Promise.resolve(0<de.length&&T.mutate({trans:g,type:"add",values:de}).then(function(St){for(var He in St.failures)xe.splice(parseInt(He),1);H(de.length,St)})).then(function(){return(0<we.length||Z&&typeof s=="object")&&T.mutate({trans:g,type:"put",keys:me,values:we,criteria:Z,changeSpec:typeof s!="function"&&s,isAdditionalChunk:0<ee}).then(function(St){return H(we.length,St)})}).then(function(){return(0<xe.length||Z&&B)&&T.mutate({trans:g,type:"delete",keys:xe,criteria:Z,isAdditionalChunk:0<ee}).then(function(St){return To(h.table,xe,St)}).then(function(St){return H(xe.length,St)})}).then(function(){return z.length>ee+ae&&J(ee+F)})})}var Z=qr(h)&&h.limit===1/0&&(typeof s!="function"||B)&&{index:h.index,range:h.range};return J(0).then(function(){if(0<L.length)throw new Ee("Error modifying one or more objects",L,N,q);return z.length})})})},ot.prototype.delete=function(){var s=this._ctx,c=s.range;return!qr(s)||s.table.schema.yProps||!s.isPrimKey&&c.type!==3?this.modify(Oc):this._write(function(h){var g=s.table.core.schema.primaryKey,m=c;return s.table.core.count({trans:h,query:{index:g,range:m}}).then(function(w){return s.table.core.mutate({trans:h,type:"deleteRange",range:m}).then(function(P){var T=P.failures,P=P.numFailures;if(P)throw new Ee("Could not delete some values",Object.keys(T).map(function(R){return T[R]}),w-P);return w-P})})})},ot);function ot(){}var Oc=function(s,c){return c.value=null};function Lp(s,c){return s<c?-1:s===c?0:1}function Rp(s,c){return c<s?-1:s===c?0:1}function en(s,c,h){return s=s instanceof Pc?new s.Collection(s):s,s._ctx.error=new(h||TypeError)(c),s}function Hr(s){return new s.Collection(s,function(){return Mc("")}).limit(0)}function Mo(s,c,h,g){var m,w,C,T,P,R,F,A=h.length;if(!h.every(function(N){return typeof N=="string"}))return en(s,kc);function H(N){m=N==="next"?function(B){return B.toUpperCase()}:function(B){return B.toLowerCase()},w=N==="next"?function(B){return B.toLowerCase()}:function(B){return B.toUpperCase()},C=N==="next"?Lp:Rp;var q=h.map(function(B){return{lower:w(B),upper:m(B)}}).sort(function(B,z){return C(B.lower,z.lower)});T=q.map(function(B){return B.upper}),P=q.map(function(B){return B.lower}),F=(R=N)==="next"?"":g}H("next"),s=new s.Collection(s,function(){return rr(T[0],P[A-1]+g)}),s._ondirectionchange=function(N){H(N)};var L=0;return s._addAlgorithm(function(N,q,B){var z=N.key;if(typeof z!="string")return!1;var J=w(z);if(c(J,P,L))return!0;for(var Z=null,ee=L;ee<A;++ee){var ae=(function(he,fe,de,we,me,xe){for(var Ye=Math.min(he.length,we.length),tt=-1,We=0;We<Ye;++We){var St=fe[We];if(St!==we[We])return me(he[We],de[We])<0?he.substr(0,We)+de[We]+de.substr(We+1):me(he[We],we[We])<0?he.substr(0,We)+we[We]+de.substr(We+1):0<=tt?he.substr(0,tt)+fe[tt]+de.substr(tt+1):null;me(he[We],St)<0&&(tt=We)}return Ye<we.length&&xe==="next"?he+de.substr(he.length):Ye<he.length&&xe==="prev"?he.substr(0,de.length):tt<0?null:he.substr(0,tt)+we[tt]+de.substr(tt+1)})(z,J,T[ee],P[ee],C,R);ae===null&&Z===null?L=ee+1:(Z===null||0<C(Z,ae))&&(Z=ae)}return q(Z!==null?function(){N.continue(Z+F)}:B),!1}),s}function rr(s,c,h,g){return{type:2,lower:s,upper:c,lowerOpen:h,upperOpen:g}}function Mc(s){return{type:1,lower:s,upper:s}}var Pc=(Object.defineProperty(Mt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Mt.prototype.between=function(s,c,h,g){h=h!==!1,g=g===!0;try{return 0<this._cmp(s,c)||this._cmp(s,c)===0&&(h||g)&&(!h||!g)?Hr(this):new this.Collection(this,function(){return rr(s,c,!h,!g)})}catch{return en(this,Nn)}},Mt.prototype.equals=function(s){return s==null?en(this,Nn):new this.Collection(this,function(){return Mc(s)})},Mt.prototype.above=function(s){return s==null?en(this,Nn):new this.Collection(this,function(){return rr(s,void 0,!0)})},Mt.prototype.aboveOrEqual=function(s){return s==null?en(this,Nn):new this.Collection(this,function(){return rr(s,void 0,!1)})},Mt.prototype.below=function(s){return s==null?en(this,Nn):new this.Collection(this,function(){return rr(void 0,s,!1,!0)})},Mt.prototype.belowOrEqual=function(s){return s==null?en(this,Nn):new this.Collection(this,function(){return rr(void 0,s)})},Mt.prototype.startsWith=function(s){return typeof s!="string"?en(this,kc):this.between(s,s+Sr,!0,!0)},Mt.prototype.startsWithIgnoreCase=function(s){return s===""?this.startsWith(s):Mo(this,function(c,h){return c.indexOf(h[0])===0},[s],Sr)},Mt.prototype.equalsIgnoreCase=function(s){return Mo(this,function(c,h){return c===h[0]},[s],"")},Mt.prototype.anyOfIgnoreCase=function(){var s=_e.apply(ge,arguments);return s.length===0?Hr(this):Mo(this,function(c,h){return h.indexOf(c)!==-1},s,"")},Mt.prototype.startsWithAnyOfIgnoreCase=function(){var s=_e.apply(ge,arguments);return s.length===0?Hr(this):Mo(this,function(c,h){return h.some(function(g){return c.indexOf(g)===0})},s,Sr)},Mt.prototype.anyOf=function(){var s=this,c=_e.apply(ge,arguments),h=this._cmp;try{c.sort(h)}catch{return en(this,Nn)}if(c.length===0)return Hr(this);var g=new this.Collection(this,function(){return rr(c[0],c[c.length-1])});g._ondirectionchange=function(w){h=w==="next"?s._ascending:s._descending,c.sort(h)};var m=0;return g._addAlgorithm(function(w,C,T){for(var P=w.key;0<h(P,c[m]);)if(++m===c.length)return C(T),!1;return h(P,c[m])===0||(C(function(){w.continue(c[m])}),!1)}),g},Mt.prototype.notEqual=function(s){return this.inAnyRange([[-1/0,s],[s,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Mt.prototype.noneOf=function(){var s=_e.apply(ge,arguments);if(s.length===0)return new this.Collection(this);try{s.sort(this._ascending)}catch{return en(this,Nn)}var c=s.reduce(function(h,g){return h?h.concat([[h[h.length-1][1],g]]):[[-1/0,g]]},null);return c.push([s[s.length-1],this.db._maxKey]),this.inAnyRange(c,{includeLowers:!1,includeUppers:!1})},Mt.prototype.inAnyRange=function(z,c){var h=this,g=this._cmp,m=this._ascending,w=this._descending,C=this._min,T=this._max;if(z.length===0)return Hr(this);if(!z.every(function(J){return J[0]!==void 0&&J[1]!==void 0&&m(J[0],J[1])<=0}))return en(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);var P=!c||c.includeLowers!==!1,R=c&&c.includeUppers===!0,F,A=m;function H(J,Z){return A(J[0],Z[0])}try{(F=z.reduce(function(J,Z){for(var ee=0,ae=J.length;ee<ae;++ee){var he=J[ee];if(g(Z[0],he[1])<0&&0<g(Z[1],he[0])){he[0]=C(he[0],Z[0]),he[1]=T(he[1],Z[1]);break}}return ee===ae&&J.push(Z),J},[])).sort(H)}catch{return en(this,Nn)}var L=0,N=R?function(J){return 0<m(J,F[L][1])}:function(J){return 0<=m(J,F[L][1])},q=P?function(J){return 0<w(J,F[L][0])}:function(J){return 0<=w(J,F[L][0])},B=N,z=new this.Collection(this,function(){return rr(F[0][0],F[F.length-1][1],!P,!R)});return z._ondirectionchange=function(J){A=J==="next"?(B=N,m):(B=q,w),F.sort(H)},z._addAlgorithm(function(J,Z,ee){for(var ae,he=J.key;B(he);)if(++L===F.length)return Z(ee),!1;return!N(ae=he)&&!q(ae)||(h._cmp(he,F[L][1])===0||h._cmp(he,F[L][0])===0||Z(function(){A===m?J.continue(F[L][0]):J.continue(F[L][1])}),!1)}),z},Mt.prototype.startsWithAnyOf=function(){var s=_e.apply(ge,arguments);return s.every(function(c){return typeof c=="string"})?s.length===0?Hr(this):this.inAnyRange(s.map(function(c){return[c,c+Sr]})):en(this,"startsWithAnyOf() only works with strings")},Mt);function Mt(){}function En(s){return ze(function(c){return Ti(c),s(c.target.error),!1})}function Ti(s){s.stopPropagation&&s.stopPropagation(),s.preventDefault&&s.preventDefault()}var Ai="storagemutated",la="x-storagemutated-1",ir=Ci(null,Ai),Up=(Cn.prototype._lock=function(){return D(!je.global),++this._reculock,this._reculock!==1||je.global||(je.lockOwnerFor=this),this},Cn.prototype._unlock=function(){if(D(!je.global),--this._reculock==0)for(je.global||(je.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var s=this._blockedFuncs.shift();try{kr(s[1],s[0])}catch{}}return this},Cn.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this},Cn.prototype.create=function(s){var c=this;if(!this.mode)return this;var h=this.db.idbdb,g=this.db._state.dbOpenError;if(D(!this.idbtrans),!s&&!h)switch(g&&g.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(g);case"MissingAPIError":throw new oe.MissingAPI(g.message,g);default:throw new oe.OpenFailed(g)}if(!this.active)throw new oe.TransactionInactive;return D(this._completion._state===null),(s=this.idbtrans=s||(this.db.core||h).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ze(function(m){Ti(m),c._reject(s.error)}),s.onabort=ze(function(m){Ti(m),c.active&&c._reject(new oe.Abort(s.error)),c.active=!1,c.on("abort").fire(m)}),s.oncomplete=ze(function(){c.active=!1,c._resolve(),"mutatedParts"in s&&ir.storagemutated.fire(s.mutatedParts)}),this},Cn.prototype._promise=function(s,c,h){var g=this;if(s==="readwrite"&&this.mode!=="readwrite")return xt(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return xt(new oe.TransactionInactive);if(this._locked())return new be(function(w,C){g._blockedFuncs.push([function(){g._promise(s,c,h).then(w,C)},je])});if(h)return cn(function(){var w=new be(function(C,T){g._lock();var P=c(C,T,g);P&&P.then&&P.then(C,T)});return w.finally(function(){return g._unlock()}),w._lib=!0,w});var m=new be(function(w,C){var T=c(w,C,g);T&&T.then&&T.then(w,C)});return m._lib=!0,m},Cn.prototype._root=function(){return this.parent?this.parent._root():this},Cn.prototype.waitFor=function(s){var c,h=this._root(),g=be.resolve(s);h._waitingFor?h._waitingFor=h._waitingFor.then(function(){return g}):(h._waitingFor=g,h._waitingQueue=[],c=h.idbtrans.objectStore(h.storeNames[0]),(function w(){for(++h._spinCount;h._waitingQueue.length;)h._waitingQueue.shift()();h._waitingFor&&(c.get(-1/0).onsuccess=w)})());var m=h._waitingFor;return new be(function(w,C){g.then(function(T){return h._waitingQueue.push(ze(w.bind(null,T)))},function(T){return h._waitingQueue.push(ze(C.bind(null,T)))}).finally(function(){h._waitingFor===m&&(h._waitingFor=null)})})},Cn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new oe.Abort))},Cn.prototype.table=function(s){var c=this._memoizedTables||(this._memoizedTables={});if(p(c,s))return c[s];var h=this.schema[s];if(!h)throw new oe.NotFound("Table "+s+" not part of transaction");return h=new this.db.Table(s,h,this),h.core=this.db.core.table(s),c[s]=h},Cn);function Cn(){}function ca(s,c,h,g,m,w,C,T){return{name:s,keyPath:c,unique:h,multi:g,auto:m,compound:w,src:(h&&!C?"&":"")+(g?"*":"")+(m?"++":"")+jc(c),type:T}}function jc(s){return typeof s=="string"?s:s?"["+[].join.call(s,"+")+"]":""}function ua(s,c,h){return{name:s,primKey:c,indexes:h,mappedClass:null,idxByName:(g=function(m){return[m.name,m]},h.reduce(function(m,w,C){return C=g(w,C),C&&(m[C[0]]=C[1]),m},{}))};var g}var Oi=function(s){try{return s.only([[]]),Oi=function(){return[[]]},[[]]}catch{return Oi=function(){return Sr},Sr}};function fa(s){return s==null?function(){}:typeof s=="string"?(c=s).split(".").length===1?function(h){return h[c]}:function(h){return O(h,c)}:function(h){return O(h,s)};var c}function Lc(s){return[].slice.call(s)}var Np=0;function Mi(s){return s==null?":id":typeof s=="string"?s:"[".concat(s.join("+"),"]")}function Fp(s,c,P){function g(B){if(B.type===3)return null;if(B.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var L=B.lower,N=B.upper,q=B.lowerOpen,B=B.upperOpen;return L===void 0?N===void 0?null:c.upperBound(N,!!B):N===void 0?c.lowerBound(L,!!q):c.bound(L,N,!!q,!!B)}function m(H){var L,N=H.name;return{name:N,schema:H,mutate:function(q){var B=q.trans,z=q.type,J=q.keys,Z=q.values,ee=q.range;return new Promise(function(ae,he){ae=ze(ae);var fe=B.objectStore(N),de=fe.keyPath==null,we=z==="put"||z==="add";if(!we&&z!=="delete"&&z!=="deleteRange")throw new Error("Invalid operation type: "+z);var me,xe=(J||Z||{length:1}).length;if(J&&Z&&J.length!==Z.length)throw new Error("Given keys array must have same length as given values array.");if(xe===0)return ae({numFailures:0,failures:{},results:[],lastResult:void 0});function Ye(Gt){++St,Ti(Gt)}var tt=[],We=[],St=0;if(z==="deleteRange"){if(ee.type===4)return ae({numFailures:St,failures:We,results:[],lastResult:void 0});ee.type===3?tt.push(me=fe.clear()):tt.push(me=fe.delete(g(ee)))}else{var de=we?de?[Z,J]:[Z,null]:[J,null],He=de[0],qt=de[1];if(we)for(var Ht=0;Ht<xe;++Ht)tt.push(me=qt&&qt[Ht]!==void 0?fe[z](He[Ht],qt[Ht]):fe[z](He[Ht])),me.onerror=Ye;else for(Ht=0;Ht<xe;++Ht)tt.push(me=fe[z](He[Ht])),me.onerror=Ye}function Vo(Gt){Gt=Gt.target.result,tt.forEach(function(Ir,Ta){return Ir.error!=null&&(We[Ta]=Ir.error)}),ae({numFailures:St,failures:We,results:z==="delete"?J:tt.map(function(Ir){return Ir.result}),lastResult:Gt})}me.onerror=function(Gt){Ye(Gt),Vo(Gt)},me.onsuccess=Vo})},getMany:function(q){var B=q.trans,z=q.keys;return new Promise(function(J,Z){J=ze(J);for(var ee,ae=B.objectStore(N),he=z.length,fe=new Array(he),de=0,we=0,me=function(tt){tt=tt.target,fe[tt._pos]=tt.result,++we===de&&J(fe)},xe=En(Z),Ye=0;Ye<he;++Ye)z[Ye]!=null&&((ee=ae.get(z[Ye]))._pos=Ye,ee.onsuccess=me,ee.onerror=xe,++de);de===0&&J(fe)})},get:function(q){var B=q.trans,z=q.key;return new Promise(function(J,Z){J=ze(J);var ee=B.objectStore(N).get(z);ee.onsuccess=function(ae){return J(ae.target.result)},ee.onerror=En(Z)})},query:(L=R,function(q){return new Promise(function(B,z){B=ze(B);var J,Z,ee,de=q.trans,ae=q.values,he=q.limit,me=q.query,fe=he===1/0?void 0:he,we=me.index,me=me.range,de=de.objectStore(N),we=we.isPrimaryKey?de:de.index(we.name),me=g(me);if(he===0)return B({result:[]});L?((fe=ae?we.getAll(me,fe):we.getAllKeys(me,fe)).onsuccess=function(xe){return B({result:xe.target.result})},fe.onerror=En(z)):(J=0,Z=!ae&&"openKeyCursor"in we?we.openKeyCursor(me):we.openCursor(me),ee=[],Z.onsuccess=function(xe){var Ye=Z.result;return Ye?(ee.push(ae?Ye.value:Ye.primaryKey),++J===he?B({result:ee}):void Ye.continue()):B({result:ee})},Z.onerror=En(z))})}),openCursor:function(q){var B=q.trans,z=q.values,J=q.query,Z=q.reverse,ee=q.unique;return new Promise(function(ae,he){ae=ze(ae);var we=J.index,fe=J.range,de=B.objectStore(N),de=we.isPrimaryKey?de:de.index(we.name),we=Z?ee?"prevunique":"prev":ee?"nextunique":"next",me=!z&&"openKeyCursor"in de?de.openKeyCursor(g(fe),we):de.openCursor(g(fe),we);me.onerror=En(he),me.onsuccess=ze(function(xe){var Ye,tt,We,St,He=me.result;He?(He.___id=++Np,He.done=!1,Ye=He.continue.bind(He),tt=(tt=He.continuePrimaryKey)&&tt.bind(He),We=He.advance.bind(He),St=function(){throw new Error("Cursor not stopped")},He.trans=B,He.stop=He.continue=He.continuePrimaryKey=He.advance=function(){throw new Error("Cursor not started")},He.fail=ze(he),He.next=function(){var qt=this,Ht=1;return this.start(function(){return Ht--?qt.continue():qt.stop()}).then(function(){return qt})},He.start=function(qt){function Ht(){if(me.result)try{qt()}catch(Gt){He.fail(Gt)}else He.done=!0,He.start=function(){throw new Error("Cursor behind last entry")},He.stop()}var Vo=new Promise(function(Gt,Ir){Gt=ze(Gt),me.onerror=En(Ir),He.fail=Ir,He.stop=function(Ta){He.stop=He.continue=He.continuePrimaryKey=He.advance=St,Gt(Ta)}});return me.onsuccess=ze(function(Gt){me.onsuccess=Ht,Ht()}),He.continue=Ye,He.continuePrimaryKey=tt,He.advance=We,Ht(),Vo},ae(He)):ae(null)},he)})},count:function(q){var B=q.query,z=q.trans,J=B.index,Z=B.range;return new Promise(function(ee,ae){var he=z.objectStore(N),fe=J.isPrimaryKey?he:he.index(J.name),he=g(Z),fe=he?fe.count(he):fe.count();fe.onsuccess=ze(function(de){return ee(de.target.result)}),fe.onerror=En(ae)})}}}var w,C,T,F=(C=P,T=Lc((w=s).objectStoreNames),{schema:{name:w.name,tables:T.map(function(H){return C.objectStore(H)}).map(function(H){var L=H.keyPath,B=H.autoIncrement,N=l(L),q={},B={name:H.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:L==null,compound:N,keyPath:L,autoIncrement:B,unique:!0,extractKey:fa(L)},indexes:Lc(H.indexNames).map(function(z){return H.index(z)}).map(function(ee){var J=ee.name,Z=ee.unique,ae=ee.multiEntry,ee=ee.keyPath,ae={name:J,compound:l(ee),keyPath:ee,unique:Z,multiEntry:ae,extractKey:fa(ee)};return q[Mi(ee)]=ae}),getIndexByKeyPath:function(z){return q[Mi(z)]}};return q[":id"]=B.primaryKey,L!=null&&(q[Mi(L)]=B.primaryKey),B})},hasGetAll:0<T.length&&"getAll"in C.objectStore(T[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),P=F.schema,R=F.hasGetAll,F=P.tables.map(m),A={};return F.forEach(function(H){return A[H.name]=H}),{stack:"dbcore",transaction:s.transaction.bind(s),table:function(H){if(!A[H])throw new Error("Table '".concat(H,"' not found"));return A[H]},MIN_KEY:-1/0,MAX_KEY:Oi(c),schema:P}}function Bp(s,c,h,g){var m=h.IDBKeyRange;return h.indexedDB,{dbcore:(g=Fp(c,m,g),s.dbcore.reduce(function(w,C){return C=C.create,r(r({},w),C(w))},g))}}function Po(s,g){var h=g.db,g=Bp(s._middlewares,h,s._deps,g);s.core=g.dbcore,s.tables.forEach(function(m){var w=m.name;s.core.schema.tables.some(function(C){return C.name===w})&&(m.core=s.core.table(w),s[w]instanceof s.Table&&(s[w].core=m.core))})}function jo(s,c,h,g){h.forEach(function(m){var w=g[m];c.forEach(function(C){var T=(function P(R,F){return x(R,F)||(R=d(R))&&P(R,F)})(C,m);(!T||"value"in T&&T.value===void 0)&&(C===s.Transaction.prototype||C instanceof s.Transaction?b(C,m,{get:function(){return this.table(m)},set:function(P){y(this,m,{value:P,writable:!0,configurable:!0,enumerable:!0})}}):C[m]=new s.Table(m,w))})})}function da(s,c){c.forEach(function(h){for(var g in h)h[g]instanceof s.Table&&delete h[g]})}function Kp(s,c){return s._cfg.version-c._cfg.version}function qp(s,c,h,g){var m=s._dbSchema;h.objectStoreNames.contains("$meta")&&!m.$meta&&(m.$meta=ua("$meta",Uc("")[0],[]),s._storeNames.push("$meta"));var w=s._createTransaction("readwrite",s._storeNames,m);w.create(h),w._completion.catch(g);var C=w._reject.bind(w),T=je.transless||je;cn(function(){return je.trans=w,je.transless=T,c!==0?(Po(s,h),R=c,((P=w).storeNames.includes("$meta")?P.table("$meta").get("version").then(function(F){return F??R}):be.resolve(R)).then(function(F){return H=F,L=w,N=h,q=[],F=(A=s)._versions,B=A._dbSchema=Ro(0,A.idbdb,N),(F=F.filter(function(z){return z._cfg.version>=H})).length!==0?(F.forEach(function(z){q.push(function(){var J=B,Z=z._cfg.dbschema;Uo(A,J,N),Uo(A,Z,N),B=A._dbSchema=Z;var ee=ha(J,Z);ee.add.forEach(function(we){pa(N,we[0],we[1].primKey,we[1].indexes)}),ee.change.forEach(function(we){if(we.recreate)throw new oe.Upgrade("Not yet support for changing primary key");var me=N.objectStore(we.name);we.add.forEach(function(xe){return Lo(me,xe)}),we.change.forEach(function(xe){me.deleteIndex(xe.name),Lo(me,xe)}),we.del.forEach(function(xe){return me.deleteIndex(xe)})});var ae=z._cfg.contentUpgrade;if(ae&&z._cfg.version>H){Po(A,N),L._memoizedTables={};var he=ie(Z);ee.del.forEach(function(we){he[we]=J[we]}),da(A,[A.Transaction.prototype]),jo(A,[A.Transaction.prototype],a(he),he),L.schema=he;var fe,de=G(ae);return de&&Un(),ee=be.follow(function(){var we;(fe=ae(L))&&de&&(we=xn.bind(null,null),fe.then(we,we))}),fe&&typeof fe.then=="function"?be.resolve(fe):ee.then(function(){return fe})}}),q.push(function(J){var Z,ee,ae=z._cfg.dbschema;Z=ae,ee=J,[].slice.call(ee.db.objectStoreNames).forEach(function(he){return Z[he]==null&&ee.db.deleteObjectStore(he)}),da(A,[A.Transaction.prototype]),jo(A,[A.Transaction.prototype],A._storeNames,A._dbSchema),L.schema=A._dbSchema}),q.push(function(J){A.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(A.idbdb.version/10)===z._cfg.version?(A.idbdb.deleteObjectStore("$meta"),delete A._dbSchema.$meta,A._storeNames=A._storeNames.filter(function(Z){return Z!=="$meta"})):J.objectStore("$meta").put(z._cfg.version,"version"))})}),(function z(){return q.length?be.resolve(q.shift()(L.idbtrans)).then(z):be.resolve()})().then(function(){Rc(B,N)})):be.resolve();var A,H,L,N,q,B}).catch(C)):(a(m).forEach(function(F){pa(h,F,m[F].primKey,m[F].indexes)}),Po(s,h),void be.follow(function(){return s.on.populate.fire(w)}).catch(C));var P,R})}function Hp(s,c){Rc(s._dbSchema,c),c.db.version%10!=0||c.objectStoreNames.contains("$meta")||c.db.createObjectStore("$meta").add(Math.ceil(c.db.version/10-1),"version");var h=Ro(0,s.idbdb,c);Uo(s,s._dbSchema,c);for(var g=0,m=ha(h,s._dbSchema).change;g<m.length;g++){var w=(function(C){if(C.change.length||C.recreate)return console.warn("Unable to patch indexes of table ".concat(C.name," because it has changes on the type of index or primary key.")),{value:void 0};var T=c.objectStore(C.name);C.add.forEach(function(P){bt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(C.name,".").concat(P.src)),Lo(T,P)})})(m[g]);if(typeof w=="object")return w.value}}function ha(s,c){var h,g={del:[],add:[],change:[]};for(h in s)c[h]||g.del.push(h);for(h in c){var m=s[h],w=c[h];if(m){var C={name:h,def:w,recreate:!1,del:[],add:[],change:[]};if(""+(m.primKey.keyPath||"")!=""+(w.primKey.keyPath||"")||m.primKey.auto!==w.primKey.auto)C.recreate=!0,g.change.push(C);else{var T=m.idxByName,P=w.idxByName,R=void 0;for(R in T)P[R]||C.del.push(R);for(R in P){var F=T[R],A=P[R];F?F.src!==A.src&&C.change.push(A):C.add.push(A)}(0<C.del.length||0<C.add.length||0<C.change.length)&&g.change.push(C)}}else g.add.push([h,w])}return g}function pa(s,c,h,g){var m=s.db.createObjectStore(c,h.keyPath?{keyPath:h.keyPath,autoIncrement:h.auto}:{autoIncrement:h.auto});return g.forEach(function(w){return Lo(m,w)}),m}function Rc(s,c){a(s).forEach(function(h){c.db.objectStoreNames.contains(h)||(bt&&console.debug("Dexie: Creating missing table",h),pa(c,h,s[h].primKey,s[h].indexes))})}function Lo(s,c){s.createIndex(c.name,c.keyPath,{unique:c.unique,multiEntry:c.multi})}function Ro(s,c,h){var g={};return E(c.objectStoreNames,0).forEach(function(m){for(var w=h.objectStore(m),C=ca(jc(R=w.keyPath),R||"",!0,!1,!!w.autoIncrement,R&&typeof R!="string",!0),T=[],P=0;P<w.indexNames.length;++P){var F=w.index(w.indexNames[P]),R=F.keyPath,F=ca(F.name,R,!!F.unique,!!F.multiEntry,!1,R&&typeof R!="string",!1);T.push(F)}g[m]=ua(m,C,T)}),g}function Uo(s,c,h){for(var g=h.db.objectStoreNames,m=0;m<g.length;++m){var w=g[m],C=h.objectStore(w);s._hasGetAll="getAll"in C;for(var T=0;T<C.indexNames.length;++T){var P=C.indexNames[T],R=C.index(P).keyPath,F=typeof R=="string"?R:"["+E(R).join("+")+"]";!c[w]||(R=c[w].idxByName[F])&&(R.name=P,delete c[w].idxByName[F],c[w].idxByName[P]=R)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(s._hasGetAll=!1)}function Uc(s){return s.split(",").map(function(c,h){var w=c.split(":"),g=(m=w[1])===null||m===void 0?void 0:m.trim(),m=(c=w[0].trim()).replace(/([&*]|\+\+)/g,""),w=/^\[/.test(m)?m.match(/^\[(.*)\]$/)[1].split("+"):m;return ca(m,w||null,/\&/.test(c),/\*/.test(c),/\+\+/.test(c),l(w),h===0,g)})}var Vp=(Vr.prototype._createTableSchema=ua,Vr.prototype._parseIndexSyntax=Uc,Vr.prototype._parseStoresSpec=function(s,c){var h=this;a(s).forEach(function(g){if(s[g]!==null){var m=h._parseIndexSyntax(s[g]),w=m.shift();if(!w)throw new oe.Schema("Invalid schema for table "+g+": "+s[g]);if(w.unique=!0,w.multi)throw new oe.Schema("Primary key cannot be multiEntry*");m.forEach(function(C){if(C.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!C.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")}),m=h._createTableSchema(g,w,m),c[g]=m}})},Vr.prototype.stores=function(h){var c=this.db;this._cfg.storesSource=this._cfg.storesSource?u(this._cfg.storesSource,h):h;var h=c._versions,g={},m={};return h.forEach(function(w){u(g,w._cfg.storesSource),m=w._cfg.dbschema={},w._parseStoresSpec(g,m)}),c._dbSchema=m,da(c,[c._allTables,c,c.Transaction.prototype]),jo(c,[c._allTables,c,c.Transaction.prototype,this._cfg.tables],a(m),m),c._storeNames=a(m),this},Vr.prototype.upgrade=function(s){return this._cfg.contentUpgrade=Xt(this._cfg.contentUpgrade||Se,s),this},Vr);function Vr(){}function va(s,c){var h=s._dbNamesDB;return h||(h=s._dbNamesDB=new Fn(Io,{addons:[],indexedDB:s,IDBKeyRange:c})).version(1).stores({dbnames:"name"}),h.table("dbnames")}function ga(s){return s&&typeof s.databases=="function"}function ya(s){return cn(function(){return je.letThrough=!0,s()})}function ma(s){return!("from"in s)}var Kt=function(s,c){if(!this){var h=new Kt;return s&&"d"in s&&u(h,s),h}u(this,arguments.length?{d:1,from:s,to:1<arguments.length?c:s}:{d:0})};function Pi(s,c,h){var g=Ze(c,h);if(!isNaN(g)){if(0<g)throw RangeError();if(ma(s))return u(s,{from:c,to:h,d:1});var m=s.l,g=s.r;if(Ze(h,s.from)<0)return m?Pi(m,c,h):s.l={from:c,to:h,d:1,l:null,r:null},Fc(s);if(0<Ze(c,s.to))return g?Pi(g,c,h):s.r={from:c,to:h,d:1,l:null,r:null},Fc(s);Ze(c,s.from)<0&&(s.from=c,s.l=null,s.d=g?g.d+1:1),0<Ze(h,s.to)&&(s.to=h,s.r=null,s.d=s.l?s.l.d+1:1),h=!s.r,m&&!s.l&&ji(s,m),g&&h&&ji(s,g)}}function ji(s,c){ma(c)||(function h(g,P){var w=P.from,C=P.to,T=P.l,P=P.r;Pi(g,w,C),T&&h(g,T),P&&h(g,P)})(s,c)}function Nc(s,c){var h=No(c),g=h.next();if(g.done)return!1;for(var m=g.value,w=No(s),C=w.next(m.from),T=C.value;!g.done&&!C.done;){if(Ze(T.from,m.to)<=0&&0<=Ze(T.to,m.from))return!0;Ze(m.from,T.from)<0?m=(g=h.next(T.from)).value:T=(C=w.next(m.from)).value}return!1}function No(s){var c=ma(s)?null:{s:0,n:s};return{next:function(h){for(var g=0<arguments.length;c;)switch(c.s){case 0:if(c.s=1,g)for(;c.n.l&&Ze(h,c.n.from)<0;)c={up:c,n:c.n.l,s:1};else for(;c.n.l;)c={up:c,n:c.n.l,s:1};case 1:if(c.s=2,!g||Ze(h,c.n.to)<=0)return{value:c.n,done:!1};case 2:if(c.n.r){c.s=3,c={up:c,n:c.n.r,s:0};continue}case 3:c=c.up}return{done:!0}}}}function Fc(s){var c,h,g=(((c=s.r)===null||c===void 0?void 0:c.d)||0)-(((h=s.l)===null||h===void 0?void 0:h.d)||0),m=1<g?"r":g<-1?"l":"";m&&(c=m=="r"?"l":"r",h=r({},s),g=s[m],s.from=g.from,s.to=g.to,s[m]=g[m],h[m]=g[c],(s[c]=h).d=Bc(h)),s.d=Bc(s)}function Bc(h){var c=h.r,h=h.l;return(c?h?Math.max(c.d,h.d):c.d:h?h.d:0)+1}function Fo(s,c){return a(c).forEach(function(h){s[h]?ji(s[h],c[h]):s[h]=(function g(m){var w,C,T={};for(w in m)p(m,w)&&(C=m[w],T[w]=!C||typeof C!="object"||W.has(C.constructor)?C:g(C));return T})(c[h])}),s}function ba(s,c){return s.all||c.all||Object.keys(s).some(function(h){return c[h]&&Nc(c[h],s[h])})}v(Kt.prototype,((un={add:function(s){return ji(this,s),this},addKey:function(s){return Pi(this,s,s),this},addKeys:function(s){var c=this;return s.forEach(function(h){return Pi(c,h,h)}),this},hasKey:function(s){var c=No(this).next(s).value;return c&&Ze(c.from,s)<=0&&0<=Ze(c.to,s)}})[te]=function(){return No(this)},un));var Er={},wa={},_a=!1;function Bo(s){Fo(wa,s),_a||(_a=!0,setTimeout(function(){_a=!1,ka(wa,!(wa={}))},0))}function ka(s,c){c===void 0&&(c=!1);var h=new Set;if(s.all)for(var g=0,m=Object.values(Er);g<m.length;g++)Kc(C=m[g],s,h,c);else for(var w in s){var C,T=/^idb\:\/\/(.*)\/(.*)\//.exec(w);T&&(w=T[1],T=T[2],(C=Er["idb://".concat(w,"/").concat(T)])&&Kc(C,s,h,c))}h.forEach(function(P){return P()})}function Kc(s,c,h,g){for(var m=[],w=0,C=Object.entries(s.queries.query);w<C.length;w++){for(var T=C[w],P=T[0],R=[],F=0,A=T[1];F<A.length;F++){var H=A[F];ba(c,H.obsSet)?H.subscribers.forEach(function(B){return h.add(B)}):g&&R.push(H)}g&&m.push([P,R])}if(g)for(var L=0,N=m;L<N.length;L++){var q=N[L],P=q[0],R=q[1];s.queries.query[P]=R}}function zp(s){var c=s._state,h=s._deps.indexedDB;if(c.isBeingOpened||s.idbdb)return c.dbReadyPromise.then(function(){return c.dbOpenError?xt(c.dbOpenError):s});c.isBeingOpened=!0,c.dbOpenError=null,c.openComplete=!1;var g=c.openCanceller,m=Math.round(10*s.verno),w=!1;function C(){if(c.openCanceller!==g)throw new oe.DatabaseClosed("db.open() was cancelled")}function T(){return new be(function(H,L){if(C(),!h)throw new oe.MissingAPI;var N=s.name,q=c.autoSchema||!m?h.open(N):h.open(N,m);if(!q)throw new oe.MissingAPI;q.onerror=En(L),q.onblocked=ze(s._fireOnBlocked),q.onupgradeneeded=ze(function(B){var z;F=q.transaction,c.autoSchema&&!s._options.allowEmptyDB?(q.onerror=Ti,F.abort(),q.result.close(),(z=h.deleteDatabase(N)).onsuccess=z.onerror=ze(function(){L(new oe.NoSuchDatabase("Database ".concat(N," doesnt exist")))})):(F.onerror=En(L),B=B.oldVersion>Math.pow(2,62)?0:B.oldVersion,A=B<1,s.idbdb=q.result,w&&Hp(s,F),qp(s,B/10,F,L))},L),q.onsuccess=ze(function(){F=null;var B,z,J,Z,ee,ae=s.idbdb=q.result,he=E(ae.objectStoreNames);if(0<he.length)try{var fe=ae.transaction((Z=he).length===1?Z[0]:Z,"readonly");if(c.autoSchema)z=ae,J=fe,(B=s).verno=z.version/10,J=B._dbSchema=Ro(0,z,J),B._storeNames=E(z.objectStoreNames,0),jo(B,[B._allTables],a(J),J);else if(Uo(s,s._dbSchema,fe),((ee=ha(Ro(0,(ee=s).idbdb,fe),ee._dbSchema)).add.length||ee.change.some(function(de){return de.add.length||de.change.length}))&&!w)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ae.close(),m=ae.version+1,w=!0,H(T());Po(s,fe)}catch{}Kr.push(s),ae.onversionchange=ze(function(de){c.vcFired=!0,s.on("versionchange").fire(de)}),ae.onclose=ze(function(de){s.on("close").fire(de)}),A&&(ee=s._deps,fe=N,ae=ee.indexedDB,ee=ee.IDBKeyRange,ga(ae)||fe===Io||va(ae,ee).put({name:fe}).catch(Se)),H()},L)}).catch(function(H){switch(H==null?void 0:H.name){case"UnknownError":if(0<c.PR1398_maxLoop)return c.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),T();break;case"VersionError":if(0<m)return m=0,T()}return be.reject(H)})}var P,R=c.dbReadyResolve,F=null,A=!1;return be.race([g,(typeof navigator>"u"?be.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(H){function L(){return indexedDB.databases().finally(H)}P=setInterval(L,100),L()}).finally(function(){return clearInterval(P)}):Promise.resolve()).then(T)]).then(function(){return C(),c.onReadyBeingFired=[],be.resolve(ya(function(){return s.on.ready.fire(s.vip)})).then(function H(){if(0<c.onReadyBeingFired.length){var L=c.onReadyBeingFired.reduce(Xt,Se);return c.onReadyBeingFired=[],be.resolve(ya(function(){return L(s.vip)})).then(H)}})}).finally(function(){c.openCanceller===g&&(c.onReadyBeingFired=null,c.isBeingOpened=!1)}).catch(function(H){c.dbOpenError=H;try{F&&F.abort()}catch{}return g===c.openCanceller&&s._close(),xt(H)}).finally(function(){c.openComplete=!0,R()}).then(function(){var H;return A&&(H={},s.tables.forEach(function(L){L.schema.indexes.forEach(function(N){N.name&&(H["idb://".concat(s.name,"/").concat(L.name,"/").concat(N.name)]=new Kt(-1/0,[[[]]]))}),H["idb://".concat(s.name,"/").concat(L.name,"/")]=H["idb://".concat(s.name,"/").concat(L.name,"/:dels")]=new Kt(-1/0,[[[]]])}),ir(Ai).fire(H),ka(H,!0)),s})}function Sa(s){function c(w){return s.next(w)}var h=m(c),g=m(function(w){return s.throw(w)});function m(w){return function(P){var T=w(P),P=T.value;return T.done?P:P&&typeof P.then=="function"?P.then(h,g):l(P)?Promise.all(P).then(h,g):h(P)}}return m(c)()}function Ko(s,c,h){for(var g=l(s)?s.slice():[s],m=0;m<h;++m)g.push(c);return g}var Wp={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(s){return r(r({},s),{table:function(c){var h=s.table(c),g=h.schema,m={},w=[];function C(A,H,L){var N=Mi(A),q=m[N]=m[N]||[],B=A==null?0:typeof A=="string"?1:A.length,z=0<H,z=r(r({},L),{name:z?"".concat(N,"(virtual-from:").concat(L.name,")"):L.name,lowLevelIndex:L,isVirtual:z,keyTail:H,keyLength:B,extractKey:fa(A),unique:!z&&L.unique});return q.push(z),z.isPrimaryKey||w.push(z),1<B&&C(B===2?A[0]:A.slice(0,B-1),H+1,L),q.sort(function(J,Z){return J.keyTail-Z.keyTail}),z}c=C(g.primaryKey.keyPath,0,g.primaryKey),m[":id"]=[c];for(var T=0,P=g.indexes;T<P.length;T++){var R=P[T];C(R.keyPath,0,R)}function F(A){var H,L=A.query.index;return L.isVirtual?r(r({},A),{query:{index:L.lowLevelIndex,range:(H=A.query.range,L=L.keyTail,{type:H.type===1?2:H.type,lower:Ko(H.lower,H.lowerOpen?s.MAX_KEY:s.MIN_KEY,L),lowerOpen:!0,upper:Ko(H.upper,H.upperOpen?s.MIN_KEY:s.MAX_KEY,L),upperOpen:!0})}}):A}return r(r({},h),{schema:r(r({},g),{primaryKey:c,indexes:w,getIndexByKeyPath:function(A){return(A=m[Mi(A)])&&A[0]}}),count:function(A){return h.count(F(A))},query:function(A){return h.query(F(A))},openCursor:function(A){var H=A.query.index,L=H.keyTail,N=H.isVirtual,q=H.keyLength;return N?h.openCursor(F(A)).then(function(z){return z&&B(z)}):h.openCursor(A);function B(z){return Object.create(z,{continue:{value:function(J){J!=null?z.continue(Ko(J,A.reverse?s.MAX_KEY:s.MIN_KEY,L)):A.unique?z.continue(z.key.slice(0,q).concat(A.reverse?s.MIN_KEY:s.MAX_KEY,L)):z.continue()}},continuePrimaryKey:{value:function(J,Z){z.continuePrimaryKey(Ko(J,s.MAX_KEY,L),Z)}},primaryKey:{get:function(){return z.primaryKey}},key:{get:function(){var J=z.key;return q===1?J[0]:J.slice(0,q)}},value:{get:function(){return z.value}}})}}})}})}};function xa(s,c,h,g){return h=h||{},g=g||"",a(s).forEach(function(m){var w,C,T;p(c,m)?(w=s[m],C=c[m],typeof w=="object"&&typeof C=="object"&&w&&C?(T=De(w))!==De(C)?h[g+m]=c[m]:T==="Object"?xa(w,C,h,g+m+"."):w!==C&&(h[g+m]=c[m]):w!==C&&(h[g+m]=c[m])):h[g+m]=void 0}),a(c).forEach(function(m){p(s,m)||(h[g+m]=c[m])}),h}function Ea(s,c){return c.type==="delete"?c.keys:c.keys||c.values.map(s.extractKey)}var Yp={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(s){return r(r({},s),{table:function(c){var h=s.table(c),g=h.schema.primaryKey;return r(r({},h),{mutate:function(m){var w=je.trans,C=w.table(c).hook,T=C.deleting,P=C.creating,R=C.updating;switch(m.type){case"add":if(P.fire===Se)break;return w._promise("readwrite",function(){return F(m)},!0);case"put":if(P.fire===Se&&R.fire===Se)break;return w._promise("readwrite",function(){return F(m)},!0);case"delete":if(T.fire===Se)break;return w._promise("readwrite",function(){return F(m)},!0);case"deleteRange":if(T.fire===Se)break;return w._promise("readwrite",function(){return(function A(H,L,N){return h.query({trans:H,values:!1,query:{index:g,range:L},limit:N}).then(function(q){var B=q.result;return F({type:"delete",keys:B,trans:H}).then(function(z){return 0<z.numFailures?Promise.reject(z.failures[0]):B.length<N?{failures:[],numFailures:0,lastResult:void 0}:A(H,r(r({},L),{lower:B[B.length-1],lowerOpen:!0}),N)})})})(m.trans,m.range,1e4)},!0)}return h.mutate(m);function F(A){var H,L,N,q=je.trans,B=A.keys||Ea(g,A);if(!B)throw new Error("Keys missing");return(A=A.type==="add"||A.type==="put"?r(r({},A),{keys:B}):r({},A)).type!=="delete"&&(A.values=i([],A.values)),A.keys&&(A.keys=i([],A.keys)),H=h,N=B,((L=A).type==="add"?Promise.resolve([]):H.getMany({trans:L.trans,keys:N,cache:"immutable"})).then(function(z){var J=B.map(function(Z,ee){var ae,he,fe,de=z[ee],we={onerror:null,onsuccess:null};return A.type==="delete"?T.fire.call(we,Z,de,q):A.type==="add"||de===void 0?(ae=P.fire.call(we,Z,A.values[ee],q),Z==null&&ae!=null&&(A.keys[ee]=Z=ae,g.outbound||M(A.values[ee],g.keyPath,Z))):(ae=xa(de,A.values[ee]),(he=R.fire.call(we,ae,Z,de,q))&&(fe=A.values[ee],Object.keys(he).forEach(function(me){p(fe,me)?fe[me]=he[me]:M(fe,me,he[me])}))),we});return h.mutate(A).then(function(Z){for(var ee=Z.failures,ae=Z.results,he=Z.numFailures,Z=Z.lastResult,fe=0;fe<B.length;++fe){var de=(ae||B)[fe],we=J[fe];de==null?we.onerror&&we.onerror(ee[fe]):we.onsuccess&&we.onsuccess(A.type==="put"&&z[fe]?A.values[fe]:de)}return{failures:ee,results:ae,numFailures:he,lastResult:Z}}).catch(function(Z){return J.forEach(function(ee){return ee.onerror&&ee.onerror(Z)}),Promise.reject(Z)})})}}})}})}};function qc(s,c,h){try{if(!c||c.keys.length<s.length)return null;for(var g=[],m=0,w=0;m<c.keys.length&&w<s.length;++m)Ze(c.keys[m],s[w])===0&&(g.push(h?ce(c.values[m]):c.values[m]),++w);return g.length===s.length?g:null}catch{return null}}var Gp={stack:"dbcore",level:-1,create:function(s){return{table:function(c){var h=s.table(c);return r(r({},h),{getMany:function(g){if(!g.cache)return h.getMany(g);var m=qc(g.keys,g.trans._cache,g.cache==="clone");return m?be.resolve(m):h.getMany(g).then(function(w){return g.trans._cache={keys:g.keys,values:g.cache==="clone"?ce(w):w},w})},mutate:function(g){return g.type!=="add"&&(g.trans._cache=null),h.mutate(g)}})}}}};function Hc(s,c){return s.trans.mode==="readonly"&&!!s.subscr&&!s.trans.explicit&&s.trans.db._options.cache!=="disabled"&&!c.schema.primaryKey.outbound}function Vc(s,c){switch(s){case"query":return c.values&&!c.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Jp={stack:"dbcore",level:0,name:"Observability",create:function(s){var c=s.schema.name,h=new Kt(s.MIN_KEY,s.MAX_KEY);return r(r({},s),{transaction:function(g,m,w){if(je.subscr&&m!=="readonly")throw new oe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(je.querier));return s.transaction(g,m,w)},table:function(g){var m=s.table(g),w=m.schema,C=w.primaryKey,A=w.indexes,T=C.extractKey,P=C.outbound,R=C.autoIncrement&&A.filter(function(L){return L.compound&&L.keyPath.includes(C.keyPath)}),F=r(r({},m),{mutate:function(L){function N(me){return me="idb://".concat(c,"/").concat(g,"/").concat(me),Z[me]||(Z[me]=new Kt)}var q,B,z,J=L.trans,Z=L.mutatedParts||(L.mutatedParts={}),ee=N(""),ae=N(":dels"),he=L.type,we=L.type==="deleteRange"?[L.range]:L.type==="delete"?[L.keys]:L.values.length<50?[Ea(C,L).filter(function(me){return me}),L.values]:[],fe=we[0],de=we[1],we=L.trans._cache;return l(fe)?(ee.addKeys(fe),(we=he==="delete"||fe.length===de.length?qc(fe,we):null)||ae.addKeys(fe),(we||de)&&(q=N,B=we,z=de,w.indexes.forEach(function(me){var xe=q(me.name||"");function Ye(We){return We!=null?me.extractKey(We):null}function tt(We){return me.multiEntry&&l(We)?We.forEach(function(St){return xe.addKey(St)}):xe.addKey(We)}(B||z).forEach(function(We,qt){var He=B&&Ye(B[qt]),qt=z&&Ye(z[qt]);Ze(He,qt)!==0&&(He!=null&&tt(He),qt!=null&&tt(qt))})}))):fe?(de={from:(de=fe.lower)!==null&&de!==void 0?de:s.MIN_KEY,to:(de=fe.upper)!==null&&de!==void 0?de:s.MAX_KEY},ae.add(de),ee.add(de)):(ee.add(h),ae.add(h),w.indexes.forEach(function(me){return N(me.name).add(h)})),m.mutate(L).then(function(me){return!fe||L.type!=="add"&&L.type!=="put"||(ee.addKeys(me.results),R&&R.forEach(function(xe){for(var Ye=L.values.map(function(He){return xe.extractKey(He)}),tt=xe.keyPath.findIndex(function(He){return He===C.keyPath}),We=0,St=me.results.length;We<St;++We)Ye[We][tt]=me.results[We];N(xe.name).addKeys(Ye)})),J.mutatedParts=Fo(J.mutatedParts||{},Z),me})}}),A=function(N){var q=N.query,N=q.index,q=q.range;return[N,new Kt((N=q.lower)!==null&&N!==void 0?N:s.MIN_KEY,(q=q.upper)!==null&&q!==void 0?q:s.MAX_KEY)]},H={get:function(L){return[C,new Kt(L.key)]},getMany:function(L){return[C,new Kt().addKeys(L.keys)]},count:A,query:A,openCursor:A};return a(H).forEach(function(L){F[L]=function(N){var q=je.subscr,B=!!q,z=Hc(je,m)&&Vc(L,N)?N.obsSet={}:q;if(B){var J=function(de){return de="idb://".concat(c,"/").concat(g,"/").concat(de),z[de]||(z[de]=new Kt)},Z=J(""),ee=J(":dels"),q=H[L](N),B=q[0],q=q[1];if((L==="query"&&B.isPrimaryKey&&!N.values?ee:J(B.name||"")).add(q),!B.isPrimaryKey){if(L!=="count"){var ae=L==="query"&&P&&N.values&&m.query(r(r({},N),{values:!1}));return m[L].apply(this,arguments).then(function(de){if(L==="query"){if(P&&N.values)return ae.then(function(Ye){return Ye=Ye.result,Z.addKeys(Ye),de});var we=N.values?de.result.map(T):de.result;(N.values?Z:ee).addKeys(we)}else if(L==="openCursor"){var me=de,xe=N.values;return me&&Object.create(me,{key:{get:function(){return ee.addKey(me.primaryKey),me.key}},primaryKey:{get:function(){var Ye=me.primaryKey;return ee.addKey(Ye),Ye}},value:{get:function(){return xe&&Z.addKey(me.primaryKey),me.value}}})}return de})}ee.add(h)}}return m[L].apply(this,arguments)}}),F}})}};function zc(s,c,h){if(h.numFailures===0)return c;if(c.type==="deleteRange")return null;var g=c.keys?c.keys.length:"values"in c&&c.values?c.values.length:1;return h.numFailures===g?null:(c=r({},c),l(c.keys)&&(c.keys=c.keys.filter(function(m,w){return!(w in h.failures)})),"values"in c&&l(c.values)&&(c.values=c.values.filter(function(m,w){return!(w in h.failures)})),c)}function Ca(s,c){return h=s,((g=c).lower===void 0||(g.lowerOpen?0<Ze(h,g.lower):0<=Ze(h,g.lower)))&&(s=s,(c=c).upper===void 0||(c.upperOpen?Ze(s,c.upper)<0:Ze(s,c.upper)<=0));var h,g}function Wc(s,c,H,g,m,w){if(!H||H.length===0)return s;var C=c.query.index,T=C.multiEntry,P=c.query.range,R=g.schema.primaryKey.extractKey,F=C.extractKey,A=(C.lowLevelIndex||C).extractKey,H=H.reduce(function(L,N){var q=L,B=[];if(N.type==="add"||N.type==="put")for(var z=new Kt,J=N.values.length-1;0<=J;--J){var Z,ee=N.values[J],ae=R(ee);z.hasKey(ae)||(Z=F(ee),(T&&l(Z)?Z.some(function(me){return Ca(me,P)}):Ca(Z,P))&&(z.addKey(ae),B.push(ee)))}switch(N.type){case"add":var he=new Kt().addKeys(c.values?L.map(function(xe){return R(xe)}):L),q=L.concat(c.values?B.filter(function(xe){return xe=R(xe),!he.hasKey(xe)&&(he.addKey(xe),!0)}):B.map(function(xe){return R(xe)}).filter(function(xe){return!he.hasKey(xe)&&(he.addKey(xe),!0)}));break;case"put":var fe=new Kt().addKeys(N.values.map(function(xe){return R(xe)}));q=L.filter(function(xe){return!fe.hasKey(c.values?R(xe):xe)}).concat(c.values?B:B.map(function(xe){return R(xe)}));break;case"delete":var de=new Kt().addKeys(N.keys);q=L.filter(function(xe){return!de.hasKey(c.values?R(xe):xe)});break;case"deleteRange":var we=N.range;q=L.filter(function(xe){return!Ca(R(xe),we)})}return q},s);return H===s?s:(H.sort(function(L,N){return Ze(A(L),A(N))||Ze(R(L),R(N))}),c.limit&&c.limit<1/0&&(H.length>c.limit?H.length=c.limit:s.length===c.limit&&H.length<c.limit&&(m.dirty=!0)),w?Object.freeze(H):H)}function Yc(s,c){return Ze(s.lower,c.lower)===0&&Ze(s.upper,c.upper)===0&&!!s.lowerOpen==!!c.lowerOpen&&!!s.upperOpen==!!c.upperOpen}function Qp(s,c){return(function(h,g,m,w){if(h===void 0)return g!==void 0?-1:0;if(g===void 0)return 1;if((g=Ze(h,g))===0){if(m&&w)return 0;if(m)return 1;if(w)return-1}return g})(s.lower,c.lower,s.lowerOpen,c.lowerOpen)<=0&&0<=(function(h,g,m,w){if(h===void 0)return g!==void 0?1:0;if(g===void 0)return-1;if((g=Ze(h,g))===0){if(m&&w)return 0;if(m)return-1;if(w)return 1}return g})(s.upper,c.upper,s.upperOpen,c.upperOpen)}function Xp(s,c,h,g){s.subscribers.add(h),g.addEventListener("abort",function(){var m,w;s.subscribers.delete(h),s.subscribers.size===0&&(m=s,w=c,setTimeout(function(){m.subscribers.size===0&&se(w,m)},3e3))})}var Zp={stack:"dbcore",level:0,name:"Cache",create:function(s){var c=s.schema.name;return r(r({},s),{transaction:function(h,g,m){var w,C,T=s.transaction(h,g,m);return g==="readwrite"&&(C=(w=new AbortController).signal,m=function(P){return function(){if(w.abort(),g==="readwrite"){for(var R=new Set,F=0,A=h;F<A.length;F++){var H=A[F],L=Er["idb://".concat(c,"/").concat(H)];if(L){var N=s.table(H),q=L.optimisticOps.filter(function(xe){return xe.trans===T});if(T._explicit&&P&&T.mutatedParts)for(var B=0,z=Object.values(L.queries.query);B<z.length;B++)for(var J=0,Z=(he=z[B]).slice();J<Z.length;J++)ba((fe=Z[J]).obsSet,T.mutatedParts)&&(se(he,fe),fe.subscribers.forEach(function(xe){return R.add(xe)}));else if(0<q.length){L.optimisticOps=L.optimisticOps.filter(function(xe){return xe.trans!==T});for(var ee=0,ae=Object.values(L.queries.query);ee<ae.length;ee++)for(var he,fe,de,we=0,me=(he=ae[ee]).slice();we<me.length;we++)(fe=me[we]).res!=null&&T.mutatedParts&&(P&&!fe.dirty?(de=Object.isFrozen(fe.res),de=Wc(fe.res,fe.req,q,N,fe,de),fe.dirty?(se(he,fe),fe.subscribers.forEach(function(xe){return R.add(xe)})):de!==fe.res&&(fe.res=de,fe.promise=be.resolve({result:de}))):(fe.dirty&&se(he,fe),fe.subscribers.forEach(function(xe){return R.add(xe)})))}}}R.forEach(function(xe){return xe()})}}},T.addEventListener("abort",m(!1),{signal:C}),T.addEventListener("error",m(!1),{signal:C}),T.addEventListener("complete",m(!0),{signal:C})),T},table:function(h){var g=s.table(h),m=g.schema.primaryKey;return r(r({},g),{mutate:function(w){var C=je.trans;if(m.outbound||C.db._options.cache==="disabled"||C.explicit||C.idbtrans.mode!=="readwrite")return g.mutate(w);var T=Er["idb://".concat(c,"/").concat(h)];return T?(C=g.mutate(w),w.type!=="add"&&w.type!=="put"||!(50<=w.values.length||Ea(m,w).some(function(P){return P==null}))?(T.optimisticOps.push(w),w.mutatedParts&&Bo(w.mutatedParts),C.then(function(P){0<P.numFailures&&(se(T.optimisticOps,w),(P=zc(0,w,P))&&T.optimisticOps.push(P),w.mutatedParts&&Bo(w.mutatedParts))}),C.catch(function(){se(T.optimisticOps,w),w.mutatedParts&&Bo(w.mutatedParts)})):C.then(function(P){var R=zc(0,r(r({},w),{values:w.values.map(function(F,A){var H;return P.failures[A]?F:(F=(H=m.keyPath)!==null&&H!==void 0&&H.includes(".")?ce(F):r({},F),M(F,m.keyPath,P.results[A]),F)})}),P);T.optimisticOps.push(R),queueMicrotask(function(){return w.mutatedParts&&Bo(w.mutatedParts)})}),C):g.mutate(w)},query:function(w){if(!Hc(je,g)||!Vc("query",w))return g.query(w);var C=((R=je.trans)===null||R===void 0?void 0:R.db._options.cache)==="immutable",A=je,T=A.requery,P=A.signal,R=(function(N,q,B,z){var J=Er["idb://".concat(N,"/").concat(q)];if(!J)return[];if(!(q=J.queries[B]))return[null,!1,J,null];var Z=q[(z.query?z.query.index.name:null)||""];if(!Z)return[null,!1,J,null];switch(B){case"query":var ee=Z.find(function(ae){return ae.req.limit===z.limit&&ae.req.values===z.values&&Yc(ae.req.query.range,z.query.range)});return ee?[ee,!0,J,Z]:[Z.find(function(ae){return("limit"in ae.req?ae.req.limit:1/0)>=z.limit&&(!z.values||ae.req.values)&&Qp(ae.req.query.range,z.query.range)}),!1,J,Z];case"count":return ee=Z.find(function(ae){return Yc(ae.req.query.range,z.query.range)}),[ee,!!ee,J,Z]}})(c,h,"query",w),F=R[0],A=R[1],H=R[2],L=R[3];return F&&A?F.obsSet=w.obsSet:(A=g.query(w).then(function(N){var q=N.result;if(F&&(F.res=q),C){for(var B=0,z=q.length;B<z;++B)Object.freeze(q[B]);Object.freeze(q)}else N.result=ce(q);return N}).catch(function(N){return L&&F&&se(L,F),Promise.reject(N)}),F={obsSet:w.obsSet,promise:A,subscribers:new Set,type:"query",req:w,dirty:!1},L?L.push(F):(L=[F],(H=H||(Er["idb://".concat(c,"/").concat(h)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[w.query.index.name||""]=L)),Xp(F,L,T,P),F.promise.then(function(N){return{result:Wc(N.result,w,H==null?void 0:H.optimisticOps,g,F,C)}})}})}})}};function qo(s,c){return new Proxy(s,{get:function(h,g,m){return g==="db"?c:Reflect.get(h,g,m)}})}var Fn=(Et.prototype.version=function(s){if(isNaN(s)||s<.1)throw new oe.Type("Given version is not a positive number");if(s=Math.round(10*s)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,s);var c=this._versions,h=c.filter(function(g){return g._cfg.version===s})[0];return h||(h=new this.Version(s),c.push(h),c.sort(Kp),h.stores({}),this._state.autoSchema=!1,h)},Et.prototype._whenReady=function(s){var c=this;return this.idbdb&&(this._state.openComplete||je.letThrough||this._vip)?s():new be(function(h,g){if(c._state.openComplete)return g(new oe.DatabaseClosed(c._state.dbOpenError));if(!c._state.isBeingOpened){if(!c._state.autoOpen)return void g(new oe.DatabaseClosed);c.open().catch(Se)}c._state.dbReadyPromise.then(h,g)}).then(s)},Et.prototype.use=function(s){var c=s.stack,h=s.create,g=s.level,m=s.name;return m&&this.unuse({stack:c,name:m}),s=this._middlewares[c]||(this._middlewares[c]=[]),s.push({stack:c,create:h,level:g??10,name:m}),s.sort(function(w,C){return w.level-C.level}),this},Et.prototype.unuse=function(s){var c=s.stack,h=s.name,g=s.create;return c&&this._middlewares[c]&&(this._middlewares[c]=this._middlewares[c].filter(function(m){return g?m.create!==g:!!h&&m.name!==h})),this},Et.prototype.open=function(){var s=this;return kr(bn,function(){return zp(s)})},Et.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var s=this._state,c=Kr.indexOf(this);if(0<=c&&Kr.splice(c,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}s.isBeingOpened||(s.dbReadyPromise=new be(function(h){s.dbReadyResolve=h}),s.openCanceller=new be(function(h,g){s.cancelOpen=g}))},Et.prototype.close=function(h){var c=(h===void 0?{disableAutoOpen:!0}:h).disableAutoOpen,h=this._state;c?(h.isBeingOpened&&h.cancelOpen(new oe.DatabaseClosed),this._close(),h.autoOpen=!1,h.dbOpenError=new oe.DatabaseClosed):(this._close(),h.autoOpen=this._options.autoOpen||h.isBeingOpened,h.openComplete=!1,h.dbOpenError=null)},Et.prototype.delete=function(s){var c=this;s===void 0&&(s={disableAutoOpen:!0});var h=0<arguments.length&&typeof arguments[0]!="object",g=this._state;return new be(function(m,w){function C(){c.close(s);var T=c._deps.indexedDB.deleteDatabase(c.name);T.onsuccess=ze(function(){var P,R,F;P=c._deps,R=c.name,F=P.indexedDB,P=P.IDBKeyRange,ga(F)||R===Io||va(F,P).delete(R).catch(Se),m()}),T.onerror=En(w),T.onblocked=c._fireOnBlocked}if(h)throw new oe.InvalidArgument("Invalid closeOptions argument to db.delete()");g.isBeingOpened?g.dbReadyPromise.then(C):C()})},Et.prototype.backendDB=function(){return this.idbdb},Et.prototype.isOpen=function(){return this.idbdb!==null},Et.prototype.hasBeenClosed=function(){var s=this._state.dbOpenError;return s&&s.name==="DatabaseClosed"},Et.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Et.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Et.prototype,"tables",{get:function(){var s=this;return a(this._allTables).map(function(c){return s._allTables[c]})},enumerable:!1,configurable:!0}),Et.prototype.transaction=function(){var s=(function(c,h,g){var m=arguments.length;if(m<2)throw new oe.InvalidArgument("Too few arguments");for(var w=new Array(m-1);--m;)w[m-1]=arguments[m];return g=w.pop(),[c,re(w),g]}).apply(this,arguments);return this._transaction.apply(this,s)},Et.prototype._transaction=function(s,c,h){var g=this,m=je.trans;m&&m.db===this&&s.indexOf("!")===-1||(m=null);var w,C,T=s.indexOf("?")!==-1;s=s.replace("!","").replace("?","");try{if(C=c.map(function(R){if(R=R instanceof g.Table?R.name:R,typeof R!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return R}),s=="r"||s===ia)w=ia;else{if(s!="rw"&&s!=oa)throw new oe.InvalidArgument("Invalid transaction mode: "+s);w=oa}if(m){if(m.mode===ia&&w===oa){if(!T)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");m=null}m&&C.forEach(function(R){if(m&&m.storeNames.indexOf(R)===-1){if(!T)throw new oe.SubTransaction("Table "+R+" not included in parent transaction.");m=null}}),T&&m&&!m.active&&(m=null)}}catch(R){return m?m._promise(null,function(F,A){A(R)}):xt(R)}var P=(function R(F,A,H,L,N){return be.resolve().then(function(){var q=je.transless||je,B=F._createTransaction(A,H,F._dbSchema,L);if(B.explicit=!0,q={trans:B,transless:q},L)B.idbtrans=L.idbtrans;else try{B.create(),B.idbtrans._explicit=!0,F._state.PR1398_maxLoop=3}catch(Z){return Z.name===ye.InvalidState&&F.isOpen()&&0<--F._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),F.close({disableAutoOpen:!1}),F.open().then(function(){return R(F,A,H,null,N)})):xt(Z)}var z,J=G(N);return J&&Un(),q=be.follow(function(){var Z;(z=N.call(B,B))&&(J?(Z=xn.bind(null,null),z.then(Z,Z)):typeof z.next=="function"&&typeof z.throw=="function"&&(z=Sa(z)))},q),(z&&typeof z.then=="function"?be.resolve(z).then(function(Z){return B.active?Z:xt(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):q.then(function(){return z})).then(function(Z){return L&&B._resolve(),B._completion.then(function(){return Z})}).catch(function(Z){return B._reject(Z),xt(Z)})})}).bind(null,this,w,C,m,h);return m?m._promise(w,P,"lock"):je.trans?kr(je.transless,function(){return g._whenReady(P)}):this._whenReady(P)},Et.prototype.table=function(s){if(!p(this._allTables,s))throw new oe.InvalidTable("Table ".concat(s," does not exist"));return this._allTables[s]},Et);function Et(s,c){var h=this;this._middlewares={},this.verno=0;var g=Et.dependencies;this._options=c=r({addons:Et.addons,autoOpen:!0,indexedDB:g.indexedDB,IDBKeyRange:g.IDBKeyRange,cache:"cloned"},c),this._deps={indexedDB:c.indexedDB,IDBKeyRange:c.IDBKeyRange},g=c.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var m,w,C,T,P,R={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Se,dbReadyPromise:null,cancelOpen:Se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:c.autoOpen};R.dbReadyPromise=new be(function(A){R.dbReadyResolve=A}),R.openCanceller=new be(function(A,H){R.cancelOpen=H}),this._state=R,this.name=s,this.on=Ci(this,"populate","blocked","versionchange","close",{ready:[Xt,Se]}),this.once=function(A,H){var L=function(){for(var N=[],q=0;q<arguments.length;q++)N[q]=arguments[q];h.on(A).unsubscribe(L),H.apply(h,N)};return h.on(A,L)},this.on.ready.subscribe=S(this.on.ready.subscribe,function(A){return function(H,L){Et.vip(function(){var N,q=h._state;q.openComplete?(q.dbOpenError||be.resolve().then(H),L&&A(H)):q.onReadyBeingFired?(q.onReadyBeingFired.push(H),L&&A(H)):(A(H),N=h,L||A(function B(){N.on.ready.unsubscribe(H),N.on.ready.unsubscribe(B)}))})}}),this.Collection=(m=this,Ii(jp.prototype,function(z,B){this.db=m;var L=Sc,N=null;if(B)try{L=B()}catch(J){N=J}var q=z._ctx,B=q.table,z=B.hook.reading.fire;this._ctx={table:B,index:q.index,isPrimKey:!q.index||B.schema.primKey.keyPath&&q.index===B.schema.primKey.name,range:L,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:N,or:q.or,valueMapper:z!==Ne?z:null}})),this.Table=(w=this,Ii(Ic.prototype,function(A,H,L){this.db=w,this._tx=L,this.name=A,this.schema=H,this.hook=w._allTables[A]?w._allTables[A].hook:Ci(null,{creating:[mt,Se],reading:[Ue,Ne],updating:[vt,Se],deleting:[kt,Se]})})),this.Transaction=(C=this,Ii(Up.prototype,function(A,H,L,N,q){var B=this;A!=="readonly"&&H.forEach(function(z){z=(z=L[z])===null||z===void 0?void 0:z.yProps,z&&(H=H.concat(z.map(function(J){return J.updatesTable})))}),this.db=C,this.mode=A,this.storeNames=H,this.schema=L,this.chromeTransactionDurability=N,this.idbtrans=null,this.on=Ci(this,"complete","error","abort"),this.parent=q||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new be(function(z,J){B._resolve=z,B._reject=J}),this._completion.then(function(){B.active=!1,B.on.complete.fire()},function(z){var J=B.active;return B.active=!1,B.on.error.fire(z),B.parent?B.parent._reject(z):J&&B.idbtrans&&B.idbtrans.abort(),xt(z)})})),this.Version=(T=this,Ii(Vp.prototype,function(A){this.db=T,this._cfg={version:A,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(P=this,Ii(Pc.prototype,function(A,H,L){if(this.db=P,this._ctx={table:A,index:H===":id"?null:H,or:L},this._cmp=this._ascending=Ze,this._descending=function(N,q){return Ze(q,N)},this._max=function(N,q){return 0<Ze(N,q)?N:q},this._min=function(N,q){return Ze(N,q)<0?N:q},this._IDBKeyRange=P._deps.IDBKeyRange,!this._IDBKeyRange)throw new oe.MissingAPI})),this.on("versionchange",function(A){0<A.newVersion?console.warn("Another connection wants to upgrade database '".concat(h.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(h.name,"'. Closing db now to resume the delete request.")),h.close({disableAutoOpen:!1})}),this.on("blocked",function(A){!A.newVersion||A.newVersion<A.oldVersion?console.warn("Dexie.delete('".concat(h.name,"') was blocked")):console.warn("Upgrade '".concat(h.name,"' blocked by other connection holding version ").concat(A.oldVersion/10))}),this._maxKey=Oi(c.IDBKeyRange),this._createTransaction=function(A,H,L,N){return new h.Transaction(A,H,L,h._options.chromeTransactionDurability,N)},this._fireOnBlocked=function(A){h.on("blocked").fire(A),Kr.filter(function(H){return H.name===h.name&&H!==h&&!H._state.vcFired}).map(function(H){return H.on("versionchange").fire(A)})},this.use(Gp),this.use(Zp),this.use(Jp),this.use(Wp),this.use(Yp);var F=new Proxy(this,{get:function(A,H,L){if(H==="_vip")return!0;if(H==="table")return function(q){return qo(h.table(q),F)};var N=Reflect.get(A,H,L);return N instanceof Ic?qo(N,F):H==="tables"?N.map(function(q){return qo(q,F)}):H==="_createTransaction"?function(){return qo(N.apply(this,arguments),F)}:N}});this.vip=F,g.forEach(function(A){return A(h)})}var Ho,un=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",$p=(Ia.prototype.subscribe=function(s,c,h){return this._subscribe(s&&typeof s!="function"?s:{next:s,error:c,complete:h})},Ia.prototype[un]=function(){return this},Ia);function Ia(s){this._subscribe=s}try{Ho={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ho={indexedDB:null,IDBKeyRange:null}}function Gc(s){var c,h=!1,g=new $p(function(m){var w=G(s),C,T=!1,P={},R={},F={get closed(){return T},unsubscribe:function(){T||(T=!0,C&&C.abort(),A&&ir.storagemutated.unsubscribe(L))}};m.start&&m.start(F);var A=!1,H=function(){return ra(N)},L=function(q){Fo(P,q),ba(R,P)&&H()},N=function(){var q,B,z;!T&&Ho.indexedDB&&(P={},q={},C&&C.abort(),C=new AbortController,z=(function(J){var Z=Xe();try{w&&Un();var ee=cn(s,J);return ee=w?ee.finally(xn):ee}finally{Z&&nt()}})(B={subscr:q,signal:C.signal,requery:H,querier:s,trans:null}),Promise.resolve(z).then(function(J){h=!0,c=J,T||B.signal.aborted||(P={},(function(Z){for(var ee in Z)if(p(Z,ee))return;return 1})(R=q)||A||(ir(Ai,L),A=!0),ra(function(){return!T&&m.next&&m.next(J)}))},function(J){h=!1,["DatabaseClosedError","AbortError"].includes(J==null?void 0:J.name)||T||ra(function(){T||m.error&&m.error(J)})}))};return setTimeout(H,0),F});return g.hasValue=function(){return h},g.getValue=function(){return c},g}var Cr=Fn;function Da(s){var c=or;try{or=!0,ir.storagemutated.fire(s),ka(s,!0)}finally{or=c}}v(Cr,r(r({},Be),{delete:function(s){return new Cr(s,{addons:[]}).delete()},exists:function(s){return new Cr(s,{addons:[]}).open().then(function(c){return c.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(s){try{return c=Cr.dependencies,h=c.indexedDB,c=c.IDBKeyRange,(ga(h)?Promise.resolve(h.databases()).then(function(g){return g.map(function(m){return m.name}).filter(function(m){return m!==Io})}):va(h,c).toCollection().primaryKeys()).then(s)}catch{return xt(new oe.MissingAPI)}var c,h},defineClass:function(){return function(s){u(this,s)}},ignoreTransaction:function(s){return je.trans?kr(je.transless,s):s()},vip:ya,async:function(s){return function(){try{var c=Sa(s.apply(this,arguments));return c&&typeof c.then=="function"?c:be.resolve(c)}catch(h){return xt(h)}}},spawn:function(s,c,h){try{var g=Sa(s.apply(h,c||[]));return g&&typeof g.then=="function"?g:be.resolve(g)}catch(m){return xt(m)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(s,c){return c=be.resolve(typeof s=="function"?Cr.ignoreTransaction(s):s).timeout(c||6e4),je.trans?je.trans.waitFor(c):c},Promise:be,debug:{get:function(){return bt},set:function(s){Ln(s)}},derive:k,extend:u,props:v,override:S,Events:Ci,on:ir,liveQuery:Gc,extendObservabilitySet:Fo,getByKeyPath:O,setByKeyPath:M,delByKeyPath:function(s,c){typeof c=="string"?M(s,c,void 0):"length"in c&&[].map.call(c,function(h){M(s,h,void 0)})},shallowClone:ie,deepClone:ce,getObjectDiff:xa,cmp:Ze,asap:j,minKey:-1/0,addons:[],connections:Kr,errnames:ye,dependencies:Ho,cache:Er,semVer:"4.2.0",version:"4.2.0".split(".").map(function(s){return parseInt(s)}).reduce(function(s,c,h){return s+c/Math.pow(10,2*h)})})),Cr.maxKey=Oi(Cr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ir(Ai,function(s){or||(s=new CustomEvent(la,{detail:s}),or=!0,dispatchEvent(s),or=!1)}),addEventListener(la,function(s){s=s.detail,or||Da(s)}));var zr,or=!1,Jc=function(){};return typeof BroadcastChannel<"u"&&((Jc=function(){(zr=new BroadcastChannel(la)).onmessage=function(s){return s.data&&Da(s.data)}})(),typeof zr.unref=="function"&&zr.unref(),ir(Ai,function(s){or||zr.postMessage(s)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(s){if(!Fn.disableBfCache&&s.persisted){bt&&console.debug("Dexie: handling persisted pagehide"),zr!=null&&zr.close();for(var c=0,h=Kr;c<h.length;c++)h[c].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(s){!Fn.disableBfCache&&s.persisted&&(bt&&console.debug("Dexie: handling persisted pageshow"),Jc(),Da({all:new Kt(-1/0,[[]])}))})),be.rejectionMapper=function(s,c){return!s||s instanceof Y||s instanceof TypeError||s instanceof SyntaxError||!s.name||!Pe[s.name]?s:(c=new Pe[s.name](c||s.message,s),"stack"in s&&b(c,"stack",{get:function(){return this.inner.stack}}),c)},Ln(bt),r(Fn,Object.freeze({__proto__:null,Dexie:Fn,liveQuery:Gc,Entity:xc,cmp:Ze,PropModification:Di,replacePrefix:function(s,c){return new Di({replacePrefix:[s,c]})},add:function(s){return new Di({add:s})},remove:function(s){return new Di({remove:s})},default:Fn,RangeSet:Kt,mergeRanges:ji,rangesOverlap:Nc}),{default:Fn}),Fn})})(rs)),rs.exports}var og=ig();const fl=td(og),uu=Symbol.for("Dexie"),rt=globalThis[uu]||(globalThis[uu]=fl);if(fl.semVer!==rt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${fl.semVer} and ${rt.semVer}`);const{liveQuery:cr,mergeRanges:eS,rangesOverlap:tS,RangeSet:sg,cmp:Ns,Entity:nS,PropModification:fu,replacePrefix:rS,add:iS,remove:oS,DexieYProvider:sS}=rt,Yn=Math.floor,is=Math.abs,nd=(t,e)=>t<e?t:e,di=(t,e)=>t>e?t:e,rd=t=>t!==0?t<0:1/t<0,du=1,hu=2,Na=4,Fa=8,io=32,zn=64,rn=128,Fs=31,dl=63,Or=127,ag=2147483647,id=Number.MAX_SAFE_INTEGER,lg=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&Yn(t)===t),Mr=()=>new Set,Ba=t=>t[t.length-1],cg=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},pr=Array.from,ug=Array.isArray,fg=t=>t.toLowerCase(),dg=/^\s*/g,hg=t=>t.replace(dg,""),pg=/([A-Z])/g,pu=(t,e)=>hg(t.replace(pg,n=>`${e}${fg(n)}`)),vg=t=>{const e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=e.codePointAt(i);return r},oo=typeof TextEncoder<"u"?new TextEncoder:null,gg=t=>oo.encode(t),yg=oo?gg:vg;let Gi=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Gi&&Gi.decode(new Uint8Array).length===1&&(Gi=null);class hi{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const pi=()=>new hi,mg=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},nn=t=>{const e=new Uint8Array(mg(t));let n=0;for(let r=0;r<t.bufs.length;r++){const i=t.bufs[r];e.set(i,n),n+=i.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},bg=(t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(di(n,e)*2),t.cpos=0)},Pt=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(n*2),t.cpos=0),t.cbuf[t.cpos++]=e},hl=Pt,Ge=(t,e)=>{for(;e>Or;)Pt(t,rn|Or&e),e=Yn(e/128);Pt(t,Or&e)},Yl=(t,e)=>{const n=rd(e);for(n&&(e=-e),Pt(t,(e>dl?rn:0)|(n?zn:0)|dl&e),e=Yn(e/64);e>0;)Pt(t,(e>Or?rn:0)|Or&e),e=Yn(e/128)},pl=new Uint8Array(3e4),wg=pl.length/3,_g=(t,e)=>{if(e.length<wg){const n=oo.encodeInto(e,pl).written||0;Ge(t,n);for(let r=0;r<n;r++)Pt(t,pl[r])}else Lt(t,yg(e))},kg=(t,e)=>{const n=unescape(encodeURIComponent(e)),r=n.length;Ge(t,r);for(let i=0;i<r;i++)Pt(t,n.codePointAt(i))},dn=oo&&oo.encodeInto?_g:kg,Sg=(t,e)=>mo(t,nn(e)),mo=(t,e)=>{const n=t.cbuf.length,r=t.cpos,i=nd(n-r,e.length),o=e.length-i;t.cbuf.set(e.subarray(0,i),r),t.cpos+=i,o>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(di(n*2,o)),t.cbuf.set(e.subarray(i)),t.cpos=o)},Lt=(t,e)=>{Ge(t,e.byteLength),mo(t,e)},Bs=(t,e)=>{bg(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},xg=(t,e)=>Bs(t,4).setFloat32(0,e,!1),Eg=(t,e)=>Bs(t,8).setFloat64(0,e,!1),Cg=(t,e)=>Bs(t,8).setBigInt64(0,e,!1),vu=(t,e)=>Bs(t,8).setBigUint64(0,e,!1),gu=new DataView(new ArrayBuffer(4)),Ig=t=>(gu.setFloat32(0,t),gu.getFloat32(0)===t),ur=(t,e)=>{switch(typeof e){case"string":Pt(t,119),dn(t,e);break;case"number":lg(e)&&is(e)<=ag?(Pt(t,125),Yl(t,e)):Ig(e)?(Pt(t,124),xg(t,e)):(Pt(t,123),Eg(t,e));break;case"bigint":Pt(t,122),Cg(t,e);break;case"object":if(e===null)Pt(t,126);else if(ug(e)){Pt(t,117),Ge(t,e.length);for(let n=0;n<e.length;n++)ur(t,e[n])}else if(e instanceof Uint8Array)Pt(t,116),Lt(t,e);else{Pt(t,118);const n=Object.keys(e);Ge(t,n.length);for(let r=0;r<n.length;r++){const i=n[r];dn(t,i),ur(t,e[i])}}break;case"boolean":Pt(t,e?120:121);break;default:Pt(t,127)}};class yu extends hi{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Ge(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const mu=t=>{t.count>0&&(Yl(t.encoder,t.count===1?t.s:-t.s),t.count>1&&Ge(t.encoder,t.count-2))};class os{constructor(){this.encoder=new hi,this.s=0,this.count=0}write(e){this.s===e?this.count++:(mu(this),this.count=1,this.s=e)}toUint8Array(){return mu(this),nn(this.encoder)}}const bu=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);Yl(t.encoder,e),t.count>1&&Ge(t.encoder,t.count-2)}};class Ka{constructor(){this.encoder=new hi,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(bu(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return bu(this),nn(this.encoder)}}class Dg{constructor(){this.sarr=[],this.s="",this.lensE=new os}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new hi;return this.sarr.push(this.s),this.s="",dn(e,this.sarr.join("")),mo(e,this.lensE.toUint8Array()),nn(e)}}const vr=t=>new Error(t),On=()=>{throw vr("Method unimplemented")},Mn=()=>{throw vr("Unexpected case")},od=vr("Unexpected end of array"),sd=vr("Integer out of Range");class vi{constructor(e){this.arr=e,this.pos=0}}const bo=t=>new vi(t),ad=t=>t.pos!==t.arr.length,Tg=(t,e)=>{const n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},Rt=t=>Tg(t,dt(t)),ni=t=>t.arr[t.pos++],dt=t=>{let e=0,n=1;const r=t.arr.length;for(;t.pos<r;){const i=t.arr[t.pos++];if(e=e+(i&Or)*n,n*=128,i<rn)return e;if(e>id)throw sd}throw od},Gl=t=>{let e=t.arr[t.pos++],n=e&dl,r=64;const i=(e&zn)>0?-1:1;if((e&rn)===0)return i*n;const o=t.arr.length;for(;t.pos<o;){if(e=t.arr[t.pos++],n=n+(e&Or)*r,r*=128,e<rn)return i*n;if(n>id)throw sd}throw od},Ag=t=>{let e=dt(t);if(e===0)return"";{let n=String.fromCodePoint(ni(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(ni(t));else for(;e>0;){const r=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(n))}},Og=t=>Gi.decode(Rt(t)),hn=Gi?Og:Ag,Ks=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},Mg=t=>Ks(t,4).getFloat32(0,!1),Pg=t=>Ks(t,8).getFloat64(0,!1),jg=t=>Ks(t,8).getBigInt64(0,!1),wu=t=>Ks(t,8).getBigUint64(0,!1),Lg=[t=>{},t=>null,Gl,Mg,Pg,jg,t=>!1,t=>!0,hn,t=>{const e=dt(t),n={};for(let r=0;r<e;r++){const i=hn(t);n[i]=fr(t)}return n},t=>{const e=dt(t),n=[];for(let r=0;r<e;r++)n.push(fr(t));return n},Rt],fr=t=>Lg[127-ni(t)](t);class _u extends vi{constructor(e,n){super(e),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),ad(this)?this.count=dt(this)+1:this.count=-1),this.count--,this.s}}class ss extends vi{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Gl(this);const e=rd(this.s);this.count=1,e&&(this.s=-this.s,this.count=dt(this)+2)}return this.count--,this.s}}class qa extends vi{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=Gl(this),n=e&1;this.diff=Yn(e/2),this.count=1,n&&(this.count=dt(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Rg{constructor(e){this.decoder=new ss(e),this.str=hn(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),n=this.str.slice(this.spos,e);return this.spos=e,n}}var vl=function(t,e){return vl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},vl(t,e)};function Jn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vl(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function Ug(t,e,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(f){try{d(r.next(f))}catch(p){a(p)}}function u(f){try{d(r.throw(f))}catch(p){a(p)}}function d(f){f.done?o(f.value):i(f.value).then(l,u)}d((r=r.apply(t,e||[])).next())})}function ld(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(d){return function(f){return u([d,f])}}function u(d){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,d[0]&&(n=0)),n;)try{if(r=1,i&&(o=d[0]&2?i.return:d[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,d[1])).done)return o;switch(i=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,i=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){n.label=d[1];break}if(d[0]===6&&n.label<o[1]){n.label=o[1],o=d;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(d);break}o[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(f){d=[6,f],i=0}finally{r=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function ri(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pr(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(l){a={error:l}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return o}function ii(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function Xr(t){return this instanceof Xr?(this.v=t,this):new Xr(t)}function Ng(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(y){return function(b){return Promise.resolve(b).then(y,p)}}function l(y,b){r[y]&&(i[y]=function(k){return new Promise(function(x,I){o.push([y,k,x,I])>1||u(y,k)})},b&&(i[y]=b(i[y])))}function u(y,b){try{d(r[y](b))}catch(k){v(o[0][3],k)}}function d(y){y.value instanceof Xr?Promise.resolve(y.value.v).then(f,p):v(o[0][2],y)}function f(y){u("next",y)}function p(y){u("throw",y)}function v(y,b){y(b),o.shift(),o.length&&u(o[0][0],o[0][1])}}function Fg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof ri=="function"?ri(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(a){return new Promise(function(l,u){a=t[o](a),i(l,u,a.done,a.value)})}}function i(o,a,l,u){Promise.resolve(u).then(function(d){o({value:d,done:l})},a)}}function ft(t){return typeof t=="function"}function Jl(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ha=Jl(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function gs(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var gi=(function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var l=ri(a),u=l.next();!u.done;u=l.next()){var d=u.value;d.remove(this)}}catch(k){e={error:k}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}else a.remove(this);var f=this.initialTeardown;if(ft(f))try{f()}catch(k){o=k instanceof Ha?k.errors:[k]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var v=ri(p),y=v.next();!y.done;y=v.next()){var b=y.value;try{ku(b)}catch(k){o=o??[],k instanceof Ha?o=ii(ii([],Pr(o)),Pr(k.errors)):o.push(k)}}}catch(k){r={error:k}}finally{try{y&&!y.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}}if(o)throw new Ha(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)ku(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&gs(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&gs(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=(function(){var e=new t;return e.closed=!0,e})(),t})(),cd=gi.EMPTY;function ud(t){return t instanceof gi||t&&"closed"in t&&ft(t.remove)&&ft(t.add)&&ft(t.unsubscribe)}function ku(t){ft(t)?t():t.unsubscribe()}var Bg={Promise:void 0},Kg={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,ii([t,e],Pr(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function fd(t){Kg.setTimeout(function(){throw t})}function Su(){}function as(t){t()}var Ql=(function(t){Jn(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,ud(n)&&n.add(r)):r.destination=Vg,r}return e.create=function(n,r,i){return new oi(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(gi),qg=(function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Wo(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Wo(r)}else Wo(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Wo(n)}},t})(),oi=(function(t){Jn(e,t);function e(n,r,i){var o=t.call(this)||this,a;return ft(n)||!n?a={next:n??void 0,error:r??void 0,complete:i??void 0}:a=n,o.destination=new qg(a),o}return e})(Ql);function Wo(t){fd(t)}function Hg(t){throw t}var Vg={closed:!0,next:Su,error:Hg,complete:Su},Xl=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function yi(t){return t}function zg(t){return t.length===0?yi:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var At=(function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=Yg(e)?e:new oi(e,n,r);return as(function(){var a=i,l=a.operator,u=a.source;o.add(l?l.call(o,u):u?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=xu(n),new n(function(i,o){var a=new oi({next:function(l){try{e(l)}catch(u){o(u),a.unsubscribe()}},error:o,complete:i});r.subscribe(a)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Xl]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return zg(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=xu(e),new e(function(r,i){var o;n.subscribe(function(a){return o=a},function(a){return i(a)},function(){return r(o)})})},t.create=function(e){return new t(e)},t})();function xu(t){var e;return(e=t??Bg.Promise)!==null&&e!==void 0?e:Promise}function Wg(t){return t&&ft(t.next)&&ft(t.error)&&ft(t.complete)}function Yg(t){return t&&t instanceof Ql||Wg(t)&&ud(t)}function Gg(t){return ft(t==null?void 0:t.lift)}function an(t){return function(e){if(Gg(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function sn(t,e,n,r,i){return new Jg(t,e,n,r,i)}var Jg=(function(t){Jn(e,t);function e(n,r,i,o,a,l){var u=t.call(this,n)||this;return u.onFinalize=a,u.shouldUnsubscribe=l,u._next=r?function(d){try{r(d)}catch(f){n.error(f)}}:t.prototype._next,u._error=o?function(d){try{o(d)}catch(f){n.error(f)}finally{this.unsubscribe()}}:t.prototype._error,u._complete=i?function(){try{i()}catch(d){n.error(d)}finally{this.unsubscribe()}}:t.prototype._complete,u}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e})(Ql),Qg=Jl(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),jr=(function(t){Jn(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new Eu(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Qg},e.prototype.next=function(n){var r=this;as(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=ri(r.currentObservers),l=a.next();!l.done;l=a.next()){var u=l.value;u.next(n)}}catch(d){i={error:d}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;as(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;as(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,a=i.isStopped,l=i.observers;return o||a?cd:(this.currentObservers=null,l.push(n),new gi(function(){r.currentObservers=null,gs(l,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,a=r.isStopped;i?n.error(o):a&&n.complete()},e.prototype.asObservable=function(){var n=new At;return n.source=this,n},e.create=function(n,r){return new Eu(n,r)},e})(At),Eu=(function(t){Jn(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:cd},e})(jr),_n=(function(t){Jn(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e})(jr),Xg={now:function(){return Date.now()}},Zg=(function(t){Jn(e,t);function e(n,r){return t.call(this)||this}return e.prototype.schedule=function(n,r){return this},e})(gi),Cu={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,ii([t,e],Pr(n)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},$g=(function(t){Jn(e,t);function e(n,r){var i=t.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(n,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var o=this.id,a=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(a,o,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(a,this.id,r),this},e.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),Cu.setInterval(n.flush.bind(n,this),i)},e.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&Cu.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var i=!1,o;try{this.work(n)}catch(a){i=!0,o=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,i=n.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,gs(o,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e})(Zg),Iu=(function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},t.now=Xg.now,t})(),ey=(function(t){Jn(e,t);function e(n,r){r===void 0&&(r=Iu.now);var i=t.call(this,n,r)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}},e})(Iu),Zl=new ey($g),ty=Zl,dd=new At(function(t){return t.complete()});function hd(t){return t&&ft(t.schedule)}function $l(t){return t[t.length-1]}function ny(t){return ft($l(t))?t.pop():void 0}function wo(t){return hd($l(t))?t.pop():void 0}function ry(t,e){return typeof $l(t)=="number"?t.pop():e}var ec=(function(t){return t&&typeof t.length=="number"&&typeof t!="function"});function pd(t){return ft(t==null?void 0:t.then)}function vd(t){return ft(t[Xl])}function gd(t){return Symbol.asyncIterator&&ft(t==null?void 0:t[Symbol.asyncIterator])}function yd(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function iy(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var md=iy();function bd(t){return ft(t==null?void 0:t[md])}function wd(t){return Ng(this,arguments,function(){var n,r,i,o;return ld(this,function(a){switch(a.label){case 0:n=t.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Xr(n.read())];case 3:return r=a.sent(),i=r.value,o=r.done,o?[4,Xr(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Xr(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function _d(t){return ft(t==null?void 0:t.getReader)}function gn(t){if(t instanceof At)return t;if(t!=null){if(vd(t))return oy(t);if(ec(t))return sy(t);if(pd(t))return ay(t);if(gd(t))return kd(t);if(bd(t))return ly(t);if(_d(t))return cy(t)}throw yd(t)}function oy(t){return new At(function(e){var n=t[Xl]();if(ft(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function sy(t){return new At(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function ay(t){return new At(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,fd)})}function ly(t){return new At(function(e){var n,r;try{for(var i=ri(t),o=i.next();!o.done;o=i.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function kd(t){return new At(function(e){uy(t,e).catch(function(n){return e.error(n)})})}function cy(t){return kd(wd(t))}function uy(t,e){var n,r,i,o;return Ug(this,void 0,void 0,function(){var a,l;return ld(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=Fg(t),u.label=1;case 1:return[4,n.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=u.sent(),i={error:l},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function dr(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function Sd(t,e){return e===void 0&&(e=0),an(function(n,r){n.subscribe(sn(r,function(i){return dr(r,t,function(){return r.next(i)},e)},function(){return dr(r,t,function(){return r.complete()},e)},function(i){return dr(r,t,function(){return r.error(i)},e)}))})}function xd(t,e){return e===void 0&&(e=0),an(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function fy(t,e){return gn(t).pipe(xd(e),Sd(e))}function dy(t,e){return gn(t).pipe(xd(e),Sd(e))}function hy(t,e){return new At(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function py(t,e){return new At(function(n){var r;return dr(n,e,function(){r=t[md](),dr(n,e,function(){var i,o,a;try{i=r.next(),o=i.value,a=i.done}catch(l){n.error(l);return}a?n.complete():n.next(o)},0,!0)}),function(){return ft(r==null?void 0:r.return)&&r.return()}})}function Ed(t,e){if(!t)throw new Error("Iterable cannot be null");return new At(function(n){dr(n,e,function(){var r=t[Symbol.asyncIterator]();dr(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function vy(t,e){return Ed(wd(t),e)}function gy(t,e){if(t!=null){if(vd(t))return fy(t,e);if(ec(t))return hy(t,e);if(pd(t))return dy(t,e);if(gd(t))return Ed(t,e);if(bd(t))return py(t,e);if(_d(t))return vy(t,e)}throw yd(t)}function on(t,e){return e?gy(t,e):gn(t)}function Wn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=wo(t);return on(t,n)}function Du(t,e){var n=ft(t)?t:function(){return t},r=function(i){return i.error(n())};return new At(r)}var yy=Jl(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function Tr(t,e){return new Promise(function(n,r){var i=new oi({next:function(o){n(o),i.unsubscribe()},error:r,complete:function(){r(new yy)}});t.subscribe(i)})}function my(t){return t instanceof Date&&!isNaN(t)}function tn(t,e){return an(function(n,r){var i=0;n.subscribe(sn(r,function(o){r.next(t.call(e,o,i++))}))})}var by=Array.isArray;function wy(t,e){return by(e)?t.apply(void 0,ii([],Pr(e))):t(e)}function Cd(t){return tn(function(e){return wy(t,e)})}var _y=Array.isArray,ky=Object.getPrototypeOf,Sy=Object.prototype,xy=Object.keys;function Ey(t){if(t.length===1){var e=t[0];if(_y(e))return{args:e,keys:null};if(Cy(e)){var n=xy(e);return{args:n.map(function(r){return e[r]}),keys:n}}}return{args:t,keys:null}}function Cy(t){return t&&typeof t=="object"&&ky(t)===Sy}function Iy(t,e){return t.reduce(function(n,r,i){return n[r]=e[i],n},{})}function so(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=wo(t),r=ny(t),i=Ey(t),o=i.args,a=i.keys;if(o.length===0)return on([],n);var l=new At(Dy(o,n,a?function(u){return Iy(a,u)}:yi));return r?l.pipe(Cd(r)):l}function Dy(t,e,n){return n===void 0&&(n=yi),function(r){Tu(e,function(){for(var i=t.length,o=new Array(i),a=i,l=i,u=function(f){Tu(e,function(){var p=on(t[f],e),v=!1;p.subscribe(sn(r,function(y){o[f]=y,v||(v=!0,l--),l||r.next(n(o.slice()))},function(){--a||r.complete()}))},r)},d=0;d<i;d++)u(d)},r)}}function Tu(t,e,n){t?dr(n,t,e):e()}function Ty(t,e,n,r,i,o,a,l){var u=[],d=0,f=0,p=!1,v=function(){p&&!u.length&&!d&&e.complete()},y=function(k){return d<r?b(k):u.push(k)},b=function(k){d++;var x=!1;gn(n(k,f++)).subscribe(sn(e,function(I){e.next(I)},function(){x=!0},void 0,function(){if(x)try{d--;for(var I=function(){var E=u.shift();a||b(E)};u.length&&d<r;)I();v()}catch(E){e.error(E)}}))};return t.subscribe(sn(e,y,function(){p=!0,v()})),function(){}}function _o(t,e,n){return n===void 0&&(n=1/0),ft(e)?_o(function(r,i){return tn(function(o,a){return e(r,o,i,a)})(gn(t(r,i)))},n):(typeof e=="number"&&(n=e),an(function(r,i){return Ty(r,i,t,n)}))}function Id(t){return t===void 0&&(t=1/0),_o(yi,t)}function Ay(){return Id(1)}function Au(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ay()(on(t,wo(t)))}var Oy=["addListener","removeListener"],My=["addEventListener","removeEventListener"],Py=["on","off"];function An(t,e,n,r){if(ft(n)&&(r=n,n=void 0),r)return An(t,e,n).pipe(Cd(r));var i=Pr(Ry(t)?My.map(function(l){return function(u){return t[l](e,u,n)}}):jy(t)?Oy.map(Ou(t,e)):Ly(t)?Py.map(Ou(t,e)):[],2),o=i[0],a=i[1];if(!o&&ec(t))return _o(function(l){return An(l,e,n)})(gn(t));if(!o)throw new TypeError("Invalid event target");return new At(function(l){var u=function(){for(var d=[],f=0;f<arguments.length;f++)d[f]=arguments[f];return l.next(1<d.length?d:d[0])};return o(u),function(){return a(u)}})}function Ou(t,e){return function(n){return function(r){return t[n](e,r)}}}function jy(t){return ft(t.addListener)&&ft(t.removeListener)}function Ly(t){return ft(t.on)&&ft(t.off)}function Ry(t){return ft(t.addEventListener)&&ft(t.removeEventListener)}function Dd(t,e,n){t===void 0&&(t=0),n===void 0&&(n=ty);var r=-1;return e!=null&&(hd(e)?n=e:r=e),new At(function(i){var o=my(t)?+t-n.now():t;o<0&&(o=0);var a=0;return n.schedule(function(){i.closed||(i.next(a++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function qs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=wo(t),r=ry(t,1/0),i=t;return i.length?i.length===1?gn(i[0]):Id(r)(on(i,n)):dd}function fn(t,e){return an(function(n,r){var i=0;n.subscribe(sn(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function gl(t){return an(function(e,n){var r=null,i=!1,o;r=e.subscribe(sn(n,void 0,void 0,function(a){o=gn(t(a,gl(t)(e))),r?(r.unsubscribe(),r=null,o.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(n))})}function Mu(t,e){return e===void 0&&(e=Zl),an(function(n,r){var i=null,o=null,a=null,l=function(){if(i){i.unsubscribe(),i=null;var d=o;o=null,r.next(d)}};function u(){var d=a+t,f=e.now();if(f<d){i=this.schedule(void 0,d-f),r.add(i);return}l()}n.subscribe(sn(r,function(d){o=d,a=e.now(),i||(i=e.schedule(u,t),r.add(i))},function(){l(),r.complete()},void 0,function(){o=i=null}))})}function Gr(t){return t<=0?function(){return dd}:an(function(e,n){var r=0;e.subscribe(sn(n,function(i){++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Uy(t){return tn(function(){return t})}function Ny(t,e){return _o(function(n,r){return gn(t(n,r)).pipe(Gr(1),Uy(n))})}function Td(t,e){e===void 0&&(e=Zl);var n=Dd(t,e);return Ny(function(){return n})}function Ad(t,e){return e===void 0&&(e=yi),t=t??Fy,an(function(n,r){var i,o=!0;n.subscribe(sn(r,function(a){var l=e(a);(o||!t(i,l))&&(o=!1,i=l,r.next(a))}))})}function Fy(t,e){return t===e}function By(t){t===void 0&&(t={});var e=t.connector,n=e===void 0?function(){return new jr}:e,r=t.resetOnError,i=r===void 0?!0:r,o=t.resetOnComplete,a=o===void 0?!0:o,l=t.resetOnRefCountZero,u=l===void 0?!0:l;return function(d){var f,p,v,y=0,b=!1,k=!1,x=function(){p==null||p.unsubscribe(),p=void 0},I=function(){x(),f=v=void 0,b=k=!1},E=function(){var S=f;I(),S==null||S.unsubscribe()};return an(function(S,D){y++,!k&&!b&&x();var j=v=v??n();D.add(function(){y--,y===0&&!k&&!b&&(p=Va(E,u))}),j.subscribe(D),!f&&y>0&&(f=new oi({next:function(O){return j.next(O)},error:function(O){k=!0,x(),p=Va(I,i,O),j.error(O)},complete:function(){b=!0,x(),p=Va(I,a),j.complete()}}),gn(S).subscribe(f))})(d)}}function Va(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(e===!0){t();return}if(e!==!1){var i=new oi({next:function(){i.unsubscribe(),t()}});return gn(e.apply(void 0,ii([],Pr(n)))).subscribe(i)}}function Pu(t){return fn(function(e,n){return t<=n})}function Od(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=wo(t);return an(function(r,i){(n?Au(t,r,n):Au(t,r)).subscribe(i)})}function Vt(t,e){return an(function(n,r){var i=null,o=0,a=!1,l=function(){return a&&!i&&r.complete()};n.subscribe(sn(r,function(u){i==null||i.unsubscribe();var d=0,f=o++;gn(t(u,f)).subscribe(i=sn(r,function(p){return r.next(e?e(u,p,f,d++):p)},function(){i=null,l()}))},function(){a=!0,l()}))})}function yl(t,e,n){var r=ft(t)||e||n?{next:t,error:e,complete:n}:t;return r?an(function(i,o){var a;(a=r.subscribe)===null||a===void 0||a.call(r);var l=!0;i.subscribe(sn(o,function(u){var d;(d=r.next)===null||d===void 0||d.call(r,u),o.next(u)},function(){var u;l=!1,(u=r.complete)===null||u===void 0||u.call(r),o.complete()},function(u){var d;l=!1,(d=r.error)===null||d===void 0||d.call(r,u),o.error(u)},function(){var u,d;l&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(d=r.finalize)===null||d===void 0||d.call(r)}))}):yi}const $t=()=>new Map,ml=t=>{const e=$t();return t.forEach((n,r)=>{e.set(r,n)}),e},Qn=(t,e,n)=>{let r=t.get(e);return r===void 0&&t.set(e,r=n()),r},Ky=(t,e)=>{const n=[];for(const[r,i]of t)n.push(e(i,r));return n},qy=(t,e)=>{for(const[n,r]of t)if(e(r,n))return!0;return!1};class Hy{constructor(){this._observers=$t()}on(e,n){return Qn(this._observers,e,Mr).add(n),n}once(e,n){const r=(...i)=>{this.off(e,r),n(...i)};this.on(e,r)}off(e,n){const r=this._observers.get(e);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(e))}emit(e,n){return pr((this._observers.get(e)||$t()).values()).forEach(r=>r(...n))}destroy(){this._observers=$t()}}class Vy{constructor(){this._observers=$t()}on(e,n){Qn(this._observers,e,Mr).add(n)}once(e,n){const r=(...i)=>{this.off(e,r),n(...i)};this.on(e,r)}off(e,n){const r=this._observers.get(e);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(e))}emit(e,n){return pr((this._observers.get(e)||$t()).values()).forEach(r=>r(...n))}destroy(){this._observers=$t()}}const zy=crypto.getRandomValues.bind(crypto),Md=()=>zy(new Uint32Array(1))[0],Wy="10000000-1000-4000-8000"+-1e11,Yy=()=>Wy.replace(/[018]/g,t=>(t^Md()&15>>t/4).toString(16)),ys=Date.now,ju=t=>new Promise(t);Promise.all.bind(Promise);const Lu=t=>t===void 0?null:t;class Gy{constructor(){this.map=new Map}setItem(e,n){this.map.set(e,n)}getItem(e){return this.map.get(e)}}let Pd=new Gy,Jy=!0;try{typeof localStorage<"u"&&localStorage&&(Pd=localStorage,Jy=!1)}catch{}const Qy=Pd,Xy=Object.assign,jd=Object.keys,Zy=(t,e)=>{for(const n in t)e(t[n],n)},Ru=t=>jd(t).length,Uu=t=>jd(t).length,$y=t=>{for(const e in t)return!1;return!0},em=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},Ld=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),tm=(t,e)=>t===e||Uu(t)===Uu(e)&&em(t,(n,r)=>(n!==void 0||Ld(e,r))&&e[r]===n),nm=Object.freeze,Rd=t=>{for(const e in t){const n=t[e];(typeof n=="object"||typeof n=="function")&&Rd(t[e])}return nm(t)},Nu=Symbol("Equality"),tc=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&tc(t,e,n+1)}},Ji=(t,e)=>{if(t===e)return!0;if(t==null||e==null||t.constructor!==e.constructor)return!1;if(t[Nu]!=null)return t[Nu](e);switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:{if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;break}case Set:{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;break}case Map:{if(t.size!==e.size)return!1;for(const n of t.keys())if(!e.has(n)||!Ji(t.get(n),e.get(n)))return!1;break}case Object:if(Ru(t)!==Ru(e))return!1;for(const n in t)if(!Ld(t,n)||!Ji(t[n],e[n]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Ji(t[n],e[n]))return!1;break;default:return!1}return!0},rm=(t,e)=>e.includes(t);var Ud={};const ao=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let In;const im=()=>{if(In===void 0)if(ao){In=$t();const t=process.argv;let e=null;for(let n=0;n<t.length;n++){const r=t[n];r[0]==="-"?(e!==null&&In.set(e,""),e=r):e!==null&&(In.set(e,r),e=null)}e!==null&&In.set(e,"")}else typeof location=="object"?(In=$t(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,n]=t.split("=");In.set(`--${pu(e,"-")}`,n),In.set(`-${pu(e,"-")}`,n)}})):In=$t();return In},bl=t=>im().has(t),ms=t=>Lu(ao?Ud[t.toUpperCase().replaceAll("-","_")]:Qy.getItem(t)),Nd=t=>bl("--"+t)||ms(t)!==null;Nd("production");const om=ao&&rm(Ud.FORCE_COLOR,["true","1","2"]),sm=om||!bl("--no-colors")&&!Nd("no-color")&&(!ao||process.stdout.isTTY)&&(!ao||bl("--color")||ms("COLORTERM")!==null||(ms("TERM")||"").includes("color"));class am{constructor(e,n){this.left=e,this.right=n}}const Kn=(t,e)=>new am(t,e);typeof DOMParser<"u"&&new DOMParser;const lm=t=>Ky(t,(e,n)=>`${n}:${e};`).join(""),Xn=Symbol,Fd=Xn(),Bd=Xn(),cm=Xn(),um=Xn(),fm=Xn(),Kd=Xn(),dm=Xn(),nc=Xn(),hm=Xn(),pm=t=>{var i;t.length===1&&((i=t[0])==null?void 0:i.constructor)===Function&&(t=t[0]());const e=[],n=[];let r=0;for(;r<t.length;r++){const o=t[r];if(o===void 0)break;if(o.constructor===String||o.constructor===Number)e.push(o);else if(o.constructor===Object)break}for(r>0&&n.push(e.join(""));r<t.length;r++){const o=t[r];o instanceof Symbol||n.push(o)}return n},vm={[Fd]:Kn("font-weight","bold"),[Bd]:Kn("font-weight","normal"),[cm]:Kn("color","blue"),[fm]:Kn("color","green"),[um]:Kn("color","grey"),[Kd]:Kn("color","red"),[dm]:Kn("color","purple"),[nc]:Kn("color","orange"),[hm]:Kn("color","black")},gm=t=>{var a;t.length===1&&((a=t[0])==null?void 0:a.constructor)===Function&&(t=t[0]());const e=[],n=[],r=$t();let i=[],o=0;for(;o<t.length;o++){const l=t[o],u=vm[l];if(u!==void 0)r.set(u.left,u.right);else{if(l===void 0)break;if(l.constructor===String||l.constructor===Number){const d=lm(r);o>0||d.length>0?(e.push("%c"+l),n.push(d)):e.push(l)}else break}}for(o>0&&(i=n,i.unshift(e.join("")));o<t.length;o++){const l=t[o];l instanceof Symbol||i.push(l)}return i},qd=sm?gm:pm,ym=(...t)=>{console.log(...qd(t)),Hd.forEach(e=>e.print(t))},mm=(...t)=>{console.warn(...qd(t)),t.unshift(nc),Hd.forEach(e=>e.print(t))},Hd=Mr(),Vd=t=>({[Symbol.iterator](){return this},next:t}),bm=(t,e)=>Vd(()=>{let n;do n=t.next();while(!n.done&&!e(n.value));return n}),za=(t,e)=>Vd(()=>{const{done:n,value:r}=t.next();return{done:n,value:n?void 0:e(r)}});class zd{constructor(e,n){this.clock=e,this.len=n}}class Hs{constructor(){this.clients=new Map}}const Wd=(t,e,n)=>e.clients.forEach((r,i)=>{const o=t.doc.store.clients.get(i);if(o!=null){const a=o[o.length-1],l=a.id.clock+a.length;for(let u=0,d=r[u];u<r.length&&d.clock<l;d=r[++u])th(t,o,d.clock,d.len,n)}}),wm=(t,e)=>{let n=0,r=t.length-1;for(;n<=r;){const i=Yn((n+r)/2),o=t[i],a=o.clock;if(a<=e){if(e<a+o.len)return i;n=i+1}else r=i-1}return null},Yd=(t,e)=>{const n=t.clients.get(e.client);return n!==void 0&&wm(n,e.clock)!==null},rc=t=>{t.clients.forEach(e=>{e.sort((i,o)=>i.clock-o.clock);let n,r;for(n=1,r=1;n<e.length;n++){const i=e[r-1],o=e[n];i.clock+i.len>=o.clock?i.len=di(i.len,o.clock+o.len-i.clock):(r<n&&(e[r]=o),r++)}e.length=r})},_m=t=>{const e=new Hs;for(let n=0;n<t.length;n++)t[n].clients.forEach((r,i)=>{if(!e.clients.has(i)){const o=r.slice();for(let a=n+1;a<t.length;a++)cg(o,t[a].clients.get(i)||[]);e.clients.set(i,o)}});return rc(e),e},bs=(t,e,n,r)=>{Qn(t.clients,e,()=>[]).push(new zd(n,r))},ic=(t,e)=>{Ge(t.restEncoder,e.clients.size),pr(e.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{t.resetDsCurVal(),Ge(t.restEncoder,n);const i=r.length;Ge(t.restEncoder,i);for(let o=0;o<i;o++){const a=r[o];t.writeDsClock(a.clock),t.writeDsLen(a.len)}})},km=t=>{const e=new Hs,n=dt(t.restDecoder);for(let r=0;r<n;r++){t.resetDsCurVal();const i=dt(t.restDecoder),o=dt(t.restDecoder);if(o>0){const a=Qn(e.clients,i,()=>[]);for(let l=0;l<o;l++)a.push(new zd(t.readDsClock(),t.readDsLen()))}}return e},Fu=(t,e,n)=>{const r=new Hs,i=dt(t.restDecoder);for(let o=0;o<i;o++){t.resetDsCurVal();const a=dt(t.restDecoder),l=dt(t.restDecoder),u=n.clients.get(a)||[],d=jt(n,a);for(let f=0;f<l;f++){const p=t.readDsClock(),v=p+t.readDsLen();if(p<d){d<v&&bs(r,a,d,v-d);let y=Pn(u,p),b=u[y];for(!b.deleted&&b.id.clock<p&&(u.splice(y+1,0,Cs(e,b,p-b.id.clock)),y++);y<u.length&&(b=u[y++],b.id.clock<v);)b.deleted||(v<b.id.clock+b.length&&u.splice(y,0,Cs(e,b,v-b.id.clock)),b.delete(e))}else bs(r,a,p,v-p)}}if(r.clients.size>0){const o=new Vs;return Ge(o.restEncoder,0),ic(o,r),o.toUint8Array()}return null},Gd=Md;class mi extends Hy{constructor({guid:e=Yy(),collectionid:n=null,gc:r=!0,gcFilter:i=()=>!0,meta:o=null,autoLoad:a=!1,shouldLoad:l=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=Gd(),this.guid=e,this.collectionid=n,this.share=new Map,this.store=new $d,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=l,this.autoLoad=a,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=ju(d=>{this.on("load",()=>{this.isLoaded=!0,d(this)})});const u=()=>ju(d=>{const f=p=>{(p===void 0||p===!0)&&(this.off("sync",f),d())};this.on("sync",f)});this.on("sync",d=>{d===!1&&this.isSynced&&(this.whenSynced=u()),this.isSynced=d===void 0||d===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=u()}load(){const e=this._item;e!==null&&!this.shouldLoad&&gt(e.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(pr(this.subdocs).map(e=>e.guid))}transact(e,n=null){return gt(this,e,n)}get(e,n=Bt){const r=Qn(this.share,e,()=>{const o=new n;return o._integrate(this,null),o}),i=r.constructor;if(n!==Bt&&i!==n)if(i===Bt){const o=new n;o._map=r._map,r._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=o}),o._start=r._start;for(let a=o._start;a!==null;a=a.right)a.parent=o;return o._length=r._length,this.share.set(e,o),o._integrate(this,null),o}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,$r)}getText(e=""){return this.get(e,ai)}getMap(e=""){return this.get(e,si)}getXmlElement(e=""){return this.get(e,li)}getXmlFragment(e=""){return this.get(e,Lr)}toJSON(){const e={};return this.share.forEach((n,r)=>{e[r]=n.toJSON()}),e}destroy(){this.isDestroyed=!0,pr(this.subdocs).forEach(n=>n.destroy());const e=this._item;if(e!==null){this._item=null;const n=e.content;n.doc=new mi({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=e,gt(e.parent.doc,r=>{const i=n.doc;e.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Sm{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=dt(this.restDecoder),this.dsCurrVal}readDsLen(){const e=dt(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class lo extends Sm{constructor(e){super(e),this.keys=[],dt(e),this.keyClockDecoder=new qa(Rt(e)),this.clientDecoder=new ss(Rt(e)),this.leftClockDecoder=new qa(Rt(e)),this.rightClockDecoder=new qa(Rt(e)),this.infoDecoder=new _u(Rt(e),ni),this.stringDecoder=new Rg(Rt(e)),this.parentInfoDecoder=new _u(Rt(e),ni),this.typeRefDecoder=new ss(Rt(e)),this.lenDecoder=new ss(Rt(e))}readLeftID(){return new Zr(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Zr(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return fr(this.restDecoder)}readBuf(){return Rt(this.restDecoder)}readJSON(){return fr(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class xm{constructor(){this.restEncoder=pi()}toUint8Array(){return nn(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Ge(this.restEncoder,e)}writeDsLen(e){Ge(this.restEncoder,e)}}class Em extends xm{writeLeftID(e){Ge(this.restEncoder,e.client),Ge(this.restEncoder,e.clock)}writeRightID(e){Ge(this.restEncoder,e.client),Ge(this.restEncoder,e.clock)}writeClient(e){Ge(this.restEncoder,e)}writeInfo(e){hl(this.restEncoder,e)}writeString(e){dn(this.restEncoder,e)}writeParentInfo(e){Ge(this.restEncoder,e?1:0)}writeTypeRef(e){Ge(this.restEncoder,e)}writeLen(e){Ge(this.restEncoder,e)}writeAny(e){ur(this.restEncoder,e)}writeBuf(e){Lt(this.restEncoder,e)}writeJSON(e){dn(this.restEncoder,JSON.stringify(e))}writeKey(e){dn(this.restEncoder,e)}}class Jd{constructor(){this.restEncoder=pi(),this.dsCurrVal=0}toUint8Array(){return nn(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const n=e-this.dsCurrVal;this.dsCurrVal=e,Ge(this.restEncoder,n)}writeDsLen(e){e===0&&Mn(),Ge(this.restEncoder,e-1),this.dsCurrVal+=e}}class Vs extends Jd{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Ka,this.clientEncoder=new os,this.leftClockEncoder=new Ka,this.rightClockEncoder=new Ka,this.infoEncoder=new yu(hl),this.stringEncoder=new Dg,this.parentInfoEncoder=new yu(hl),this.typeRefEncoder=new os,this.lenEncoder=new os}toUint8Array(){const e=pi();return Ge(e,0),Lt(e,this.keyClockEncoder.toUint8Array()),Lt(e,this.clientEncoder.toUint8Array()),Lt(e,this.leftClockEncoder.toUint8Array()),Lt(e,this.rightClockEncoder.toUint8Array()),Lt(e,nn(this.infoEncoder)),Lt(e,this.stringEncoder.toUint8Array()),Lt(e,nn(this.parentInfoEncoder)),Lt(e,this.typeRefEncoder.toUint8Array()),Lt(e,this.lenEncoder.toUint8Array()),mo(e,nn(this.restEncoder)),nn(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){ur(this.restEncoder,e)}writeBuf(e){Lt(this.restEncoder,e)}writeJSON(e){ur(this.restEncoder,e)}writeKey(e){const n=this.keyMap.get(e);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(n)}}const Cm=(t,e,n,r)=>{r=di(r,e[0].id.clock);const i=Pn(e,r);Ge(t.restEncoder,e.length-i),t.writeClient(n),Ge(t.restEncoder,r);const o=e[i];o.write(t,r-o.id.clock);for(let a=i+1;a<e.length;a++)e[a].write(t,0)},Qd=(t,e,n)=>{const r=new Map;n.forEach((i,o)=>{jt(e,o)>i&&r.set(o,i)}),oc(e).forEach((i,o)=>{n.has(o)||r.set(o,0)}),Ge(t.restEncoder,r.size),pr(r.entries()).sort((i,o)=>o[0]-i[0]).forEach(([i,o])=>{Cm(t,e.clients.get(i),i,o)})},Im=(t,e)=>{const n=$t(),r=dt(t.restDecoder);for(let i=0;i<r;i++){const o=dt(t.restDecoder),a=new Array(o),l=t.readClient();let u=dt(t.restDecoder);n.set(l,{i:0,refs:a});for(let d=0;d<o;d++){const f=t.readInfo();switch(Fs&f){case 0:{const p=t.readLen();a[d]=new pn(it(l,u),p),u+=p;break}case 10:{const p=dt(t.restDecoder);a[d]=new vn(it(l,u),p),u+=p;break}default:{const p=(f&(zn|rn))===0,v=new Tt(it(l,u),null,(f&rn)===rn?t.readLeftID():null,null,(f&zn)===zn?t.readRightID():null,p?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,p&&(f&io)===io?t.readString():null,kh(t,f));a[d]=v,u+=v.length}}}}return n},Dm=(t,e,n)=>{const r=[];let i=pr(n.keys()).sort((y,b)=>y-b);if(i.length===0)return null;const o=()=>{if(i.length===0)return null;let y=n.get(i[i.length-1]);for(;y.refs.length===y.i;)if(i.pop(),i.length>0)y=n.get(i[i.length-1]);else return null;return y};let a=o();if(a===null)return null;const l=new $d,u=new Map,d=(y,b)=>{const k=u.get(y);(k==null||k>b)&&u.set(y,b)};let f=a.refs[a.i++];const p=new Map,v=()=>{for(const y of r){const b=y.id.client,k=n.get(b);k?(k.i--,l.clients.set(b,k.refs.slice(k.i)),n.delete(b),k.i=0,k.refs=[]):l.clients.set(b,[y]),i=i.filter(x=>x!==b)}r.length=0};for(;;){if(f.constructor!==vn){const b=Qn(p,f.id.client,()=>jt(e,f.id.client))-f.id.clock;if(b<0)r.push(f),d(f.id.client,f.id.clock-1),v();else{const k=f.getMissing(t,e);if(k!==null){r.push(f);const x=n.get(k)||{refs:[],i:0};if(x.refs.length===x.i)d(k,jt(e,k)),v();else{f=x.refs[x.i++];continue}}else(b===0||b<f.length)&&(f.integrate(t,b),p.set(f.id.client,f.id.clock+f.length))}}if(r.length>0)f=r.pop();else if(a!==null&&a.i<a.refs.length)f=a.refs[a.i++];else{if(a=o(),a===null)break;f=a.refs[a.i++]}}if(l.clients.size>0){const y=new Vs;return Qd(y,l,new Map),Ge(y.restEncoder,0),{missing:u,update:y.toUint8Array()}}return null},Tm=(t,e)=>Qd(t,e.doc.store,e.beforeState),Am=(t,e,n,r=new lo(t))=>gt(e,i=>{i.local=!1;let o=!1;const a=i.doc,l=a.store,u=Im(r,a),d=Dm(i,l,u),f=l.pendingStructs;if(f){for(const[v,y]of f.missing)if(y<jt(l,v)){o=!0;break}if(d){for(const[v,y]of d.missing){const b=f.missing.get(v);(b==null||b>y)&&f.missing.set(v,y)}f.update=ws([f.update,d.update])}}else l.pendingStructs=d;const p=Fu(r,i,l);if(l.pendingDs){const v=new lo(bo(l.pendingDs));dt(v.restDecoder);const y=Fu(v,i,l);p&&y?l.pendingDs=ws([p,y]):l.pendingDs=p||y}else l.pendingDs=p;if(o){const v=l.pendingStructs.update;l.pendingStructs=null,Xd(i.doc,v)}},n,!1),Xd=(t,e,n,r=lo)=>{const i=bo(e);Am(i,t,n,new r(i))};class Om{constructor(){this.l=[]}}const Bu=()=>new Om,Ku=(t,e)=>t.l.push(e),qu=(t,e)=>{const n=t.l,r=n.length;t.l=n.filter(i=>e!==i),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Zd=(t,e,n)=>tc(t.l,[e,n]);class Zr{constructor(e,n){this.client=e,this.clock=n}}const Yo=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,it=(t,e)=>new Zr(t,e),Mm=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw Mn()},Jr=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!Yd(e.ds,t.id),wl=(t,e)=>{const n=Qn(t.meta,wl,Mr),r=t.doc.store;n.has(e)||(e.sv.forEach((i,o)=>{i<jt(r,o)&&gr(t,it(o,i))}),Wd(t,e.ds,i=>{}),n.add(e))};class $d{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const oc=t=>{const e=new Map;return t.clients.forEach((n,r)=>{const i=n[n.length-1];e.set(r,i.id.clock+i.length)}),e},jt=(t,e)=>{const n=t.clients.get(e);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},eh=(t,e)=>{let n=t.clients.get(e.id.client);if(n===void 0)n=[],t.clients.set(e.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==e.id.clock)throw Mn()}n.push(e)},Pn=(t,e)=>{let n=0,r=t.length-1,i=t[r],o=i.id.clock;if(o===e)return r;let a=Yn(e/(o+i.length-1)*r);for(;n<=r;){if(i=t[a],o=i.id.clock,o<=e){if(e<o+i.length)return a;n=a+1}else r=a-1;a=Yn((n+r)/2)}throw Mn()},Pm=(t,e)=>{const n=t.clients.get(e.client);return n[Pn(n,e.clock)]},Wa=Pm,_l=(t,e,n)=>{const r=Pn(e,n),i=e[r];return i.id.clock<n&&i instanceof Tt?(e.splice(r+1,0,Cs(t,i,n-i.id.clock)),r+1):r},gr=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[_l(t,n,e.clock)]},Hu=(t,e,n)=>{const r=e.clients.get(n.client),i=Pn(r,n.clock),o=r[i];return n.clock!==o.id.clock+o.length-1&&o.constructor!==pn&&r.splice(i+1,0,Cs(t,o,n.clock-o.id.clock+1)),o},jm=(t,e,n)=>{const r=t.clients.get(e.id.client);r[Pn(r,e.id.clock)]=n},th=(t,e,n,r,i)=>{if(r===0)return;const o=n+r;let a=_l(t,e,n),l;do l=e[a++],o<l.id.clock+l.length&&_l(t,e,o),i(l);while(a<e.length&&e[a].id.clock<o)};class Lm{constructor(e,n,r){this.doc=e,this.deleteSet=new Hs,this.beforeState=oc(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Vu=(t,e)=>e.deleteSet.clients.size===0&&!qy(e.afterState,(n,r)=>e.beforeState.get(r)!==n)?!1:(rc(e.deleteSet),Tm(t,e),ic(t,e.deleteSet),!0),zu=(t,e,n)=>{const r=e._item;(r===null||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&Qn(t.changed,e,Mr).add(n)},ls=(t,e)=>{let n=t[e],r=t[e-1],i=e;for(;i>0;n=r,r=t[--i-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof Tt&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const o=e-i;return o&&t.splice(e+1-o,o),o},Rm=(t,e,n)=>{for(const[r,i]of t.clients.entries()){const o=e.clients.get(r);for(let a=i.length-1;a>=0;a--){const l=i[a],u=l.clock+l.len;for(let d=Pn(o,l.clock),f=o[d];d<o.length&&f.id.clock<u;f=o[++d]){const p=o[d];if(l.clock+l.len<=p.id.clock)break;p instanceof Tt&&p.deleted&&!p.keep&&n(p)&&p.gc(e,!1)}}}},Um=(t,e)=>{t.clients.forEach((n,r)=>{const i=e.clients.get(r);for(let o=n.length-1;o>=0;o--){const a=n[o],l=nd(i.length-1,1+Pn(i,a.clock+a.len-1));for(let u=l,d=i[u];u>0&&d.id.clock>=a.clock;d=i[u])u-=1+ls(i,u)}})},nh=(t,e)=>{if(e<t.length){const n=t[e],r=n.doc,i=r.store,o=n.deleteSet,a=n._mergeStructs;try{rc(o),n.afterState=oc(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const l=[];n.changed.forEach((u,d)=>l.push(()=>{(d._item===null||!d._item.deleted)&&d._callObserver(n,u)})),l.push(()=>{n.changedParentTypes.forEach((u,d)=>{d._dEH.l.length>0&&(d._item===null||!d._item.deleted)&&(u=u.filter(f=>f.target._item===null||!f.target._item.deleted),u.forEach(f=>{f.currentTarget=d,f._path=null}),u.sort((f,p)=>f.path.length-p.path.length),Zd(d._dEH,u,n))})}),l.push(()=>r.emit("afterTransaction",[n,r])),tc(l,[]),n._needFormattingCleanup&&tb(n)}finally{r.gc&&Rm(o,i,r.gcFilter),Um(o,i),n.afterState.forEach((f,p)=>{const v=n.beforeState.get(p)||0;if(v!==f){const y=i.clients.get(p),b=di(Pn(y,v),1);for(let k=y.length-1;k>=b;)k-=1+ls(y,k)}});for(let f=a.length-1;f>=0;f--){const{client:p,clock:v}=a[f].id,y=i.clients.get(p),b=Pn(y,v);b+1<y.length&&ls(y,b+1)>1||b>0&&ls(y,b)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(ym(nc,Fd,"[yjs] ",Bd,Kd,"Changed the client-id because another client seems to be using it."),r.clientID=Gd()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const f=new Em;Vu(f,n)&&r.emit("update",[f.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const f=new Vs;Vu(f,n)&&r.emit("updateV2",[f.toUint8Array(),n.origin,r,n])}const{subdocsAdded:l,subdocsLoaded:u,subdocsRemoved:d}=n;(l.size>0||d.size>0||u.size>0)&&(l.forEach(f=>{f.clientID=r.clientID,f.collectionid==null&&(f.collectionid=r.collectionid),r.subdocs.add(f)}),d.forEach(f=>r.subdocs.delete(f)),r.emit("subdocs",[{loaded:u,added:l,removed:d},r,n]),d.forEach(f=>f.destroy())),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):nh(t,e+1)}}},gt=(t,e,n=null,r=!0)=>{const i=t._transactionCleanups;let o=!1,a=null;t._transaction===null&&(o=!0,t._transaction=new Lm(t,n,r),i.push(t._transaction),i.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{a=e(t._transaction)}finally{if(o){const l=t._transaction===i[0];t._transaction=null,l&&nh(i,0)}}return a};function*Nm(t){const e=dt(t.restDecoder);for(let n=0;n<e;n++){const r=dt(t.restDecoder),i=t.readClient();let o=dt(t.restDecoder);for(let a=0;a<r;a++){const l=t.readInfo();if(l===10){const u=dt(t.restDecoder);yield new vn(it(i,o),u),o+=u}else if((Fs&l)!==0){const u=(l&(zn|rn))===0,d=new Tt(it(i,o),null,(l&rn)===rn?t.readLeftID():null,null,(l&zn)===zn?t.readRightID():null,u?t.readParentInfo()?t.readString():t.readLeftID():null,u&&(l&io)===io?t.readString():null,kh(t,l));yield d,o+=d.length}else{const u=t.readLen();yield new pn(it(i,o),u),o+=u}}}}class rh{constructor(e,n){this.gen=Nm(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===vn);return this.curr}}class Fm{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const ih=(t,e=Jd,n=lo)=>{const r=new e,i=new rh(new n(bo(t)),!1);let o=i.curr;if(o!==null){let a=0,l=o.id.client,u=o.id.clock!==0,d=u?0:o.id.clock+o.length;for(;o!==null;o=i.next())l!==o.id.client&&(d!==0&&(a++,Ge(r.restEncoder,l),Ge(r.restEncoder,d)),l=o.id.client,d=0,u=o.id.clock!==0),o.constructor===vn&&(u=!0),u||(d=o.id.clock+o.length);d!==0&&(a++,Ge(r.restEncoder,l),Ge(r.restEncoder,d));const f=pi();return Ge(f,a),Sg(f,r.restEncoder),r.restEncoder=f,r.toUint8Array()}else return Ge(r.restEncoder,0),r.toUint8Array()},Bm=(t,e)=>{if(t.constructor===pn){const{client:n,clock:r}=t.id;return new pn(it(n,r+e),t.length-e)}else if(t.constructor===vn){const{client:n,clock:r}=t.id;return new vn(it(n,r+e),t.length-e)}else{const n=t,{client:r,clock:i}=n.id;return new Tt(it(r,i+e),null,it(r,i+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},ws=(t,e=lo,n=Vs)=>{if(t.length===1)return t[0];const r=t.map(f=>new e(bo(f)));let i=r.map(f=>new rh(f,!0)),o=null;const a=new n,l=new Fm(a);for(;i=i.filter(v=>v.curr!==null),i.sort((v,y)=>{if(v.curr.id.client===y.curr.id.client){const b=v.curr.id.clock-y.curr.id.clock;return b===0?v.curr.constructor===y.curr.constructor?0:v.curr.constructor===vn?1:-1:b}else return y.curr.id.client-v.curr.id.client}),i.length!==0;){const f=i[0],p=f.curr.id.client;if(o!==null){let v=f.curr,y=!1;for(;v!==null&&v.id.clock+v.length<=o.struct.id.clock+o.struct.length&&v.id.client>=o.struct.id.client;)v=f.next(),y=!0;if(v===null||v.id.client!==p||y&&v.id.clock>o.struct.id.clock+o.struct.length)continue;if(p!==o.struct.id.client)Fi(l,o.struct,o.offset),o={struct:v,offset:0},f.next();else if(o.struct.id.clock+o.struct.length<v.id.clock)if(o.struct.constructor===vn)o.struct.length=v.id.clock+v.length-o.struct.id.clock;else{Fi(l,o.struct,o.offset);const b=v.id.clock-o.struct.id.clock-o.struct.length;o={struct:new vn(it(p,o.struct.id.clock+o.struct.length),b),offset:0}}else{const b=o.struct.id.clock+o.struct.length-v.id.clock;b>0&&(o.struct.constructor===vn?o.struct.length-=b:v=Bm(v,b)),o.struct.mergeWith(v)||(Fi(l,o.struct,o.offset),o={struct:v,offset:0},f.next())}}else o={struct:f.curr,offset:0},f.next();for(let v=f.curr;v!==null&&v.id.client===p&&v.id.clock===o.struct.id.clock+o.struct.length&&v.constructor!==vn;v=f.next())Fi(l,o.struct,o.offset),o={struct:v,offset:0}}o!==null&&(Fi(l,o.struct,o.offset),o=null),Km(l);const u=r.map(f=>km(f)),d=_m(u);return ic(a,d),a.toUint8Array()},oh=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:nn(t.encoder.restEncoder)}),t.encoder.restEncoder=pi(),t.written=0)},Fi=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&oh(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),Ge(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},Km=t=>{oh(t);const e=t.encoder.restEncoder;Ge(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const r=t.clientStructs[n];Ge(e,r.written),mo(e,r.restEncoder)}},Wu="You must not compute changes after the event-handler fired.";class zs{constructor(e,n){this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=qm(this.currentTarget,this.target))}deletes(e){return Yd(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw vr(Wu);const e=new Map,n=this.target;this.transaction.changed.get(n).forEach(i=>{if(i!==null){const o=n._map.get(i);let a,l;if(this.adds(o)){let u=o.left;for(;u!==null&&this.adds(u);)u=u.left;if(this.deletes(o))if(u!==null&&this.deletes(u))a="delete",l=Ba(u.content.getContent());else return;else u!==null&&this.deletes(u)?(a="update",l=Ba(u.content.getContent())):(a="add",l=void 0)}else if(this.deletes(o))a="delete",l=Ba(o.content.getContent());else return;e.set(i,{action:a,oldValue:l})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw vr(Wu);const n=this.target,r=Mr(),i=Mr(),o=[];if(e={added:r,deleted:i,delta:o,keys:this.keys},this.transaction.changed.get(n).has(null)){let l=null;const u=()=>{l&&o.push(l)};for(let d=n._start;d!==null;d=d.right)d.deleted?this.deletes(d)&&!this.adds(d)&&((l===null||l.delete===void 0)&&(u(),l={delete:0}),l.delete+=d.length,i.add(d)):this.adds(d)?((l===null||l.insert===void 0)&&(u(),l={insert:[]}),l.insert=l.insert.concat(d.content.getContent()),r.add(d)):((l===null||l.retain===void 0)&&(u(),l={retain:0}),l.retain+=d.length);l!==null&&l.retain===void 0&&u()}this._changes=e}return e}}const qm=(t,e)=>{const n=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)n.unshift(e._item.parentSub);else{let r=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)!i.deleted&&i.countable&&(r+=i.length),i=i.right;n.unshift(r)}e=e._item.parent}return n},Wt=()=>{mm("Invalid access: Add Yjs type to a document before reading data.")},sh=80;let sc=0;class Hm{constructor(e,n){e.marker=!0,this.p=e,this.index=n,this.timestamp=sc++}}const Vm=t=>{t.timestamp=sc++},ah=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=sc++},zm=(t,e,n)=>{if(t.length>=sh){const r=t.reduce((i,o)=>i.timestamp<o.timestamp?i:o);return ah(r,e,n),r}else{const r=new Hm(e,n);return t.push(r),r}},Ws=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const n=t._searchMarker.length===0?null:t._searchMarker.reduce((o,a)=>is(e-o.index)<is(e-a.index)?o:a);let r=t._start,i=0;for(n!==null&&(r=n.p,i=n.index,Vm(n));r.right!==null&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>e;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return n!==null&&is(n.index-i)<r.parent.length/sh?(ah(n,r,i),n):zm(t._searchMarker,r,i)},co=(t,e,n)=>{for(let r=t.length-1;r>=0;r--){const i=t[r];if(n>0){let o=i.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)o=o.left,o&&!o.deleted&&o.countable&&(i.index-=o.length);if(o===null||o.marker===!0){t.splice(r,1);continue}i.p=o,o.marker=!0}(e<i.index||n>0&&e===i.index)&&(i.index=di(e,i.index+n))}},Ys=(t,e,n)=>{const r=t,i=e.changedParentTypes;for(;Qn(i,t,()=>[]).push(n),t._item!==null;)t=t._item.parent;Zd(r._eH,n,e)};class Bt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Bu(),this._dEH=Bu(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,n){this.doc=e,this._item=n}_copy(){throw On()}clone(){throw On()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,n){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){Ku(this._eH,e)}observeDeep(e){Ku(this._dEH,e)}unobserve(e){qu(this._eH,e)}unobserveDeep(e){qu(this._dEH,e)}toJSON(){}}const lh=(t,e,n)=>{t.doc??Wt(),e<0&&(e=t._length+e),n<0&&(n=t._length+n);let r=n-e;const i=[];let o=t._start;for(;o!==null&&r>0;){if(o.countable&&!o.deleted){const a=o.content.getContent();if(a.length<=e)e-=a.length;else{for(let l=e;l<a.length&&r>0;l++)i.push(a[l]),r--;e=0}}o=o.right}return i},ch=t=>{t.doc??Wt();const e=[];let n=t._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let i=0;i<r.length;i++)e.push(r[i])}n=n.right}return e},uo=(t,e)=>{let n=0,r=t._start;for(t.doc??Wt();r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let o=0;o<i.length;o++)e(i[o],n++,t)}r=r.right}},uh=(t,e)=>{const n=[];return uo(t,(r,i)=>{n.push(e(r,i,t))}),n},Wm=t=>{let e=t._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}const i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},fh=(t,e)=>{t.doc??Wt();const n=Ws(t,e);let r=t._start;for(n!==null&&(r=n.p,e-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},_s=(t,e,n,r)=>{let i=n;const o=t.doc,a=o.clientID,l=o.store,u=n===null?e._start:n.right;let d=[];const f=()=>{d.length>0&&(i=new Tt(it(a,jt(l,a)),i,i&&i.lastId,u,u&&u.id,e,null,new Rr(d)),i.integrate(t,0),d=[])};r.forEach(p=>{if(p===null)d.push(p);else switch(p.constructor){case Number:case Object:case Boolean:case Array:case String:d.push(p);break;default:switch(f(),p.constructor){case Uint8Array:case ArrayBuffer:i=new Tt(it(a,jt(l,a)),i,i&&i.lastId,u,u&&u.id,e,null,new ko(new Uint8Array(p))),i.integrate(t,0);break;case mi:i=new Tt(it(a,jt(l,a)),i,i&&i.lastId,u,u&&u.id,e,null,new So(p)),i.integrate(t,0);break;default:if(p instanceof Bt)i=new Tt(it(a,jt(l,a)),i,i&&i.lastId,u,u&&u.id,e,null,new Zn(p)),i.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),f()},dh=()=>vr("Length exceeded!"),hh=(t,e,n,r)=>{if(n>e._length)throw dh();if(n===0)return e._searchMarker&&co(e._searchMarker,n,r.length),_s(t,e,null,r);const i=n,o=Ws(e,n);let a=e._start;for(o!==null&&(a=o.p,n-=o.index,n===0&&(a=a.prev,n+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&gr(t,it(a.id.client,a.id.clock+n));break}n-=a.length}return e._searchMarker&&co(e._searchMarker,i,r.length),_s(t,e,a,r)},Ym=(t,e,n)=>{let i=(e._searchMarker||[]).reduce((o,a)=>a.index>o.index?a:o,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return _s(t,e,i,n)},ph=(t,e,n,r)=>{if(r===0)return;const i=n,o=r,a=Ws(e,n);let l=e._start;for(a!==null&&(l=a.p,n-=a.index);l!==null&&n>0;l=l.right)!l.deleted&&l.countable&&(n<l.length&&gr(t,it(l.id.client,l.id.clock+n)),n-=l.length);for(;r>0&&l!==null;)l.deleted||(r<l.length&&gr(t,it(l.id.client,l.id.clock+r)),l.delete(t),r-=l.length),l=l.right;if(r>0)throw dh();e._searchMarker&&co(e._searchMarker,i,-o+r)},ks=(t,e,n)=>{const r=e._map.get(n);r!==void 0&&r.delete(t)},ac=(t,e,n,r)=>{const i=e._map.get(n)||null,o=t.doc,a=o.clientID;let l;if(r==null)l=new Rr([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:l=new Rr([r]);break;case Uint8Array:l=new ko(r);break;case mi:l=new So(r);break;default:if(r instanceof Bt)l=new Zn(r);else throw new Error("Unexpected content type")}new Tt(it(a,jt(o.store,a)),i,i&&i.lastId,null,null,e,n,l).integrate(t,0)},lc=(t,e)=>{t.doc??Wt();const n=t._map.get(e);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},vh=t=>{const e={};return t.doc??Wt(),t._map.forEach((n,r)=>{n.deleted||(e[r]=n.content.getContent()[n.length-1])}),e},gh=(t,e)=>{t.doc??Wt();const n=t._map.get(e);return n!==void 0&&!n.deleted},Gm=(t,e)=>{const n={};return t._map.forEach((r,i)=>{let o=r;for(;o!==null&&(!e.sv.has(o.id.client)||o.id.clock>=(e.sv.get(o.id.client)||0));)o=o.left;o!==null&&Jr(o,e)&&(n[i]=o.content.getContent()[o.length-1])}),n},Go=t=>(t.doc??Wt(),bm(t._map.entries(),e=>!e[1].deleted));class Jm extends zs{}class $r extends Bt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const n=new $r;return n.push(e),n}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new $r}clone(){const e=new $r;return e.insert(0,this.toArray().map(n=>n instanceof Bt?n.clone():n)),e}get length(){return this.doc??Wt(),this._length}_callObserver(e,n){super._callObserver(e,n),Ys(this,e,new Jm(this,e))}insert(e,n){this.doc!==null?gt(this.doc,r=>{hh(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}push(e){this.doc!==null?gt(this.doc,n=>{Ym(n,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,n=1){this.doc!==null?gt(this.doc,r=>{ph(r,this,e,n)}):this._prelimContent.splice(e,n)}get(e){return fh(this,e)}toArray(){return ch(this)}slice(e=0,n=this.length){return lh(this,e,n)}toJSON(){return this.map(e=>e instanceof Bt?e.toJSON():e)}map(e){return uh(this,e)}forEach(e){uo(this,e)}[Symbol.iterator](){return Wm(this)}_write(e){e.writeTypeRef(wb)}}const Qm=t=>new $r;class Xm extends zs{constructor(e,n,r){super(e,n),this.keysChanged=r}}class si extends Bt{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,n){super._integrate(e,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new si}clone(){const e=new si;return this.forEach((n,r)=>{e.set(r,n instanceof Bt?n.clone():n)}),e}_callObserver(e,n){Ys(this,e,new Xm(this,e,n))}toJSON(){this.doc??Wt();const e={};return this._map.forEach((n,r)=>{if(!n.deleted){const i=n.content.getContent()[n.length-1];e[r]=i instanceof Bt?i.toJSON():i}}),e}get size(){return[...Go(this)].length}keys(){return za(Go(this),e=>e[0])}values(){return za(Go(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return za(Go(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Wt(),this._map.forEach((n,r)=>{n.deleted||e(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?gt(this.doc,n=>{ks(n,this,e)}):this._prelimContent.delete(e)}set(e,n){return this.doc!==null?gt(this.doc,r=>{ac(r,this,e,n)}):this._prelimContent.set(e,n),n}get(e){return lc(this,e)}has(e){return gh(this,e)}clear(){this.doc!==null?gt(this.doc,e=>{this.forEach(function(n,r,i){ks(e,i,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(_b)}}const Zm=t=>new si,ar=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&tm(t,e);class kl{constructor(e,n,r,i){this.left=e,this.right=n,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&Mn(),this.right.content.constructor){case Ot:this.right.deleted||bi(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Yu=(t,e,n)=>{for(;e.right!==null&&n>0;){switch(e.right.content.constructor){case Ot:e.right.deleted||bi(e.currentAttributes,e.right.content);break;default:e.right.deleted||(n<e.right.length&&gr(t,it(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},Jo=(t,e,n,r)=>{const i=new Map,o=r?Ws(e,n):null;if(o){const a=new kl(o.p.left,o.p,o.index,i);return Yu(t,a,n-o.index)}else{const a=new kl(null,e._start,0,i);return Yu(t,a,n)}},yh=(t,e,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===Ot&&ar(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const i=t.doc,o=i.clientID;r.forEach((a,l)=>{const u=n.left,d=n.right,f=new Tt(it(o,jt(i.store,o)),u,u&&u.lastId,d,d&&d.id,e,null,new Ot(l,a));f.integrate(t,0),n.right=f,n.forward()})},bi=(t,e)=>{const{key:n,value:r}=e;r===null?t.delete(n):t.set(n,r)},mh=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===Ot&&ar(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},bh=(t,e,n,r)=>{const i=t.doc,o=i.clientID,a=new Map;for(const l in r){const u=r[l],d=n.currentAttributes.get(l)??null;if(!ar(d,u)){a.set(l,d);const{left:f,right:p}=n;n.right=new Tt(it(o,jt(i.store,o)),f,f&&f.lastId,p,p&&p.id,e,null,new Ot(l,u)),n.right.integrate(t,0),n.forward()}}return a},Ya=(t,e,n,r,i)=>{n.currentAttributes.forEach((v,y)=>{i[y]===void 0&&(i[y]=null)});const o=t.doc,a=o.clientID;mh(n,i);const l=bh(t,e,n,i),u=r.constructor===String?new jn(r):r instanceof Bt?new Zn(r):new Ur(r);let{left:d,right:f,index:p}=n;e._searchMarker&&co(e._searchMarker,n.index,u.getLength()),f=new Tt(it(a,jt(o.store,a)),d,d&&d.lastId,f,f&&f.id,e,null,u),f.integrate(t,0),n.right=f,n.index=p,n.forward(),yh(t,e,n,l)},Gu=(t,e,n,r,i)=>{const o=t.doc,a=o.clientID;mh(n,i);const l=bh(t,e,n,i);e:for(;n.right!==null&&(r>0||l.size>0&&(n.right.deleted||n.right.content.constructor===Ot));){if(!n.right.deleted)switch(n.right.content.constructor){case Ot:{const{key:u,value:d}=n.right.content,f=i[u];if(f!==void 0){if(ar(f,d))l.delete(u);else{if(r===0)break e;l.set(u,d)}n.right.delete(t)}else n.currentAttributes.set(u,d);break}default:r<n.right.length&&gr(t,it(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let u="";for(;r>0;r--)u+=`
`;n.right=new Tt(it(a,jt(o.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new jn(u)),n.right.integrate(t,0),n.forward()}yh(t,e,n,l)},wh=(t,e,n,r,i)=>{let o=e;const a=$t();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===Ot){const d=o.content;a.set(d.key,d)}o=o.right}let l=0,u=!1;for(;e!==o;){if(n===e&&(u=!0),!e.deleted){const d=e.content;switch(d.constructor){case Ot:{const{key:f,value:p}=d,v=r.get(f)??null;(a.get(f)!==d||v===p)&&(e.delete(t),l++,!u&&(i.get(f)??null)===p&&v!==p&&(v===null?i.delete(f):i.set(f,v))),!u&&!e.deleted&&bi(i,d);break}}}e=e.right}return l},$m=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Ot){const r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}},eb=t=>{let e=0;return gt(t.doc,n=>{let r=t._start,i=t._start,o=$t();const a=ml(o);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case Ot:bi(a,i.content);break;default:e+=wh(n,r,i,o,a),o=ml(a),r=i;break}i=i.right}}),e},tb=t=>{const e=new Set,n=t.doc;for(const[r,i]of t.afterState.entries()){const o=t.beforeState.get(r)||0;i!==o&&th(t,n.store.clients.get(r),o,i,a=>{!a.deleted&&a.content.constructor===Ot&&a.constructor!==pn&&e.add(a.parent)})}gt(n,r=>{Wd(t,t.deleteSet,i=>{if(i instanceof pn||!i.parent._hasFormatting||e.has(i.parent))return;const o=i.parent;i.content.constructor===Ot?e.add(o):$m(r,i)});for(const i of e)eb(i)})},Ju=(t,e,n)=>{const r=n,i=ml(e.currentAttributes),o=e.right;for(;n>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Zn:case Ur:case jn:n<e.right.length&&gr(t,it(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t);break}e.forward()}o&&wh(t,o,e.right,i,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&co(a._searchMarker,e.index,-r+n),e};class nb extends zs{constructor(e,n,r){super(e,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,n=[];gt(e,r=>{const i=new Map,o=new Map;let a=this.target._start,l=null;const u={};let d="",f=0,p=0;const v=()=>{if(l!==null){let y=null;switch(l){case"delete":p>0&&(y={delete:p}),p=0;break;case"insert":(typeof d=="object"||d.length>0)&&(y={insert:d},i.size>0&&(y.attributes={},i.forEach((b,k)=>{b!==null&&(y.attributes[k]=b)}))),d="";break;case"retain":f>0&&(y={retain:f},$y(u)||(y.attributes=Xy({},u))),f=0;break}y&&n.push(y),l=null}};for(;a!==null;){switch(a.content.constructor){case Zn:case Ur:this.adds(a)?this.deletes(a)||(v(),l="insert",d=a.content.getContent()[0],v()):this.deletes(a)?(l!=="delete"&&(v(),l="delete"),p+=1):a.deleted||(l!=="retain"&&(v(),l="retain"),f+=1);break;case jn:this.adds(a)?this.deletes(a)||(l!=="insert"&&(v(),l="insert"),d+=a.content.str):this.deletes(a)?(l!=="delete"&&(v(),l="delete"),p+=a.length):a.deleted||(l!=="retain"&&(v(),l="retain"),f+=a.length);break;case Ot:{const{key:y,value:b}=a.content;if(this.adds(a)){if(!this.deletes(a)){const k=i.get(y)??null;ar(k,b)?b!==null&&a.delete(r):(l==="retain"&&v(),ar(b,o.get(y)??null)?delete u[y]:u[y]=b)}}else if(this.deletes(a)){o.set(y,b);const k=i.get(y)??null;ar(k,b)||(l==="retain"&&v(),u[y]=k)}else if(!a.deleted){o.set(y,b);const k=u[y];k!==void 0&&(ar(k,b)?k!==null&&a.delete(r):(l==="retain"&&v(),b===null?delete u[y]:u[y]=b))}a.deleted||(l==="insert"&&v(),bi(i,a.content));break}}a=a.right}for(v();n.length>0;){const y=n[n.length-1];if(y.retain!==void 0&&y.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class ai extends Bt{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Wt(),this._length}_integrate(e,n){super._integrate(e,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new ai}clone(){const e=new ai;return e.applyDelta(this.toDelta()),e}_callObserver(e,n){super._callObserver(e,n);const r=new nb(this,e,n);Ys(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Wt();let e="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===jn&&(e+=n.content.str),n=n.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:n=!0}={}){this.doc!==null?gt(this.doc,r=>{const i=new kl(null,this._start,0,new Map);for(let o=0;o<e.length;o++){const a=e[o];if(a.insert!==void 0){const l=!n&&typeof a.insert=="string"&&o===e.length-1&&i.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof l!="string"||l.length>0)&&Ya(r,this,i,l,a.attributes||{})}else a.retain!==void 0?Gu(r,this,i,a.retain,a.attributes||{}):a.delete!==void 0&&Ju(r,i,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,n,r){this.doc??Wt();const i=[],o=new Map,a=this.doc;let l="",u=this._start;function d(){if(l.length>0){const p={};let v=!1;o.forEach((b,k)=>{v=!0,p[k]=b});const y={insert:l};v&&(y.attributes=p),i.push(y),l=""}}const f=()=>{for(;u!==null;){if(Jr(u,e)||n!==void 0&&Jr(u,n))switch(u.content.constructor){case jn:{const p=o.get("ychange");e!==void 0&&!Jr(u,e)?(p===void 0||p.user!==u.id.client||p.type!=="removed")&&(d(),o.set("ychange",r?r("removed",u.id):{type:"removed"})):n!==void 0&&!Jr(u,n)?(p===void 0||p.user!==u.id.client||p.type!=="added")&&(d(),o.set("ychange",r?r("added",u.id):{type:"added"})):p!==void 0&&(d(),o.delete("ychange")),l+=u.content.str;break}case Zn:case Ur:{d();const p={insert:u.content.getContent()[0]};if(o.size>0){const v={};p.attributes=v,o.forEach((y,b)=>{v[b]=y})}i.push(p);break}case Ot:Jr(u,e)&&(d(),bi(o,u.content));break}u=u.right}d()};return e||n?gt(a,p=>{e&&wl(p,e),n&&wl(p,n),f()},"cleanup"):f(),i}insert(e,n,r){if(n.length<=0)return;const i=this.doc;i!==null?gt(i,o=>{const a=Jo(o,this,e,!r);r||(r={},a.currentAttributes.forEach((l,u)=>{r[u]=l})),Ya(o,this,a,n,r)}):this._pending.push(()=>this.insert(e,n,r))}insertEmbed(e,n,r){const i=this.doc;i!==null?gt(i,o=>{const a=Jo(o,this,e,!r);Ya(o,this,a,n,r||{})}):this._pending.push(()=>this.insertEmbed(e,n,r||{}))}delete(e,n){if(n===0)return;const r=this.doc;r!==null?gt(r,i=>{Ju(i,Jo(i,this,e,!0),n)}):this._pending.push(()=>this.delete(e,n))}format(e,n,r){if(n===0)return;const i=this.doc;i!==null?gt(i,o=>{const a=Jo(o,this,e,!1);a.right!==null&&Gu(o,this,a,n,r)}):this._pending.push(()=>this.format(e,n,r))}removeAttribute(e){this.doc!==null?gt(this.doc,n=>{ks(n,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,n){this.doc!==null?gt(this.doc,r=>{ac(r,this,e,n)}):this._pending.push(()=>this.setAttribute(e,n))}getAttribute(e){return lc(this,e)}getAttributes(){return vh(this)}_write(e){e.writeTypeRef(kb)}}const rb=t=>new ai;class Ga{constructor(e,n=()=>!0){this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Wt()}[Symbol.iterator](){return this}next(){let e=this._currentNode,n=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(n)))do if(n=e.content.type,!e.deleted&&(n.constructor===li||n.constructor===Lr)&&n._start!==null)e=n._start;else for(;e!==null;){const r=e.next;if(r!==null){e=r;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Lr extends Bt{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Lr}clone(){const e=new Lr;return e.insert(0,this.toArray().map(n=>n instanceof Bt?n.clone():n)),e}get length(){return this.doc??Wt(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Ga(this,e)}querySelector(e){e=e.toUpperCase();const r=new Ga(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),pr(new Ga(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e))}_callObserver(e,n){Ys(this,e,new sb(this,n,e))}toString(){return uh(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,n={},r){const i=e.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),uo(this,o=>{i.insertBefore(o.toDOM(e,n,r),null)}),i}insert(e,n){this.doc!==null?gt(this.doc,r=>{hh(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}insertAfter(e,n){if(this.doc!==null)gt(this.doc,r=>{const i=e&&e instanceof Bt?e._item:e;_s(r,this,i,n)});else{const r=this._prelimContent,i=e===null?0:r.findIndex(o=>o===e)+1;if(i===0&&e!==null)throw vr("Reference item not found");r.splice(i,0,...n)}}delete(e,n=1){this.doc!==null?gt(this.doc,r=>{ph(r,this,e,n)}):this._prelimContent.splice(e,n)}toArray(){return ch(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return fh(this,e)}slice(e=0,n=this.length){return lh(this,e,n)}forEach(e){uo(this,e)}_write(e){e.writeTypeRef(xb)}}const ib=t=>new Lr;class li extends Lr{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,n){super._integrate(e,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new li(this.nodeName)}clone(){const e=new li(this.nodeName),n=this.getAttributes();return Zy(n,(r,i)=>{typeof r=="string"&&e.setAttribute(i,r)}),e.insert(0,this.toArray().map(r=>r instanceof Bt?r.clone():r)),e}toString(){const e=this.getAttributes(),n=[],r=[];for(const l in e)r.push(l);r.sort();const i=r.length;for(let l=0;l<i;l++){const u=r[l];n.push(u+'="'+e[u]+'"')}const o=this.nodeName.toLocaleLowerCase(),a=n.length>0?" "+n.join(" "):"";return`<${o}${a}>${super.toString()}</${o}>`}removeAttribute(e){this.doc!==null?gt(this.doc,n=>{ks(n,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,n){this.doc!==null?gt(this.doc,r=>{ac(r,this,e,n)}):this._prelimAttrs.set(e,n)}getAttribute(e){return lc(this,e)}hasAttribute(e){return gh(this,e)}getAttributes(e){return e?Gm(this,e):vh(this)}toDOM(e=document,n={},r){const i=e.createElement(this.nodeName),o=this.getAttributes();for(const a in o){const l=o[a];typeof l=="string"&&i.setAttribute(a,l)}return uo(this,a=>{i.appendChild(a.toDOM(e,n,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(Sb),e.writeKey(this.nodeName)}}const ob=t=>new li(t.readKey());class sb extends zs{constructor(e,n,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class Ss extends si{constructor(e){super(),this.hookName=e}_copy(){return new Ss(this.hookName)}clone(){const e=new Ss(this.hookName);return this.forEach((n,r)=>{e.set(r,n)}),e}toDOM(e=document,n={},r){const i=n[this.hookName];let o;return i!==void 0?o=i.createDom(this):o=document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(o,this),o}_write(e){e.writeTypeRef(Eb),e.writeKey(this.hookName)}}const ab=t=>new Ss(t.readKey());class xs extends ai{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new xs}clone(){const e=new xs;return e.applyDelta(this.toDelta()),e}toDOM(e=document,n,r){const i=e.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{const n=[];for(const i in e.attributes){const o=[];for(const a in e.attributes[i])o.push({key:a,value:e.attributes[i][a]});o.sort((a,l)=>a.key<l.key?-1:1),n.push({nodeName:i,attrs:o})}n.sort((i,o)=>i.nodeName<o.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){const o=n[i];r+=`<${o.nodeName}`;for(let a=0;a<o.attrs.length;a++){const l=o.attrs[a];r+=` ${l.key}="${l.value}"`}r+=">"}r+=e.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(Cb)}}const lb=t=>new xs;class cc{constructor(e,n){this.id=e,this.length=n}get deleted(){throw On()}mergeWith(e){return!1}write(e,n,r){throw On()}integrate(e,n){throw On()}}const cb=0;class pn extends cc{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){n>0&&(this.id.clock+=n,this.length-=n),eh(e.doc.store,this)}write(e,n){e.writeInfo(cb),e.writeLen(this.length-n)}getMissing(e,n){return null}}class ko{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new ko(this.content)}splice(e){throw On()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeBuf(this.content)}getRef(){return 3}}const ub=t=>new ko(t.readBuf());class fo{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new fo(this.len)}splice(e){const n=new fo(this.len-e);return this.len=e,n}mergeWith(e){return this.len+=e.len,!0}integrate(e,n){bs(e.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(e){}gc(e){}write(e,n){e.writeLen(this.len-n)}getRef(){return 1}}const fb=t=>new fo(t.readLen()),_h=(t,e)=>new mi({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class So{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),e.meta!==null&&(n.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new So(_h(this.doc.guid,this.opts))}splice(e){throw On()}mergeWith(e){return!1}integrate(e,n){this.doc._item=n,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,n){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const db=t=>new So(_h(t.readString(),t.readAny()));class Ur{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Ur(this.embed)}splice(e){throw On()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeJSON(this.embed)}getRef(){return 5}}const hb=t=>new Ur(t.readJSON());class Ot{constructor(e,n){this.key=e,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Ot(this.key,this.value)}splice(e){throw On()}mergeWith(e){return!1}integrate(e,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,n){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const pb=t=>new Ot(t.readKey(),t.readJSON());class Es{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Es(this.arr)}splice(e){const n=new Es(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let i=n;i<r;i++){const o=this.arr[i];e.writeString(o===void 0?"undefined":JSON.stringify(o))}}getRef(){return 2}}const vb=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++){const i=t.readString();i==="undefined"?n.push(void 0):n.push(JSON.parse(i))}return new Es(n)},gb=ms("node_env")==="development";class Rr{constructor(e){this.arr=e,gb&&Rd(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Rr(this.arr)}splice(e){const n=new Rr(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let i=n;i<r;i++){const o=this.arr[i];e.writeAny(o)}}getRef(){return 8}}const yb=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++)n.push(t.readAny());return new Rr(n)};class jn{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new jn(this.str)}splice(e){const n=new jn(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"�",n.str="�"+n.str.slice(1)),n}mergeWith(e){return this.str+=e.str,!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const mb=t=>new jn(t.readString()),bb=[Qm,Zm,rb,ob,ib,ab,lb],wb=0,_b=1,kb=2,Sb=3,xb=4,Eb=5,Cb=6;class Zn{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Zn(this.type._copy())}splice(e){throw On()}mergeWith(e){return!1}integrate(e,n){this.type._integrate(e.doc,n)}delete(e){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let n=this.type._start;for(;n!==null;)n.gc(e,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,n){this.type._write(e)}getRef(){return 7}}const Ib=t=>new Zn(bb[t.readTypeRef()](t)),Cs=(t,e,n)=>{const{client:r,clock:i}=e.id,o=new Tt(it(r,i+n),e,it(r,i+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&o.markDeleted(),e.keep&&(o.keep=!0),e.redone!==null&&(o.redone=it(e.redone.client,e.redone.clock+n)),e.right=o,o.right!==null&&(o.right.left=o),t._mergeStructs.push(o),o.parentSub!==null&&o.right===null&&o.parent._map.set(o.parentSub,o),e.length=n,o};class Tt extends cc{constructor(e,n,r,i,o,a,l,u){super(e,u.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=o,this.parent=a,this.parentSub=l,this.redone=null,this.content=u,this.info=this.content.isCountable()?hu:0}set marker(e){(this.info&Fa)>0!==e&&(this.info^=Fa)}get marker(){return(this.info&Fa)>0}get keep(){return(this.info&du)>0}set keep(e){this.keep!==e&&(this.info^=du)}get countable(){return(this.info&hu)>0}get deleted(){return(this.info&Na)>0}set deleted(e){this.deleted!==e&&(this.info^=Na)}markDeleted(){this.info|=Na}getMissing(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=jt(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=jt(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Zr&&this.id.client!==this.parent.client&&this.parent.clock>=jt(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Hu(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=gr(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===pn||this.right&&this.right.constructor===pn)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Tt?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Tt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Zr){const r=Wa(n,this.parent);r.constructor===pn?this.parent=null:this.parent=r.content.type}return null}integrate(e,n){if(n>0&&(this.id.clock+=n,this.left=Hu(e,e.doc.store,it(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const o=new Set,a=new Set;for(;i!==null&&i!==this.right;){if(a.add(i),o.add(i),Yo(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,o.clear();else if(Yo(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&a.has(Wa(e.doc.store,i.origin)))o.has(Wa(e.doc.store,i.origin))||(r=i,o.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),eh(e.doc.store,this),this.content.integrate(e,this),zu(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new pn(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:it(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&Yo(e.origin,this.lastId)&&this.right===e&&Yo(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),bs(e.deleteSet,this.id.client,this.id.clock,this.length),zu(e,n,this.parentSub),this.content.delete(e)}}gc(e,n){if(!this.deleted)throw Mn();this.content.gc(e),n?jm(e,this,new pn(this.id,this.length)):this.content=new fo(this.length)}write(e,n){const r=n>0?it(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,o=this.parentSub,a=this.content.getRef()&Fs|(r===null?0:rn)|(i===null?0:zn)|(o===null?0:io);if(e.writeInfo(a),r!==null&&e.writeLeftID(r),i!==null&&e.writeRightID(i),r===null&&i===null){const l=this.parent;if(l._item!==void 0){const u=l._item;if(u===null){const d=Mm(l);e.writeParentInfo(!0),e.writeString(d)}else e.writeParentInfo(!1),e.writeLeftID(u.id)}else l.constructor===String?(e.writeParentInfo(!0),e.writeString(l)):l.constructor===Zr?(e.writeParentInfo(!1),e.writeLeftID(l)):Mn();o!==null&&e.writeString(o)}this.content.write(e,n)}}const kh=(t,e)=>Db[e&Fs](t),Db=[()=>{Mn()},fb,vb,ub,mb,hb,pb,Ib,yb,db,()=>{Mn()}],Tb=10;class vn extends cc{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){Mn()}write(e,n){e.writeInfo(Tb),Ge(e.restEncoder,this.length-n)}getMissing(e,n){return null}}const Sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},xh="__ $YJS$ __";Sh[xh]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Sh[xh]=!0;const Ja=new FinalizationRegistry(({cache:t,key:e})=>{delete t[e]});function Eh(t){var e,n;return(e=(n=t._novip)._docCache)!==null&&e!==void 0?e:n._docCache={cache:{},get size(){return Object.keys(this.cache).length},find(r,i,o){const a=Qa(r,i,o),l=this.cache[a];return l?l.deref():void 0},add(r){var i;const{parentTable:o,parentId:a,parentProp:l}=r.meta;if(!o||!l||a==null)throw new Error("Missing Dexie-related metadata in Y.Doc");const u=Qa(o,a,l),d=(i=this.cache[u])===null||i===void 0?void 0:i.deref();d&&Ja.unregister(d),this.cache[u]=new WeakRef(r),Ja.register(r,{cache:this.cache,key:u},r)},delete(r){Ja.unregister(r);const i=Qa(r.meta.parentTable,r.meta.parentId,r.meta.parentProp),o=this.cache[i];(o==null?void 0:o.deref())===r&&delete this.cache[i]}}}const Qi=new WeakSet;function Sl(t){if(Qi.has(t))throw new Error(`Y.Doc ${t.meta.parentId} has been destroyed`)}function Qa(t,e,n){return`${t}[${e}].${n}`}function Ab(t,e,n,r,i,o){let a=e.find(n,o,r);return a||(a=new mi({meta:{db:t,updatesTable:i,parentProp:r,parentTable:n,parentId:o}}),e.add(a),a.on("destroy",()=>{Qi.add(a),e.delete(a)}),a)}const{getByKeyPath:aS}=rt;let Ch=null;function Qu(t){Ch=t}function Ob(t,e,n,r,i,o){let a=0,l=!0;const u=cr(()=>{Sl(e);const p=n.table(i);return Promise.all([(a>0?p.where("i").between(a,1/0,!1).toArray().then(v=>v.filter(y=>Ns(y.k,o)===0)):p.where({k:o}).toArray()).then(v=>v),n.table(r).where(":id").equals(o).toArray()])}).subscribe(([p,v])=>{if(p.length>0&&(a=p[p.length-1].i),v.length===0){e.destroy();return}Sl(e),p.length>0&&gt(e,()=>{p.forEach(y=>{try{Qu(y),Xd(e,y.u)}finally{Qu(null)}})},t,!1),l&&(l=!1,e.emit("load",[e]))},p=>{t.on("error").fire(p)}),d=(p,v)=>{v!==t&&n.table(i).add({k:o,u:p,f:1}).then(y=>{y===a-1&&++a}).catch(y=>{t.on("error").fire(y)})},f=()=>{u.unsubscribe(),e.off("updateV2",d),e.off("destroy",f)};return e.on("updateV2",d),e.on("destroy",f),f}function Ih(){}function Mb(t,e){return t===Ih?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return e.apply(r,o)})}return e.apply(this,arguments)}}function Pb(t,e){return t===Ih?e:function(){t.apply(this,arguments),e.apply(this,arguments)}}const Bi=new WeakMap;function Xu(){return rt.Events(null,"load","sync","error")}class zt{static getOrCreateDocument(e,n,r,i){var o,a;const l=Eh(e),u=(a=(o=e.table(n).schema.yProps)===null||o===void 0?void 0:o.find(d=>d.prop===r))===null||a===void 0?void 0:a.updatesTable;if(!u)throw new Error(`Updates table for ${n}.${r} not found`);return Ab(e,l,n,r,u,i)}static load(e,n){var r;let i=Bi.get(e);return i?(++i.refCount,(n==null?void 0:n.gracePeriod)!=null&&i.graceTimeout<n.gracePeriod&&(i.graceTimeout=n.gracePeriod),i.graceTimer&&(clearTimeout(i.graceTimer),i.graceTimer=null)):(i=new zt(e),i.graceTimeout=(r=n==null?void 0:n.gracePeriod)!==null&&r!==void 0?r:-1,Bi.set(e,i)),i}static release(e){if(!e||Qi.has(e))return;const n=Bi.get(e);n?--n.refCount<=0&&(n.graceTimeout<0?n._release():n.graceTimer||(n.graceTimer=setTimeout(()=>{n.graceTimer=null,n.refCount===0&&n._release()},n.graceTimeout))):e.destroy()}_release(){this.doc&&Promise.resolve(zt.on("beforeunload").fire(this)).finally(()=>{var e;this.refCount===0&&((e=this.doc)===null||e===void 0||e.destroy())})}static for(e){return Bi.get(e)}static get currentUpdateRow(){return Ch}get whenLoaded(){return this._whenLoaded||(this._whenLoaded=new Promise((e,n)=>{if(!this.doc){n(new Error("No Y.Doc associated with this provider"));return}this.doc.isLoaded?e():this._error?n(this._error):Qi.has(this.doc)?n(new rt.AbortError("Document was destroyed before loaded")):(this.on("load",e),this.on("error",n),this.doc.on("destroy",()=>n(new rt.AbortError("Document was destroyed before loaded"))))})),this._whenLoaded}get whenSynced(){return this._whenSynced||(this._whenSynced=new Promise((e,n)=>{if(!this.doc){n(new Error("No Y.Doc associated with this provider"));return}this.doc.isSynced?e():this._error?n(this._error):Qi.has(this.doc)?n(new rt.AbortError("Document was destroyed before synced")):(this.on("sync",e),this.on("error",n),this.doc.on("destroy",()=>n(new rt.AbortError("Document was destroyed before synced"))))})),this._whenSynced}constructor(e){this.refCount=1,this.cleanupHandlers=[],this.graceTimeout=-1,this.doc=null,this.destroyed=!1,this.on=Xu(),this.doc=e,this.off=(a,l)=>{var u;return(u=this.on[a])===null||u===void 0?void 0:u.unsubscribe(l)},"dispose"in Symbol&&(this[Symbol.dispose]=()=>zt.release(e)),e.on("load",()=>this.on("load").fire()),e.on("sync",a=>a!==!1&&this.on("sync").fire()),e.on("destroy",this.destroy.bind(this)),this.on("error",a=>{this._error=a});const{db:n,parentTable:r,parentId:i,updatesTable:o}=e.meta||{};if(!n||!r||!o)throw new Error("Missing Dexie-related metadata in Y.Doc. Documents need to be obtained through Y.Doc properties from dexie queries.");if(!n.table(r)||!n.table(o))throw new Error(`Table ${r} or ${o} not found in db`);Sl(e),this.stopObserving=Ob(this,e,n,r,o,i),zt.on("new").fire(this)}destroy(){var e,n,r;console.debug(`Y.Doc ${(n=(e=this.doc)===null||e===void 0?void 0:e.meta)===null||n===void 0?void 0:n.parentId} was destroyed`),Bi.delete(this.doc),this.doc=null,this.destroyed=!0,this.refCount=0,(r=this.stopObserving)===null||r===void 0||r.call(this),this.on=Xu(),this.cleanupHandlers.forEach(i=>i())}addCleanupHandler(e){this.cleanupHandlers.push(typeof e=="function"?e:()=>e.unsubscribe())}}zt.on=rt.Events(null,{new:[Pb],beforeunload:[Mb]});zt.getDocCache=Eh;rt.DexieYProvider?zt=rt.DexieYProvider||zt:rt.DexieYProvider=zt;const Xa=3e4;class jb extends Vy{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=ys();this.getLocalState()!==null&&Xa/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((i,o)=>{o!==this.clientID&&Xa<=n-i.lastUpdated&&this.states.has(o)&&r.push(o)}),r.length>0&&Dh(this,r,"timeout")},Yn(Xa/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const n=this.clientID,r=this.meta.get(n),i=r===void 0?0:r.clock+1,o=this.states.get(n);e===null?this.states.delete(n):this.states.set(n,e),this.meta.set(n,{clock:i,lastUpdated:ys()});const a=[],l=[],u=[],d=[];e===null?d.push(n):o==null?e!=null&&a.push(n):(l.push(n),Ji(o,e)||u.push(n)),(a.length>0||u.length>0||d.length>0)&&this.emit("change",[{added:a,updated:u,removed:d},"local"]),this.emit("update",[{added:a,updated:l,removed:d},"local"])}setLocalStateField(e,n){const r=this.getLocalState();r!==null&&this.setLocalState({...r,[e]:n})}getStates(){return this.states}}const Dh=(t,e,n)=>{const r=[];for(let i=0;i<e.length;i++){const o=e[i];if(t.states.has(o)){if(t.states.delete(o),o===t.clientID){const a=t.meta.get(o);t.meta.set(o,{clock:a.clock+1,lastUpdated:ys()})}r.push(o)}}r.length>0&&(t.emit("change",[{added:[],updated:[],removed:r},n]),t.emit("update",[{added:[],updated:[],removed:r},n]))},Lb=(t,e,n=t.states)=>{const r=e.length,i=pi();Ge(i,r);for(let o=0;o<r;o++){const a=e[o],l=n.get(a)||null,u=t.meta.get(a).clock;Ge(i,a),Ge(i,u),dn(i,JSON.stringify(l))}return nn(i)},Rb=(t,e,n)=>{const r=bo(e),i=ys(),o=[],a=[],l=[],u=[],d=dt(r);for(let f=0;f<d;f++){const p=dt(r);let v=dt(r);const y=JSON.parse(hn(r)),b=t.meta.get(p),k=t.states.get(p),x=b===void 0?0:b.clock;(x<v||x===v&&y===null&&t.states.has(p))&&(y===null?p===t.clientID&&t.getLocalState()!=null?v++:t.states.delete(p):t.states.set(p,y),t.meta.set(p,{clock:v,lastUpdated:i}),b===void 0&&y!==null?o.push(p):b!==void 0&&y===null?u.push(p):y!==null&&(Ji(y,k)||l.push(p),a.push(p)))}(o.length>0||l.length>0||u.length>0)&&t.emit("change",[{added:o,updated:l,removed:u},n]),(o.length>0||a.length>0||u.length>0)&&t.emit("update",[{added:o,updated:a,removed:u},n])};function Te(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(d){try{u(r.next(d))}catch(f){o(f)}}function l(d){try{u(r.throw(d))}catch(f){o(f)}}function u(d){var f;d.done?i(d.value):(f=d.value,f instanceof n?f:new n((function(p){p(f)}))).then(a,l)}u((r=r.apply(t,e||[])).next())}))}function Ub(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ut(t){return this instanceof Ut?(this.v=t,this):new Ut(t)}function xl(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(p){i[p]&&(r[p]=function(v){return new Promise((function(y,b){o.push([p,v,y,b])>1||l(p,v)}))})}function l(p,v){try{(function(y){y.value instanceof Ut?Promise.resolve(y.value.v).then(u,d):f(o[0][2],y)})(i[p](v))}catch(y){f(o[0][3],y)}}function u(p){l("next",p)}function d(p){l("throw",p)}function f(p,v){p(v),o.shift(),o.length&&l(o[0][0],o[0][1])}}function El(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=Ub(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=t[i]&&function(o){return new Promise((function(a,l){(function(u,d,f,p){Promise.resolve(p).then((function(v){u({value:v,done:f})}),d)})(a,l,(o=t[i](o)).done,o.value)}))}}}const Nb={}.hasOwnProperty;function Is(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){(function(d){if(!d)throw new Error("Assertion Failed")})(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)Is(t,e[r],n[r])}else{var o=e.indexOf(".");if(o!==-1){var a=e.substr(0,o),l=e.substr(o+1);if(l==="")n===void 0?Array.isArray(t)?isNaN(parseInt(a))||t.splice(parseInt(a),1):delete t[a]:t[a]=n;else{var u=t[a];u&&(function(d,f){return Nb.call(d,f)})(t,a)||(u=t[a]={}),Is(u,l,n)}}else n===void 0?Array.isArray(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}const Th=typeof self<"u"&&typeof crypto<"u"?(t,e=crypto.getRandomValues.bind(crypto))=>{const n=new Uint8Array(t);return e(n),self.btoa(String.fromCharCode.apply(null,n))}:typeof Buffer<"u"?(t,e=Fb)=>{const n=Buffer.alloc(t);return e(n),n.toString("base64")}:()=>{throw new Error("No implementation of randomString was found")};function Fb(t){for(let e=0;e<t.length;++e)t[e]=Math.floor(256*Math.random())}function uc(t){return typeof t=="string"||!!(Array.isArray(t)&&t.some((e=>uc(e)))&&t.every(Ah))}function Ah(t){return typeof t=="string"||typeof t=="number"||Array.isArray(t)&&t.every(Ah)}function Bb(t,e,n){const r=t[e]||(t[e]={}),i=n.keys.map((o=>typeof o=="string"?o:JSON.stringify(o)));switch(n.type){case"insert":case"upsert":i.forEach(((o,a)=>{r[o]={type:"ups",val:n.values[a]}}));break;case"update":case"modify":i.forEach(((o,a)=>{const l=n.type==="update"?n.changeSpecs[a]:n.changeSpec,u=r[o];if(u)switch(u.type){case"ups":for(const[d,f]of Object.entries(l))Is(u.val,d,f);break;case"del":break;case"upd":Object.assign(u.mod,l)}else r[o]={type:"upd",mod:l}}));break;case"delete":i.forEach((o=>{r[o]={type:"del"}}))}return t}function Zu(t,e){for(const{table:n,muts:r}of e)for(const i of r)Bb(t,n,i)}function Kb(t){return xl(this,arguments,(function*(){var e,n,r,i;let o=0,a=new Uint8Array(4),l=0,u=[],d=0;try{for(var f,p=!0,v=El(t);!(e=(f=yield Ut(v.next())).done);p=!0){i=f.value,p=!1;const y=i,b=new DataView(y.buffer,y.byteOffset,y.byteLength);let k=0;for(;k<y.byteLength;)switch(o){case 0:if(k+4>y.byteLength){for(const x of y.slice(k)){if(l===4)break;a[l++]=x,++k}if(l<4)break}else if(l>0&&l<4)for(const x of y.slice(k,k+4-l))a[l++]=x,++k;case 1:d=l===4?new DataView(a.buffer,0,4).getUint32(0,!1):b.getUint32(k,!1),l?l=0:k+=4;case 2:if(k>=y.byteLength){o=2;break}if(k+d>y.byteLength)u.push(y.slice(k)),d-=y.byteLength-k,o=2,k=y.byteLength;else{if(u.length>0){const x=new Uint8Array(u.reduce(((E,S)=>E+S.byteLength),d));let I=0;for(const E of u)x.set(E,I),I+=E.byteLength;x.set(y.slice(k,k+d),I),u=[],yield yield Ut(x)}else yield yield Ut(y.slice(k,k+d));k+=d,o=0}}}}catch(y){n={error:y}}finally{try{p||e||!(r=v.return)||(yield Ut(r.call(v)))}finally{if(n)throw n.error}}}))}function Oh(t,e){return Te(this,void 0,void 0,(function*(){try{const n=yield navigator.serviceWorker.ready;if(e==="push"&&n.sync&&(yield n.sync.register(`dexie-cloud:${t.name}`)),!n.active)throw new Error("Failed to trigger sync - there's no active service worker");return void n.active.postMessage({type:"dexie-cloud-sync",dbName:t.name,purpose:e})}catch{}}))}function Vn(t,e){t.cloud.usingServiceWorker?Oh(t,e):t.localSyncEvent.next({purpose:e})}const qb="fromBase64"in Uint8Array,Hb="toBase64"in Uint8Array.prototype,fc=typeof Buffer<"u"?t=>Buffer.from(t,"base64"):qb?t=>Uint8Array.fromBase64(t):t=>{const e=atob(t),n=e.length,r=new Uint8Array(n);for(var i=0;i<n;i++)r[i]=e.charCodeAt(i);return r},wi=typeof Buffer<"u"?t=>ArrayBuffer.isView(t)?Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("base64"):Buffer.from(t).toString("base64"):Hb?t=>(ArrayBuffer.isView(t)?t:new Uint8Array(t)).toBase64():t=>{const e=ArrayBuffer.isView(t)?t:new Uint8Array(t),n=[];for(let r=0,i=e.length;r<i;r+=4096){const o=e.subarray(r,r+4096);n.push(String.fromCharCode.apply(null,o))}return btoa(n.join(""))};class Cl extends Error{constructor({title:e,message:n,messageCode:r,messageParams:i}){super(n),this.name="TokenErrorResponseError",this.title=e,this.messageCode=r,this.messageParams=i}}function xo(t,e){return new Promise(((n,r)=>{const i=Object.assign(Object.assign({submitLabel:"Submit",cancelLabel:"Cancel"},e),{onSubmit:o=>{t.next(void 0),n(o)},onCancel:()=>{t.next(void 0),r(new rt.AbortError("User cancelled"))}});t.next(i)}))}function Il(t,e,...n){return xo(t,{type:"message-alert",title:e,alerts:n,fields:{},submitLabel:"OK",cancelLabel:null})}function $u(t,e,n){return Te(this,void 0,void 0,(function*(){let r=n||"";for(;!r||!/^[\w-+.]+@([\w-]+\.)+[\w-]{2,10}(\sas\s[\w-+.]+@([\w-]+\.)+[\w-]{2,10})?$/.test(r);)r=(yield xo(t,{type:"email",title:e,alerts:r?[{type:"error",messageCode:"INVALID_EMAIL",message:"Please enter a valid email address",messageParams:{}}]:[],fields:{email:{type:"email",placeholder:"you@somedomain.com"}}})).email;return r}))}function ef(t,e,n){return Te(this,void 0,void 0,(function*(){const r=[{type:"info",messageCode:"OTP_SENT",message:"A One-Time password has been sent to {email}",messageParams:{email:e}}];n&&r.push(n);const{otp:i}=yield xo(t,{type:"otp",title:"Enter OTP",alerts:r,fields:{otp:{type:"otp",label:"OTP",placeholder:"Paste OTP here"}}});return i}))}function Gs(t){return Te(this,void 0,void 0,(function*(){var e,n,r;const i=yield t.getCurrentUser(),{accessToken:o,accessTokenExpiration:a,refreshToken:l,refreshTokenExpiration:u,claims:d}=i;if(!o)return null;if(((e=a==null?void 0:a.getTime())!==null&&e!==void 0?e:1/0)>Date.now()&&(((n=i.license)===null||n===void 0?void 0:n.status)||"ok")==="ok")return i;if(!l)throw new Error("Refresh token missing");if(((r=u==null?void 0:u.getTime())!==null&&r!==void 0?r:1/0)<=Date.now())throw new Error("Refresh token has expired");const f=yield Js(t.cloud.options.databaseUrl,i);return yield t.table("$logins").update(d.sub,{accessToken:f.accessToken,accessTokenExpiration:f.accessTokenExpiration,claims:f.claims,license:f.license,data:f.data}),f}))}function Vb(t,e,n,r,i){return Te(this,void 0,void 0,(function*(){return e.accessToken&&e.accessTokenExpiration.getTime()>Date.now()?e:e.refreshToken&&(!e.refreshTokenExpiration||e.refreshTokenExpiration.getTime()>Date.now())?yield Js(t,e):yield(function(o,a,l,u){return Te(this,void 0,void 0,(function*(){if(!crypto.subtle)throw typeof location<"u"&&location.protocol==="http:"?new Error("Dexie Cloud Addon needs to use WebCrypto, but your browser has disabled it due to being served from an insecure location. Please serve it from https or http://localhost:<port> (See https://stackoverflow.com/questions/46670556/how-to-enable-crypto-subtle-for-unsecure-origins-in-chrome/46671627#46671627)"):new Error("This browser does not support WebCrypto.");const{privateKey:d,publicKey:f}=yield crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!1,["sign","verify"]);if(!d||!f)throw new Error("Could not generate RSA keypair");o.nonExportablePrivateKey=d;const p=(function(v){const y=wi(v);return(function(b){let k=`-----BEGIN PUBLIC KEY-----
`;for(;b.length>0;)k+=b.substring(0,64)+`
`,b=b.substring(64);return k+="-----END PUBLIC KEY-----",k})(y)})(yield crypto.subtle.exportKey("spki",f));o.publicKey=f;try{const v=yield a({public_key:p,hints:u});if(v.type==="error")throw new Cl(v);if(v.type!=="tokens")throw new Error(`Unexpected response type from token endpoint: ${v.type}`);return o.accessToken=v.accessToken,o.accessTokenExpiration=new Date(v.accessTokenExpiration),o.refreshToken=v.refreshToken,v.refreshTokenExpiration&&(o.refreshTokenExpiration=new Date(v.refreshTokenExpiration)),o.userId=v.claims.sub,o.email=v.claims.email,o.name=v.claims.name,o.claims=v.claims,o.license={type:v.userType,status:v.claims.license||"ok"},o.data=v.data,v.evalDaysLeft!=null&&(o.license.evalDaysLeft=v.evalDaysLeft),v.userValidUntil!=null&&(o.license.validUntil=new Date(v.userValidUntil)),v.alerts&&v.alerts.length>0&&(yield xo(l,{type:"message-alert",title:"Authentication Alert",fields:{},alerts:v.alerts})),o}catch(v){if(v instanceof Cl)throw yield Il(l,v.title,{type:"error",messageCode:v.messageCode,message:v.message,messageParams:{}}),v;let y="We're having a problem authenticating right now.";throw v instanceof TypeError&&(y=typeof navigator!==void 0&&!navigator.onLine?"You seem to be offline. Please connect to the internet and try again.":rt.debug||typeof location<"u"&&(location.hostname==="localhost"||location.hostname==="127.0.0.1")?`Could not connect to server. Please verify that your origin '${location.origin}' is whitelisted using \`npx dexie-cloud whitelist\``:"Could not connect to server. Please verify the connection.",yield Il(l,"Authentication Failed",{type:"error",messageCode:"GENERIC_ERROR",message:y,messageParams:{}}).catch((()=>{}))),v}}))})(e,n,r,i)}))}function Js(t,e){return Te(this,void 0,void 0,(function*(){if(!e.refreshToken)throw new Error("Cannot refresh token - refresh token is missing.");if(!e.nonExportablePrivateKey)throw new Error("login.nonExportablePrivateKey is missing - cannot sign refresh token without a private key.");const n=Date.now(),r="RSASSA-PKCS1-v1_5",i=new TextEncoder().encode(e.refreshToken+n),o=yield crypto.subtle.sign(r,e.nonExportablePrivateKey,i),a=wi(o),l={grant_type:"refresh_token",refresh_token:e.refreshToken,scopes:["ACCESS_DB"],signature:a,signing_algorithm:r,time_stamp:n},u=yield fetch(`${t}/token`,{body:JSON.stringify(l),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});if(u.status!==200)throw new Error(`RefreshToken: Status ${u.status} from ${t}/token`);const d=yield u.json();if(d.type==="error")throw new Cl(d);return e.accessToken=d.accessToken,e.accessTokenExpiration=d.accessTokenExpiration?new Date(d.accessTokenExpiration):void 0,e.claims=d.claims,e.license={type:d.userType,status:d.claims.license||"ok"},d.evalDaysLeft!=null&&(e.license.evalDaysLeft=d.evalDaysLeft),d.userValidUntil!=null&&(e.license.validUntil=new Date(d.userValidUntil)),d.data&&(e.data=d.data),e}))}const tf=new WeakMap;class dc{constructor(e,n){tf.set(this,e),Object.assign(this,n)}static load(e,n){return e.table("$logins").get(n).then((r=>new dc(e,r||{userId:n,claims:{sub:n},lastLogin:new Date(0)})))}save(){return Te(this,void 0,void 0,(function*(){tf.get(this).table("$logins").put(this)}))}}const Zt={userId:"unauthorized",name:"Unauthorized",claims:{sub:"unauthorized"},lastLogin:new Date(0)};try{Object.freeze(Zt),Object.freeze(Zt.claims)}catch{}function Mh(t,e){return Tr(on(t).pipe(fn(e)))}function Ph(t){return Te(this,void 0,void 0,(function*(){const e=yield Dl(t);if(e){if(!(yield(function(n,r,i){return Te(this,void 0,void 0,(function*(){const o=[{type:"warning",messageCode:"LOGOUT_CONFIRMATION",message:`{numUnsyncedChanges} unsynced changes will get lost!
                Logout anyway?`,messageParams:{currentUserId:r,numUnsyncedChanges:i.toString()}}];return yield xo(n,{type:"logout-confirmation",title:"Confirm Logout",alerts:o,fields:{},submitLabel:"Confirm logout",cancelLabel:"Cancel"}).then((()=>!0)).catch((()=>!1))}))})(t.cloud.userInteraction,t.cloud.currentUserId,e)))throw new Error("User cancelled logout due to unsynced changes");yield Dl(t,{deleteUnsyncedData:!0})}}))}function Dl(t){return Te(this,arguments,void 0,(function*(e,{deleteUnsyncedData:n=!1}={}){const[r,i]=yield e.dx.transaction("rw",e.dx.tables,(o=>Te(this,void 0,void 0,(function*(){const a=o.idbtrans;a.disableChangeTracking=!0,a.disableAccessControl=!0;const l=o.storeNames.filter((d=>d.endsWith("_mutations"))),u=(yield Promise.all(l.map((d=>o.table(d).count())))).reduce(((d,f)=>d+f),0);if(u>0&&!n)return[u,!1];e.$syncState.delete("syncState");for(const d of e.dx.tables)d.name!=="$jobs"&&d.name!=="$syncState"&&d.clear();return[u,!0]}))));return i&&(yield Mh(e.cloud.currentUser,(o=>o.userId===Zt.userId)),yield e.cloud.sync({purpose:"pull",wait:!0})),r}))}class Tl extends Error{constructor(e,n){super(n||`${e.status} ${e.statusText}`),this.httpStatus=e.status}get name(){return"HttpError"}}function Qo(t,...e){globalThis.console[t](...e)}function Za(t,e){return Te(this,void 0,void 0,(function*(){var n;const r=yield t.getCurrentUser(),i=r.userId;if(r.isLoggedIn&&(!e||!e.email&&!e.userId)){if((((n=r.license)===null||n===void 0?void 0:n.status)||"ok")==="ok"&&r.accessToken&&(!r.accessTokenExpiration||r.accessTokenExpiration.getTime()>Date.now()))return!1;if(r.refreshToken&&(!r.refreshTokenExpiration||r.refreshTokenExpiration.getTime()>Date.now()))return yield Gs(t),!1}const o=new dc(t,{claims:{},lastLogin:new Date(0)});return yield Vb(t.cloud.options.databaseUrl,o,t.cloud.options.fetchTokens||(function(a){const{userInteraction:l}=a.cloud;return function(u){return Te(this,arguments,void 0,(function*({public_key:d,hints:f}){var p;let v;const y=(p=a.cloud.options)===null||p===void 0?void 0:p.databaseUrl;if(!y)throw new Error("No database URL given.");if((f==null?void 0:f.grant_type)==="demo")v={demo_user:yield $u(l,"Enter a demo user email",(f==null?void 0:f.email)||(f==null?void 0:f.userId)),grant_type:"demo",scopes:["ACCESS_DB"],public_key:d};else if(f!=null&&f.otpId&&f.otp)v={grant_type:"otp",otp_id:f.otpId,otp:f.otp,scopes:["ACCESS_DB"],public_key:d};else{const x=yield $u(l,"Enter email address",f==null?void 0:f.email);v=/@demo.local$/.test(x)?{demo_user:x,grant_type:"demo",scopes:["ACCESS_DB"],public_key:d}:{email:x,grant_type:"otp",scopes:["ACCESS_DB"]}}const b=yield fetch(`${y}/token`,{body:JSON.stringify(v),method:"post",headers:{"Content-Type":"application/json",mode:"cors"}});if(b.status!==200){const x=yield b.text();throw yield Il(l,"Token request failed",{type:"error",messageCode:"GENERIC_ERROR",message:x,messageParams:{}}).catch((()=>{})),new Tl(b,x)}const k=yield b.json();if(k.type==="tokens"||k.type==="error")return k;if(v.grant_type==="otp"&&"email"in v){if(k.type!=="otp-sent")throw new Error(`Unexpected response from ${y}/token`);const x=yield ef(l,v.email),I=Object.assign(Object.assign({},v),{otp:x||"",otp_id:k.otp_id,public_key:d});let E=yield fetch(`${y}/token`,{body:JSON.stringify(I),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});for(;E.status===401;){const S=yield E.text();I.otp=yield ef(l,v.email,{type:"error",messageCode:"INVALID_OTP",message:S,messageParams:{}}),E=yield fetch(`${y}/token`,{body:JSON.stringify(I),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"})}if(E.status!==200){const S=yield E.text();throw new Tl(E,S)}return yield E.json()}throw new Error(`Unexpected response from ${y}/token`)}))}})(t),t.cloud.userInteraction,e),i!==Zt.userId&&o.userId!==i&&(yield Ph(t)),yield(function(a,l){return Te(this,void 0,void 0,(function*(){const u=a.table("$logins");yield a.transaction("rw",u,(d=>Te(this,void 0,void 0,(function*(){const f=yield u.toArray();yield Promise.all(f.filter((p=>p.userId!==l.userId&&p.isLoggedIn)).map((p=>(p.isLoggedIn=!1,u.put(p))))),l.isLoggedIn=!0,l.lastLogin=new Date;try{yield l.save()}catch(p){try{p.name==="DataCloneError"&&(Qo("debug","Login context property names:",Object.keys(l)),Qo("debug","Login context property names:",Object.keys(l)),Qo("debug","Login context:",l),Qo("debug","Login context JSON:",JSON.stringify(l)))}catch{}throw p}})))),yield Mh(a.cloud.currentUser,(d=>d.userId===l.userId))}))})(t,o),Vn(t,"pull"),o.userId!==i}))}const Al={},Xi=typeof self<"u"&&self.document&&typeof navigator<"u"&&navigator.serviceWorker;Xi&&Xi.ready.then((t=>Al.registration=t)),typeof self<"u"&&"clients"in self&&!self.document&&addEventListener("message",(t=>{var e,n;!((n=(e=t.data)===null||e===void 0?void 0:e.type)===null||n===void 0)&&n.startsWith("sw-broadcast-")&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach((r=>{var i;return r.id!==((i=t.source)===null||i===void 0?void 0:i.id)&&r.postMessage(t.data)}))}));class $a{constructor(e){this.name=e}subscribe(e){if(!Xi)return()=>{};const n=r=>{var i;((i=r.data)===null||i===void 0?void 0:i.type)===`sw-broadcast-${this.name}`&&e(r.data.message)};return Xi.addEventListener("message",n),()=>Xi.removeEventListener("message",n)}postMessage(e){var n;typeof self.clients=="object"?[...self.clients.matchAll({includeUncontrolled:!0})].forEach((r=>r.postMessage({type:`sw-broadcast-${this.name}`,message:e}))):Al.registration&&((n=Al.registration.active)===null||n===void 0||n.postMessage({type:`sw-broadcast-${this.name}`,message:e}))}}const Ki=globalThis["lbc-events"]||(globalThis["lbc-events"]=new Map);class Xo extends At{constructor(e){const n=typeof BroadcastChannel>"u"?new $a(e):new BroadcastChannel(e);super((r=>{function i(l){r.next(l.detail)}function o(l){r.next(l.data)}let a;(function(l,u){Ki.has(l)?Ki.get(l).push(u):Ki.set(l,[u])})(`lbc-${e}`,i);try{n instanceof $a?a=n.subscribe((l=>r.next(l))):n.addEventListener("message",o)}catch{}return()=>{(function(l,u){const d=Ki.get(l);if(d){const f=d.indexOf(u);f!==-1&&d.splice(f,1)}})(`lbc-${e}`,i),n instanceof $a?a():n.removeEventListener("message",o)}})),this.name=e,this.bc=n}next(e){this.bc.postMessage(e),(function(n){const r=Ki.get(n.type);r&&r.forEach((i=>{try{i(n)}catch{}}))})(new CustomEvent(`lbc-${this.name}`,{detail:e}))}}function Ol(t){return Te(this,arguments,void 0,(function*({realms:e,inviteRealms:n}){const r=JSON.stringify([...e.map((a=>({realmId:a,accepted:!0}))),...n.map((a=>({realmId:a,accepted:!1})))].sort(((a,l)=>a.realmId<l.realmId?-1:a.realmId>l.realmId?1:0))),i=new TextEncoder().encode(r),o=yield crypto.subtle.digest("SHA-1",i);return wi(o)}))}function cs(t){return Object.entries(t.cloud.schema||{}).filter((([,{markedForSync:e}])=>e)).map((([e])=>t.tables.filter((({name:n})=>n===e))[0])).filter((e=>e))}function hc(t){return`$${t}_mutations`}function jh(t){var e;const n=(e=/^\$(.*)_mutations$/.exec(t))===null||e===void 0?void 0:e[1];if(!n)throw new Error(`Given mutationTable ${t} is not correct`);return n}const zb=[].concat;function pc(t){return zb.apply([],t)}function Ml(t,e){return Te(this,arguments,void 0,(function*(n,r,{since:i={},limit:o=1/0}={}){const a=pc(yield Promise.all(n.map((f=>Te(this,void 0,void 0,(function*(){const p=jh(f.name),v=i[p];let y=v?f.where("rev").above(v):f;return o<1/0&&(y=y.limit(o)),(yield y.toArray()).map((b=>({table:p,mut:b})))})))))).sort(((f,p)=>f.mut.txid===p.mut.txid?f.mut.opNo-p.mut.opNo:f.mut.ts-p.mut.ts)),l=[];let u=null,d=null;for(const{table:f,mut:p}of a)u&&u.table===f&&d===p.txid?u.muts.push(p):(u={table:f,muts:[p]},d=p.txid,l.push(u));return l}))}function Lh(t){const e=new Uint8Array(t);if(typeof crypto<"u")crypto.getRandomValues(e);else for(let n=0;n<t;n++)e[n]=Math.floor(256*Math.random());if(typeof Buffer<"u"&&Buffer.from)return Buffer.from(e).toString("base64");if(typeof btoa<"u")return btoa(String.fromCharCode.apply(null,e));throw new Error("No btoa or Buffer available")}const{toString:Wb}={},nf={replace:function(t){const e=Object.keys(t);let n=null;for(let i=0,o=e.length;i<o;++i)e[i][0]==="$"&&(n=n||[],n.push(e[i]));if(!n)return t;const r={...t};for(const i of n)delete r[i];for(const i of n)r["$"+i]=t[i];return r}};function Rh(...t){const e=t.reduce(((r,i)=>({...r,...i})),t.reduce(((r,i)=>({...i,...r})),{})),n=new WeakMap;return{stringify(r,i,o){return JSON.stringify(r,(function(l){const u=this[l],d=(function(f){const p=typeof f;switch(typeof f){case"object":case"function":{if(f===null)return null;const y=Object.getPrototypeOf(f);if(!y)return nf;let b=n.get(y);if(b!==void 0)return b;const k=(v=f,Wb.call(v).slice(8,-1)),x=Object.entries(e).find((([I,E])=>{var S,D;return(D=(S=E==null?void 0:E.test)===null||S===void 0?void 0:S.call(E,f,k))!==null&&D!==void 0?D:I===k}));return b=x==null?void 0:x[1],b||(b=Array.isArray(f)?null:typeof f=="function"?e.function||null:nf),n.set(y,b),b}default:return e[p]}var v})(u);return d?d.replace(u,i,e):u}),o)},parse(r,i){const o=[];return JSON.parse(r,(function(a,l){const u=l==null?void 0:l.$t;if(u){const f=e[u];l=f?f.revive(l,i,e):l}let d=o[o.length-1];if(d&&d[0]===l){l={...l};for(const f of d[1])delete l[f];for(const[f,p]of Object.entries(d[2]))l[f]=p;o.pop()}if(l===void 0||a[0]==="$"&&a!=="$t"){let f,p;d=o[o.length-1],d&&d[0]===this?(f=d[1],p=d[2]):o.push([this,f=[],p={}]),a[0]==="$"&&a!=="$t"?(f.push(a),p[a.substr(1)]=l):p[a]=void 0}return l}))}}}const Yb={Blob:{test:(t,e)=>e==="Blob",replace:(t,e)=>{const n=e.length;return e.push(t),{$t:"Blob",mimeType:t.type,i:n}},revive:({i:t,mimeType:e},n)=>new Blob([n[t]],{type:e})}};var Gb={number:{replace:t=>{switch(!0){case isNaN(t):return{$t:"number",v:"NaN"};case t===1/0:return{$t:"number",v:"Infinity"};case t===-1/0:return{$t:"number",v:"-Infinity"};default:return t}},revive:({v:t})=>Number(t)}};const Jb={bigint:{replace:t=>({$t:"bigint",v:""+t}),revive:t=>BigInt(t.v)}};var Qb={Date:{replace:t=>({$t:"Date",v:isNaN(t.getTime())?"NaN":t.toISOString()}),revive:({v:t})=>new Date(t==="NaN"?NaN:Date.parse(t))}},Xb={Set:{replace:t=>({$t:"Set",v:Array.from(t.entries())}),revive:({v:t})=>new Set(t)}},Zb={Map:{replace:t=>({$t:"Map",v:Array.from(t.entries())}),revive:({v:t})=>new Map(t)}};const $b=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:void 0;var e0=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","DataView","BigInt64Array","BigUint64Array"].reduce(((t,e)=>({...t,[e]:{replace:(n,r,i)=>({$t:e,v:i.ArrayBuffer.replace(n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength),r,i).v}),revive:({v:n},r,i)=>{const o=$b[e];return o&&new o(i.ArrayBuffer.revive({v:n},r,i))}}})),{});function Uh(t){return(function(e){for(var n="",r=0,i=e.length;r<i;r++)n+=Nh[e[r]];return n})(wi(t))}function t0(t){return fc((function(e){if(typeof e!="string")throw new Error("invalid decoder input: "+e);for(var n="",r=0,i=e.length;r<i;r++)n+=Pl[e[r]];return n})(t))}const Pl={"-":"=",0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",A:"K",B:"L",C:"M",D:"N",E:"O",F:"P",G:"Q",H:"R",I:"S",J:"T",K:"U",L:"V",M:"W",N:"X",O:"Y",P:"Z",Q:"a",R:"b",S:"c",T:"d",U:"e",V:"f",W:"g",X:"h",Y:"i",Z:"j",_:"k",a:"l",b:"m",c:"n",d:"o",e:"p",f:"q",g:"r",h:"s",i:"t",j:"u",k:"v",l:"w",m:"x",n:"y",o:"z",p:"0",q:"1",r:"2",s:"3",t:"4",u:"5",v:"6",w:"7",x:"8",y:"9",z:"+","|":"/"},Nh={};for(const t of Object.keys(Pl))Nh[Pl[t]]=t;var n0={ArrayBuffer:{replace:t=>({$t:"ArrayBuffer",v:Uh(t)}),revive:({v:t})=>{const e=t0(t);return e.buffer.byteLength===e.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}};class el{constructor(e,n){this.buf=e,this.type=n}}function Fh(t){const e=new XMLHttpRequest;if(e.overrideMimeType("text/plain; charset=x-user-defined"),e.open("GET",URL.createObjectURL(t),!1),e.send(),e.status!==200&&e.status!==0)throw new Error("Bad Blob access: "+e.status);return e.responseText}function Bh(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n);return e.buffer}var r0={Blob:{test:(t,e)=>e==="Blob"||t instanceof el,replace:t=>({$t:"Blob",v:wi(t instanceof el?t.buf:Bh(Fh(t))),type:t.type}),revive:({type:t,v:e})=>{const n=fc(e);return typeof Blob!==void 0?new Blob([n]):new el(n.buffer,t)}}};const Kh={...Gb,...Jb,...Qb,...Xb,...Zb,...e0,...n0,...r0};function rf(t){return new Promise(((e,n)=>{const r=new FileReader;r.onabort=i=>n(new Error("file read aborted")),r.onerror=i=>n(i.target.error),r.onload=i=>e(i.target.result),r.readAsArrayBuffer(t)}))}var i0={undefined:{replace:()=>({$t:"undefined"}),revive:()=>{}}},o0={File:{test:(t,e)=>e==="File",replace:t=>({$t:"File",v:wi(Bh(Fh(t))),type:t.type,name:t.name,lastModified:new Date(t.lastModified).toISOString()}),revive:({type:t,v:e,name:n,lastModified:r})=>{const i=fc(e);return new File([i],n,{type:t,lastModified:new Date(r).getTime()})}}};const s0=typeof BigInt=="function"&&typeof BigInt(0)=="bigint";class of{toString(){return this.v}constructor(e){this.v=e}}const a0=s0?{}:{bigint:{test:t=>t instanceof of,replace:t=>Object.assign({$t:"bigint"},t),revive:({v:t})=>new of(t)}},qh=Object.assign(Object.assign(Object.assign(Object.assign({},i0),a0),o0),{PropModification:{test:t=>t instanceof fu,replace:t=>Object.assign({$t:"PropModification"},t["@@propmod"]),revive:t=>{var e=(function(n,r){var i={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&r.indexOf(o)<0&&(i[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var a=0;for(o=Object.getOwnPropertySymbols(n);a<o.length;a++)r.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(n,o[a])&&(i[o[a]]=n[o[a]])}return i})(t,["$t"]);return new fu(e)}}}),ho=Rh(Kh,qh),l0=(function(...t){const e=Rh(Kh,Yb,...t);return{toBinary(n){const[r,i]=this.stringify(n),o=new ArrayBuffer(4);return new DataView(o).setUint32(0,r.size),new Blob([o,r,i])},stringify(n){const r=[],i=e.stringify(n,r);return[new Blob(r.map((a=>{const l=new ArrayBuffer(4);return new DataView(l).setUint32(0,"byteLength"in a?a.byteLength:a.size),new Blob([l,a])}))),i]},async parse(n,r){let i=0;const o=[],a=await rf(r),l=new DataView(a);for(;i<a.byteLength;){const u=l.getUint32(i);i+=4;const d=a.slice(i,i+u);i+=u,o.push(d)}return e.parse(n,o)},async fromBinary(n){const r=new DataView(await rf(n.slice(0,4))).getUint32(0),i=n.slice(4,r+4),o=await(function(a){return new Promise(((l,u)=>{const d=new FileReader;d.onabort=f=>u(new Error("file read aborted")),d.onerror=f=>u(f.target.error),d.onload=f=>l(f.target.result),d.readAsText(a)}))})(n.slice(r+4));return await this.parse(o,i)}}})(qh);function c0(t,e,n){const r=[];for(let i of n){const{table:o,muts:a}=i,l=t.tables.find((f=>f.name===o));if(!l)throw new Error(`Internal error: table ${o} not found in DBCore schema`);const{primaryKey:u}=l;let d=i;a.forEach(((f,p)=>{const v=!u.outbound&&(f.type==="upsert"||f.type==="insert");f.keys.forEach(((y,b)=>{if(Array.isArray(y)){d===i&&(d=sf(i,v));const k=d.muts[p],x=JSON.stringify(y);k.keys[b]=x}else if(y[0]==="#"){d===i&&(d=sf(i,v));const k=d.muts[p];if(!e.isLoggedIn)throw new Error("Internal error: Cannot sync private IDs before authenticated");const x=`${y}:${e.userId}`;k.keys[b]=x,v&&rt.setByKeyPath(k.values[b],u.keyPath,x)}}))})),r.push(d)}return r}function sf(t,e){return Object.assign(Object.assign({},t),{muts:e?t.muts.map((n=>n.type!=="insert"&&n.type!=="upsert"||!n.values?Object.assign(Object.assign({},n),{keys:n.keys.slice()}):Object.assign(Object.assign({},n),{keys:n.keys.slice(),values:n.values.slice()}))):t.muts.map((n=>Object.assign(Object.assign({},n),{keys:n.keys.slice()})))})}let jl=new WeakMap;function Hh(t){return Te(this,void 0,void 0,(function*(){var e,n;const r=((n=(e=jl.get(t))===null||e===void 0?void 0:e.getTime())!==null&&n!==void 0?n:0)-Date.now();r>0&&(yield new Promise((i=>setTimeout(i,r))))}))}function u0(t,e,n,r,i,o,a,l,u){return Te(this,void 0,void 0,(function*(){const d={Accept:"application/json, application/x-bison, application/x-bison-stream","Content-Type":"application/tson"},f=yield Gs(i),p=f==null?void 0:f.accessToken;p&&(d.Authorization=`Bearer ${p}`);const v={v:2,dbID:n==null?void 0:n.remoteDbId,clientIdentity:l,schema:a||{},lastPull:n?{serverRevision:n.serverRevision,yServerRevision:n.yServerRevision,realms:n.realms,inviteRealms:n.inviteRealms}:void 0,baseRevs:r,changes:c0(i.dx.core.schema,u,t),y:e,dxcv:i.cloud.version};i.syncStateChangedEvent.next({phase:"pushing"});const y=ho.stringify(v),b=yield fetch(`${o}/sync`,{method:"post",headers:d,credentials:"include",body:y});if(i.syncStateChangedEvent.next({phase:"pulling"}),(function(k,x){const I=x.headers.get("Ratelimit-Limit"),E=x.headers.get("Ratelimit-Remaining"),S=x.headers.get("Ratelimit-Reset");if(I&&E&&S){const D=Number(I),j=Math.max(0,Number(E)),O=Number(S);if(j<D/2){const M=Math.ceil(O/(j+1));jl.set(k,new Date(Date.now()+1e3*M))}else jl.delete(k)}})(i,b),!b.ok)throw new Tl(b);if(b.headers.get("content-type")==="application/x-bison")return l0.fromBinary(yield b.blob());{const k=yield b.text();return ho.parse(k)}}))}function qi(t){if(t!=null&&t.cancelled)throw new rt.AbortError("Operation was cancelled")}let ei=!1;function Vh(t,e,n,r){return Te(this,void 0,void 0,(function*(){yield t.$baseRevs.bulkPut(Object.keys(e).filter((i=>e[i].markedForSync)).map((i=>({tableName:i,clientRev:(n[i]||0)+1,serverRev:r})))),yield t.$baseRevs.where("tableName").noneOf(Object.keys(e).filter((i=>e[i].markedForSync))).delete()}))}function Ll(t,e={}){for(const{table:n,muts:r}of t){const i=r.length>0?r[r.length-1].rev:null;e[n]=i||e[n]||0}return e}function f0(t,e,n){return Te(this,void 0,void 0,(function*(){const r=yield t.bulkGet(e),i=[],o=[];e.forEach(((a,l)=>{const u=r[l];if(u){for(const[d,f]of Object.entries(n[l]))if(d===t.schema.primKey.keyPath){if(Ns(f,a)!==0)throw new Error("Cannot change primary key")}else rt.setByKeyPath(u,d,f);i.push(a),o.push(u)}})),yield t.schema.primKey.keyPath==null?t.bulkPut(o,i):t.bulkPut(o)}))}function zh(t,e){return Te(this,void 0,void 0,(function*(){for(const{table:n,muts:r}of t){if(!e.dx._allTables[n])continue;const i=e.table(n),{primaryKey:o}=i.core.schema,a=l=>{switch(l[0]){case"[":if(l.endsWith("]"))try{return JSON.parse(l)}catch{}return l;case"#":return l.endsWith(":"+e.cloud.currentUserId)?l.substr(0,l.length-e.cloud.currentUserId.length-1):l;default:return l}};for(const l of r){const u=l.keys.map(a);switch(l.type){case"insert":o.outbound?yield i.bulkAdd(l.values,u):(u.forEach(((d,f)=>{rt.setByKeyPath(l.values[f],o.keyPath,d)})),yield i.bulkAdd(l.values));break;case"upsert":o.outbound?yield i.bulkPut(l.values,u):(u.forEach(((d,f)=>{rt.setByKeyPath(l.values[f],o.keyPath,d)})),yield i.bulkPut(l.values));break;case"modify":u.length===1?yield i.update(u[0],l.changeSpec):yield i.where(":id").anyOf(u).modify(l.changeSpec);break;case"update":yield f0(i,u,l.changeSpecs);break;case"delete":yield i.bulkDelete(u)}}}}))}typeof self<"u"&&typeof navigator<"u"&&(ei=navigator.onLine,self.addEventListener("online",(()=>ei=!0)),self.addEventListener("offline",(()=>ei=!1)));const hr="dexie-cloud-syncer";function Wh(t,e){return t.where("i").between(e,1/0,!0).toArray()}function Zi(t,e,n){var r,i,o;if(!t.dx._allTables[e])return;const a=(o=(i=(r=t.table(e))===null||r===void 0?void 0:r.schema.yProps)===null||i===void 0?void 0:i.find((l=>l.prop===n)))===null||o===void 0?void 0:o.updatesTable;return a&&t.dx._allTables[a]?t.table(a):void 0}function Yh(t,e){return Te(this,void 0,void 0,(function*(){var n;const r={};let i,o=!1;for(const a of t)try{switch(a.type){case"u-s":{const l=Zi(e,a.table,a.prop);if(l){const u={k:a.k,u:a.u};a.r&&(u.r=a.r,i=a.r),r[l.name]=yield l.add(u)}break}case"u-ack":{const l=Zi(e,a.table,a.prop);l&&(yield e.transaction("rw",l,(u=>Te(this,void 0,void 0,(function*(){let d=yield u.table(l.name).get(hr);yield u.table(l.name).put(Object.assign(Object.assign({},d||{i:hr}),{unsentFrom:Math.max((d==null?void 0:d.unsentFrom)||1,a.i+1)}))})))));break}case"u-reject":{const l=Zi(e,a.table,a.prop);if(!l)break;const u=(n=yield l.get(a.i))===null||n===void 0?void 0:n.k;if(u!=null){yield e.transaction("rw",l,(f=>(f.idbtrans._rejecting_y_ypdate=!0,l.where("i").aboveOrEqual(a.i).filter((p=>Ns(p.k,u)===0&&(1&(p.f||0))==1)).delete())));const d=zt.getDocCache(e.dx).find(a.table,u,a.prop);d&&d.destroy()}break}case"in-sync":{const l=zt.getDocCache(e.dx).find(a.table,a.k,a.prop);l&&!l.isSynced&&l.emit("sync",[!0,l]);break}case"y-complete-sync-done":i=a.yServerRev;break;case"outdated-server-rev":o=!0}}catch{}return{receivedUntils:r,resyncNeeded:o,yServerRevision:i}}))}const d0=1,h0=2,p0=3;function v0(t,e,n){return Te(this,arguments,void 0,(function*(r,i,{yDownloadedRealms:o,realms:a}){if(o&&a&&a.every((f=>o[f]==="*")))return;const l=yield Gs(r),u={"Content-Type":"application/json",Accept:"application/octet-stream"};l&&(u.Authorization=`Bearer ${l.accessToken}`);const d=yield fetch(`${i}/y/download`,{body:ho.stringify({downloadedRealms:o||{}}),method:"POST",headers:u,credentials:"include"});if(!d.ok)throw new Error(`Failed to download Yjs documents from server. Status: ${d.status}`);yield(async function(f,...p){var v,y,b;let k=f();for(let S=0;S<p.length;S++)k=p[S](k);try{for(var x,I=!0,E=El(k);!(v=(x=await E.next()).done);I=!0)x.value,I=!1}catch(S){y={error:S}}finally{try{I||v||!(b=E.return)||await b.call(E)}finally{if(y)throw y.error}}})((function(f){return function(){return xl(this,arguments,(function*(){if(!f.body)throw new Error("Response body is not readable");const p=f.body.getReader();try{for(;;){const{done:v,value:y}=yield Ut(p.read());if(v)return yield Ut(void 0);yield yield Ut(y)}}finally{p.releaseLock()}}))}})(d),Kb,(function(f){return xl(this,arguments,(function*(){var p,v,y,b;let k=null,x=null,I=null,E=[];function S(M){return Te(this,void 0,void 0,(function*(){const ie=E[E.length-1];if(E.length>0){if(!k||!x||!I)throw new Error(`Protocol error from ${i}/y/download`);const ne=Zi(r,x,I);ne&&(yield ne.bulkAdd(E)),E=[]}k&&(x&&I&&ie||M)&&(yield r.$syncState.update("syncState",(ne=>{const re=ne.yDownloadedRealms||{};re[k]=M?"*":{tbl:x,prop:I,key:ie.k},ne.yDownloadedRealms=re})))}))}try{try{for(var D,j=!0,O=El(f);!(p=(D=yield Ut(O.next())).done);j=!0){b=D.value,j=!1;const M=new vi(b);for(;ad(M);)switch(ni(M)){case d0:yield Ut(S(!0)),k=hn(M);break;case h0:yield Ut(S(!1)),x=hn(M),I=hn(M);break;case p0:{const ie=fr(M),ne=Rt(M);E.push({k:ie,u:ne});break}}yield Ut(S(!1))}}catch(M){v={error:M}}finally{try{j||p||!(y=O.return)||(yield Ut(y.call(O)))}finally{if(v)throw v.error}}yield Ut(S(!0))}catch(M){throw M instanceof rt.DexieError||(yield Ut(S(!1))),M}}))}))}))}const Gh="currentSyncWorker";function Qs(t,e,n,r){return Jh(t,e,n,r).then((i=>(r!=null&&r.justCheckIfNeeded||t.syncStateChangedEvent.next({phase:"in-sync"}),i))).catch((i=>Te(this,void 0,void 0,(function*(){return r!=null&&r.justCheckIfNeeded?Promise.reject(i):ei&&(r!=null&&r.retryImmediatelyOnFetchError)&&(i==null?void 0:i.name)==="TypeError"&&/fetch/.test(i==null?void 0:i.message)?(t.syncStateChangedEvent.next({phase:"error",error:i}),yield new Promise((o=>setTimeout(o,500))),yield Qs(t,e,n,Object.assign(Object.assign({},r),{retryImmediatelyOnFetchError:!1}))):(yield t.$syncState.update("syncState",{timestamp:new Date,error:""+i}),t.syncStateChangedEvent.next({phase:ei?"error":"offline",error:new Error(""+(i==null?void 0:i.message)||i)}),Promise.reject(i))}))))}function Jh(t,e,n){return Te(this,arguments,void 0,(function*(r,i,o,{isInitialSync:a,cancelToken:l,justCheckIfNeeded:u,purpose:d}={isInitialSync:!1}){var f;if(!(!((f=r.cloud.options)===null||f===void 0)&&f.databaseUrl))throw new Error("Internal error: sync must not be called when no databaseUrl is configured");const{databaseUrl:p}=i,v=yield r.getCurrentUser(),y=v.isLoggedIn?cs(r):[],b=y.map((te=>r.table(hc(te.name)))),k=yield r.getPersistedSyncState(),x=v.isLoggedIn,I=x?(function(te,$){const se=($==null?void 0:$.syncedTables)||[];return cs(te).filter((ge=>!se.includes(ge.name)))})(r,k):[];qi(l);const E=I.length>0;if(E){if(u)return!0;yield r.transaction("rw",I,(te=>Te(this,void 0,void 0,(function*(){te.idbtrans.disableChangeTracking=!0,te.idbtrans.disableAccessControl=!0,yield(function($,se,ge){return Te(this,void 0,void 0,(function*(){const _e=new Set(ge||[]);for(const G of $)G.name==="members"?yield G.toCollection().modify((U=>{_e.has(U.realmId)||U.userId&&U.userId!==Zt.userId||(U.userId=se.userId)})):G.name==="roles"||(G.name==="realms"?yield G.toCollection().modify((U=>{_e.has(U.realmId)||U.owner!==void 0&&U.owner!==Zt.userId||(U.owner=se.userId)})):yield G.toCollection().modify((U=>{U.realmId&&_e.has(U.realmId)||(U.owner&&U.owner!==Zt.userId||(U.owner=se.userId),U.realmId&&U.realmId!==Zt.userId||(U.realmId=se.userId))})))}))})(I,v,k==null?void 0:k.realms)})))),qi(l)}const[S,D,j,{yMessages:O,lastUpdateIds:M}]=yield r.transaction("r",r.tables,(()=>Te(this,void 0,void 0,(function*(){const te=yield r.getPersistedSyncState();let $=yield r.$baseRevs.toArray();$=$.filter((_e=>y.some((G=>G.name===_e.tableName))));let se=yield Ml(b,r);const ge=yield(function(_e,G){return Te(this,void 0,void 0,(function*(){const U=[],Y={};for(const ve of G)if(ve.schema.yProps)for(const Ee of ve.schema.yProps){const Me=_e.table(Ee.updatesTable),ye=yield Me.get(hr),ke=(ye==null?void 0:ye.unsentFrom)||1,oe=(ye==null?void 0:ye.receivedUntil)||0,Pe=Math.min(ke,oe+1),Be=yield Wh(Me,Pe);Be.length>0&&(Y[Me.name]=Be[Be.length-1].i);const Se={};for(const Ne of Be){const Ue=(1&(Ne.f||0))==1;if(Ue&&Ne.i<ke)continue;const Ve=JSON.stringify(Ne.k)+"/"+Ue;let mt=Se[Ve];mt?(mt.u.push(Ne.u),mt.i=Math.max(Ne.i,mt.i)):(Se[Ve]=mt={i:Ne.i,k:Ne.k,isLocal:Ue,u:[]},mt.u.push(Ne.u))}for(const{k:Ne,isLocal:Ue,u:Ve,i:mt}of Object.values(Se)){const kt=Ve.length===1?Ve[0]:ws(Ve);if(Ue)U.push({type:"u-c",table:ve.name,prop:Ee.prop,k:Ne,u:kt,i:mt});else{const vt=ih(kt);U.push({type:"sv",table:ve.name,prop:Ee.prop,k:Ne,sv:vt})}}}return{yMessages:U,lastUpdateIds:Y}}))})(r,y);if(qi(l),E){const _e=[...(k==null?void 0:k.realms)||[],...(k==null?void 0:k.inviteRealms)||[]],G=yield(function(U,Y,ve,Ee){return Te(this,void 0,void 0,(function*(){const Me=`upload-${Lh(8)}`;if(Y.isLoggedIn&&U.length>0){const ye=new Set(Ee||[]);return(yield Promise.all(U.map((ke=>Te(this,void 0,void 0,(function*(){const{extractKey:oe}=ke.core.schema.primaryKey;if(!oe)return{table:ke.name,muts:[]};const Pe=ve[ke.name],Be=Pe!=null&&Pe.generatedGlobalId?ke.filter((Ne=>{return oe(Ne),!ye.has(Ne.realmId||"")&&(Ue=oe(Ne),!(Ve=Pe==null?void 0:Pe.idPrefix)||typeof Ue=="string"&&Ue.startsWith(Ve));var Ue,Ve})):ke.filter((Ne=>{const Ue=oe(Ne);return!ye.has(Ne.realmId||"")&&uc(Ue)})),Se=yield Be.toArray();if(Se.length>0){const Ne={type:"upsert",values:Se,keys:Se.map(oe),userId:Y.userId,txid:Me};return{table:ke.name,muts:[Ne]}}return{table:ke.name,muts:[]}})))))).filter((ke=>ke.muts.length>0))}return[]}))})(I,v,o,_e);return qi(l),se=se.concat(G),[se,te,$,ge]}return[se,te,$,ge]})))),ie=S.some((te=>te.muts.some(($=>$.keys.length>0))))||O.some((te=>te.type==="u-c"));if(u)return ie;if(d==="push"&&!ie)return!1;const ne=Ll(S,D==null?void 0:D.latestRevisions),re=(D==null?void 0:D.clientIdentity)||Th(16);qi(l);const W=yield u0(S,O,D,j,r,p,o,re,v),{done:le,newSyncState:ce}=yield r.transaction("rw",r.tables,(te=>Te(this,void 0,void 0,(function*(){te.idbtrans.disableChangeTracking=!0,te.idbtrans.disableAccessControl=!0;for(const G of Object.keys(o))W.schema[G]&&(o[G]=W.schema[G]);yield r.$syncState.put(o,"schema");const $=yield Ml(b,r,{since:ne});for(const G of b){const U=jh(G.name);if($.some((Y=>Y.table===U&&Y.muts.length>0))){if(ne[U]){const Y=ne[U]||0;yield Promise.all([G.where("rev").belowOrEqual(Y).delete(),r.$baseRevs.where(":id").between([U,-1/0],[U,Y+1],!0,!0).reverse().offset(1).delete()])}}else yield Promise.all([G.clear(),r.$baseRevs.where({tableName:U}).delete()])}Ll($,ne),yield Vh(r,o,ne,W.serverRevision);const se=yield r.getPersistedSyncState();yield(function(G,U,Y){return Te(this,void 0,void 0,(function*(){const ve=new Set,Ee=new Set,Me=Y?Y.realms:[],ye=Y?Y.inviteRealms:[],ke=new Set(U.realms),oe=new Set(U.realms.concat(U.inviteRealms));for(const Pe of Me)ke.has(Pe)||(Ee.add(Pe),oe.has(Pe)||ve.add(Pe));for(const Pe of ye.concat(Me))oe.has(Pe)||ve.add(Pe);if(ve.size>0||Ee.size>0){const Pe=cs(G);for(const Be of Pe){let Se=["realms","members","roles"].includes(Be.name)?ve:Ee;Se.size!==0&&(Be.schema.indexes.some((Ne=>Ne.keyPath==="realmId"||Array.isArray(Ne.keyPath)&&Ne.keyPath[0]==="realmId"))?yield Be.where("realmId").anyOf([...Se]).delete():yield Be.filter((Ne=>!!(Ne!=null&&Ne.realmId)&&Se.has(Ne.realmId))).delete())}}if(Ee.size>0&&(Y!=null&&Y.yDownloadedRealms))for(const Pe of Ee)delete Y.yDownloadedRealms[Pe]}))})(r,W,se);const ge=se||{syncedTables:[],latestRevisions:{},realms:[],inviteRealms:[],clientIdentity:re};x&&(ge.syncedTables=y.map((G=>G.name)).concat(I.map((G=>G.name)))),ge.latestRevisions=ne,ge.remoteDbId=W.dbId,ge.initiallySynced=!0,ge.realms=W.realms,ge.inviteRealms=W.inviteRealms,ge.serverRevision=W.serverRevision,ge.yServerRevision=W.serverRevision,ge.timestamp=new Date,delete ge.error;const _e=Qh(W.changes,$);if(yield zh(_e,r),W.yMessages){const{receivedUntils:G,resyncNeeded:U,yServerRevision:Y}=yield Yh(W.yMessages,r);Y&&(ge.yServerRevision=Y),yield(function(ve,Ee,Me){return Te(this,void 0,void 0,(function*(){var ye,ke,oe,Pe,Be;const Se={};for(const[Ue,Ve]of Object.entries(ve))(ye=Se[Ue])!==null&&ye!==void 0||(Se[Ue]={}),Se[Ue].unsentFrom=Ve+1;for(const[Ue,Ve]of Object.entries(Ee))(ke=Se[Ue])!==null&&ke!==void 0||(Se[Ue]={}),Se[Ue].receivedUntil=Ve;const Ne=Object.values(Me.dx._dbSchema).filter((Ue=>Ue.yProps)).map((Ue=>Ue.yProps.map((Ve=>Ve.updatesTable)))).flat();for(const Ue of Ne){const Ve=Se[Ue],mt=(oe=Ve==null?void 0:Ve.unsentFrom)!==null&&oe!==void 0?oe:1,kt=(Be=(Pe=Ve==null?void 0:Ve.receivedUntil)!==null&&Pe!==void 0?Pe:(yield Me.table(Ue).where("i").between(1,1/0).reverse().limit(1).primaryKeys())[0])!==null&&Be!==void 0?Be:0;yield Me.transaction("rw",Ue,(()=>Te(this,void 0,void 0,(function*(){const vt=yield Me.table(Ue).get(hr);vt?(vt.unsentFrom=Math.max(mt,vt.unsentFrom||1),vt.receivedUntil=Math.max(kt,vt.receivedUntil||0),yield Me.table(Ue).put(vt)):yield Me.table(Ue).add({i:hr,unsentFrom:mt,receivedUntil:kt})}))))}}))})(M,G,r),U&&(ge.yDownloadedRealms={})}return r.$syncState.put(ge,"syncState"),{done:$.length===0,newSyncState:ge}}))));if(!le)return yield Hh(r),yield Jh(r,i,o,{isInitialSync:a,cancelToken:l});const Ie=Object.values(o).some((te=>{var $;return($=te.yProps)===null||$===void 0?void 0:$.length})),De=!!W.yMessages;if(Ie&&De)try{yield v0(r,p,ce)}catch{}return r.syncCompleteEvent.next(),!1}))}function Qh(t,e){const n={};Zu(n,t);const r={};return Zu(r,e),(function(i,o){var a,l,u;for(const[d,f]of Object.entries(o))for(const[p,v]of Object.entries(f))switch(v.type){case"ups":{const y=(a=i[d])===null||a===void 0?void 0:a[p];if(y)switch(y.type){case"ups":case"upd":delete i[d][p]}}break;case"del":(l=i[d])===null||l===void 0||delete l[p];break;case"upd":{const y=(u=i[d])===null||u===void 0?void 0:u[p];if(y)switch(y.type){case"ups":for(const[b,k]of Object.entries(v.mod))Is(y.val,b,k);break;case"del":break;case"upd":for(const b of Object.keys(v.mod))delete y.mod[b]}break}}})(n,r),(function(i,o=""){o||(o=Th(16));const a={};for(const[u,d]of Object.entries(i))for(const[f,p]of Object.entries(d)){const v=a[u]||(a[u]={});(v[p.type]||(v[p.type]=[])).push(Object.assign({key:f},p))}const l=[];for(const[u,d]of Object.entries(a)){const f={table:u,muts:[]};for(const[p,v]of Object.entries(d))switch(p){case"ups":{const y={type:"upsert",keys:v.map((b=>b.key)),values:v.map((b=>b.val)),txid:o};f.muts.push(y);break}case"upd":{const y={type:"update",keys:v.map((b=>b.key)),changeSpecs:v.map((b=>b.mod)),txid:o};f.muts.push(y);break}case"del":{const y={type:"delete",keys:v.map((b=>b.key)),txid:o};f.muts.push(y);break}}l.push(f)}return l})(n)}const g0=10,y0=1e4,m0=1e3;function b0(t){const e=[],n=new _n(!0),r=new _n(null);let i=!1,o=new Array(g0).fill(0);return r.subscribe((()=>Te(this,void 0,void 0,(function*(){if(!i&&e.length>0){i=!0,o.shift(),o.push(Date.now()),n.next(!1);try{yield(function(){return Te(this,void 0,void 0,(function*(){for(var a,l,u,d,f,p;e.length>0;){const v=e.shift();try{yield Tr(t.cloud.syncState.pipe(fn((({phase:b})=>b==="in-sync"||b==="error"))));const y=t.cloud.persistedSyncState.value;if(!v)continue;switch(v.type){case"token-expired":const b=t.cloud.currentUser.value,k=yield Js(t.cloud.options.databaseUrl,b);yield t.table("$logins").update(b.userId,{accessToken:k.accessToken,accessTokenExpiration:k.accessTokenExpiration,claims:k.claims,license:k.license,data:k.data});break;case"realm-added":!((a=y==null?void 0:y.realms)===null||a===void 0)&&a.includes(v.realm)||!((l=y==null?void 0:y.inviteRealms)===null||l===void 0)&&l.includes(v.realm)||(yield t.cloud.sync({purpose:"pull",wait:!0}));break;case"realm-accepted":!((u=y==null?void 0:y.realms)===null||u===void 0)&&u.includes(v.realm)||(yield t.cloud.sync({purpose:"pull",wait:!0}));break;case"realm-removed":(!((d=y==null?void 0:y.realms)===null||d===void 0)&&d.includes(v.realm)||!((f=y==null?void 0:y.inviteRealms)===null||f===void 0)&&f.includes(v.realm))&&(yield t.cloud.sync({purpose:"pull",wait:!0}));break;case"realms-changed":yield t.cloud.sync({purpose:"pull",wait:!0});break;case"changes":if(((p=t.cloud.syncState.value)===null||p===void 0?void 0:p.phase)==="error"){Vn(t,"pull");break}yield t.transaction("rw",t.dx.tables,(x=>Te(this,void 0,void 0,(function*(){x.idbtrans.disableChangeTracking=!0,x.idbtrans.disableAccessControl=!0;const[I,E,S]=yield Promise.all([t.getSchema(),t.getPersistedSyncState(),t.getCurrentUser()]);if(!E||!I||!S)return;if(v.baseRev!==E.serverRevision)return void(typeof v.baseRev!="string"||typeof E.serverRevision!="bigint"&&typeof E.serverRevision!="object"||Vn(t,"pull"));if((yield rt.waitFor(Ol(E)))!==v.realmSetHash)return void Vn(t,"pull");let D=[];if(S.isLoggedIn){const j=cs(t).map((O=>t.table(hc(O.name))));D=yield Ml(j,t)}if(v.changes.length>0){const j=Qh(v.changes,D);yield zh(j,t)}E.latestRevisions=Ll(D,E.latestRevisions),E.serverRevision=v.newRev,yield Vh(t,I,E.latestRevisions,v.newRev),yield t.$syncState.put(E,"syncState")}))))}}catch{}}}))})()}finally{o[o.length-1]-o[0]<y0&&(yield new Promise((a=>setTimeout(a,m0)))),i=!1,n.next(!0)}}})))),{enqueue:function(a){e.push(a),r.next(null)},readyToServe:n}}const af=new WeakMap,Zo={members:"@id, [userId+realmId], [email+realmId], realmId",roles:"[realmId+name]",realms:"@realmId",$jobs:"",$syncState:"",$baseRevs:"[tableName+clientRev]",$logins:"claims.sub, lastLogin"};let w0=0;function qn(t){"vip"in t&&(t=t.vip);let e=af.get(t.cloud);if(!e){const n=new jr;let r=new Xo(`syncstatechanged-${t.name}`),i=new Xo(`synccomplete-${t.name}`);n.id=++w0;let o=!1;e={get name(){return t.name},close:()=>t.close(),transaction:t.transaction.bind(t),table:t.table.bind(t),get tables(){return t.tables},cloud:t.cloud,get $jobs(){return t.table("$jobs")},get $syncState(){return t.table("$syncState")},get $baseRevs(){return t.table("$baseRevs")},get $logins(){return t.table("$logins")},get realms(){return t.realms},get members(){return t.members},get roles(){return t.roles},get initiallySynced(){return o},localSyncEvent:n,get syncStateChangedEvent(){return r},get syncCompleteEvent(){return i},dx:t},Object.assign(e,{getCurrentUser:()=>e.$logins.toArray().then((l=>l.find((u=>u.isLoggedIn))||Zt)),getPersistedSyncState:()=>e.$syncState.get("syncState"),getSchema:()=>e.$syncState.get("schema").then((l=>{if(l)for(const d of e.tables)d.schema.primKey&&d.schema.primKey.keyPath&&l[d.name]&&(l[d.name].primaryKey=typeof(u=d.schema.primKey.keyPath)=="string"?u:u?"["+[].join.call(u,"+")+"]":"");var u;return l})),getOptions:()=>e.$syncState.get("options"),setInitiallySynced(l){o=l},reconfigure(){r=new Xo(`syncstatechanged-${t.name}`),i=new Xo(`synccomplete-${t.name}`)}}),e.messageConsumer=b0(e),e.messageProducer=new jr,af.set(t.cloud,e)}return e}const _0=typeof InstallTrigger<"u",Xh=typeof navigator<"u"&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\/|Edge\//.test(navigator.userAgent),k0=Xh?[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]:NaN,S0=Xh&&k0<=605||_0,x0=typeof self<"u"&&"clients"in self&&!self.document,{toString:E0}={};function lf(t){return E0.call(t).slice(8,-1)}function tl(t,e){var n;return e.type==="delete"?e.keys:((n=e.keys)===null||n===void 0?void 0:n.slice())||e.values.map(t.extractKey)}const C0=/b|c|d|f|g|h|j|k|l|m|n|p|q|r|s|t|v|x|y|z/i;let Hn=0;function Zh(t,e){const n=new Uint8Array(18),r=new Uint8Array(n.buffer,0,6),i=Date.now();Hn>=i?++Hn:Hn=i,r[0]=Hn/1099511627776,r[1]=Hn/4294967296,r[2]=Hn/16777216,r[3]=Hn/65536,r[4]=Hn/256,r[5]=Hn;const o=new Uint8Array(n.buffer,6);return crypto.getRandomValues(o),t+Uh(new Uint8Array(n.buffer))+(e||"")}function I0(t){return{stack:"dbcore",name:"idGenerationMiddleware",level:1,create:e=>Object.assign(Object.assign({},e),{table:n=>{const r=e.table(n);return Object.assign(Object.assign({},r),{mutate:i=>{var o,a;const l=i.trans;if(l.mode==="versionchange"&&(l.disableChangeTracking=!0,l.disableAccessControl=!0),l.disableChangeTracking)return r.mutate(i);if(i.type==="add"||i.type==="put"){const u=(o=t.cloud.schema)===null||o===void 0?void 0:o[n];if(u!=null&&u.generatedGlobalId){if(!((a=t.cloud.options)===null||a===void 0)&&a.databaseUrl&&!t.initiallySynced){const d=tl(r.schema.primaryKey,i);return r.getMany({keys:d,trans:i.trans,cache:"immutable"}).then((f=>{if(f.length<d.length)throw new Error("Unable to create new objects without an initial sync having been performed.");return r.mutate(i)}))}return(function(d,f){let p=null;const v=tl(r.schema.primaryKey,d);return v.forEach(((y,b)=>{if(y===void 0){const k=d.values[b].realmId||t.cloud.currentUserId,x=k.substr(k.length-3);v[b]=Zh(f,x),r.schema.primaryKey.outbound||(p||(p=d.values.slice()),p[b]=rt.deepClone(p[b]),rt.setByKeyPath(p[b],r.schema.primaryKey.keyPath,v[b]))}else if(typeof y!="string"||!y.startsWith(f)&&!y.startsWith("#"+f))throw new rt.ConstraintError(`The ID "${y}" is not valid for table "${n}". Primary '@' keys requires the key to be prefixed with "${f}" (or "#${f}).
If you want to generate IDs programmatically, remove '@' from the schema to get rid of this constraint. Dexie Cloud supports custom IDs as long as they are random and globally unique.`)})),r.mutate(Object.assign(Object.assign({},d),{keys:v,values:p||d.values}))})(i,u.idPrefix)}u!=null&&u.markedForSync&&tl(r.schema.primaryKey,i).forEach(((d,f)=>{if(!uc(d)){const p=Array.isArray(d)?d.map(lf).join(","):lf(d);throw new rt.ConstraintError(`Invalid primary key type ${p} for table ${n}. Tables marked for sync has primary keys of type string or Array of string (and optional numbers)`)}}))}return r.mutate(i)}})}})}}let D0=0;function Hi(t,e){return function(n){const{readers:r,writers:i}=n.trans[e]||(n.trans[e]={writers:[],readers:[]}),o=i.length,a=(o>0?i[o-1].then((()=>t(n)),(()=>t(n))):t(n)).finally((()=>{r.splice(r.indexOf(a))}));return r.push(a),a}}function T0(t,e){return function(n){const{readers:r,writers:i}=n.trans[e]||(n.trans[e]={writers:[],readers:[]});let o=(i.length>0?i[i.length-1].then((()=>t(n)),(()=>t(n))):r.length>0?(a=r,new Promise((l=>{a.length===0&&l([]);let u=a.length;const d=new Array(u);a.forEach(((f,p)=>Promise.resolve(f).then((v=>d[p]={status:"fulfilled",value:v}),(v=>d[p]={status:"rejected",reason:v})).then((()=>--u||l(d)))))}))).then((()=>t(n))):t(n)).finally((()=>{i.shift()}));var a;return i.push(o),o}}const Wr=new _n(new Set);function po(t){var e,n,r,i;return((e=t.cloud.options)===null||e===void 0?void 0:e.disableEagerSync)||((r=(n=t.cloud.currentUser.value)===null||n===void 0?void 0:n.license)===null||r===void 0?void 0:r.status)!=="ok"||!(!((i=t.cloud.options)===null||i===void 0)&&i.databaseUrl)}function A0({currentUserObservable:t,db:e}){return{stack:"dbcore",name:"MutationTrackingMiddleware",level:1,create:n=>{const r=new Set(n.schema.tables.map((a=>a.name))),i=n.schema.tables.filter((a=>!/^\$/.test(a.name))),o=new Map;for(const a of i){const l=`$${a.name}_mutations`;r.has(l)&&o.set(a.name,n.table(l))}return Object.assign(Object.assign({},n),{transaction:(a,l)=>{let u;if(l==="readwrite"){const d=a.filter((f=>{var p,v;return(v=(p=e.cloud.schema)===null||p===void 0?void 0:p[f])===null||v===void 0?void 0:v.markedForSync})).map((f=>hc(f)));u=n.transaction([...a,...d],l)}else u=n.transaction(a,l);if(l==="readwrite"){u.txid=Lh(16),u.opCount=0,u.currentUser=t.value,Wr.value.add(u),Wr.next(Wr.value);const d=()=>{u.removeEventListener("complete",f),u.removeEventListener("error",d),u.removeEventListener("abort",d),Wr.value.delete(u),Wr.next(Wr.value)},f=()=>{u.mutationsAdded&&!po(e)&&Vn(e,"push"),d()};u.addEventListener("complete",f),u.addEventListener("error",d),u.addEventListener("abort",d)}return u},table:a=>{const l=n.table(a);if(/^\$/.test(a))return a.endsWith("_mutations")?Object.assign(Object.assign({},l),{mutate:p=>(p.type!=="add"&&p.type!=="put"||(p.trans.mutationsAdded=!0),l.mutate(p))}):a==="$logins"?Object.assign(Object.assign({},l),{mutate:p=>l.mutate(p).then((v=>(p.trans.mutationsAdded=!0,v))).catch((v=>Promise.reject(v)))}):l;const{schema:u}=l,d=o.get(a);return d?(function(p){const v="$lock"+ ++D0;return Object.assign(Object.assign({},p),{count:Hi(p.count,v),get:Hi(p.get,v),getMany:Hi(p.getMany,v),openCursor:Hi(p.openCursor,v),query:Hi(p.query,v),mutate:T0(p.mutate,v)})})(Object.assign(Object.assign({},l),{mutate:p=>{var v,y,b;const k=p.trans;return k.txid?k.disableChangeTracking?l.mutate(p):!((y=(v=e.cloud.schema)===null||v===void 0?void 0:v[a])===null||y===void 0)&&y.markedForSync&&(!((b=k.currentUser)===null||b===void 0)&&b.isLoggedIn)?p.type==="deleteRange"?l.query({query:{range:p.range,index:u.primaryKey},trans:p.trans,values:!1}).then((x=>f({type:"delete",keys:x.result,trans:p.trans,criteria:{index:null,range:p.range}}))):f(p):l.mutate(p):l.mutate(p)}})):l;function f(p){var v,y;const b=p.trans,k=(y=(v=e.cloud.options)===null||v===void 0?void 0:v.unsyncedProperties)===null||y===void 0?void 0:y[a],{txid:x,currentUser:{userId:I}}=b,{type:E}=p,S=++b.opCount;function D(j){if(!k)return j;let O=j;for(const M of Object.keys(j))k.some((ie=>M===ie||M.startsWith(ie+".")))&&(O===j&&(O=Object.assign({},j)),delete O[M]);return O}return l.mutate(p).then((j=>{var O;const{numFailures:M,failures:ie}=j;let ne=E==="delete"?p.keys:j.results,re="values"in p?p.values:[],W="changeSpec"in p?p.changeSpec:void 0,le="updates"in p?p.updates:void 0;if(M&&(ne=ne.filter(((te,$)=>!ie[$])),re=re.filter(((te,$)=>!ie[$]))),k){if(re=re.map((te=>{const $=Object.assign({},te);for(const se of k)delete $[se];return $})),W&&(W=D(W),Object.keys(W).length===0))return j;if(le){let te=le.changeSpecs.map(D),$={keys:[],changeSpecs:[]};const se=new sg;let ge=!1;for(let _e=0,G=te.length;_e<G;++_e)Object.keys(te[_e]).length>0?($.keys.push(le.keys[_e]),$.changeSpecs.push(te[_e]),se.addKey(le.keys[_e])):ge=!0;if(le=$,ge){let _e=[],G=[];for(let U=0,Y=ne.length;U<Y;++U)se.hasKey(ne[U])&&(_e.push(ne[U]),G.push(re[U]));ne=_e,re=G}}}const ce=Date.now();let Ie="criteria"in p&&p.criteria?Object.assign(Object.assign({},p.criteria),{index:p.criteria.index===u.primaryKey.keyPath?null:p.criteria.index}):void 0;if(k&&(Ie!=null&&Ie.index)){const te=(O=u.indexes.find(($=>$.name===Ie.index)))===null||O===void 0?void 0:O.keyPath;(te?typeof te=="string"?[te]:te:[]).some(($=>k==null?void 0:k.includes($)))&&(Ie=void 0)}const De=p.type==="delete"?{type:"delete",ts:ce,opNo:S,keys:ne,criteria:Ie,txid:x,userId:I}:p.type==="add"?{type:"insert",ts:ce,opNo:S,keys:ne,txid:x,userId:I,values:re}:Ie&&W?{type:"modify",ts:ce,opNo:S,keys:ne,criteria:Ie,changeSpec:W,txid:x,userId:I}:W?{type:"update",ts:ce,opNo:S,keys:ne,changeSpecs:ne.map((()=>W)),txid:x,userId:I}:le?{type:"update",ts:ce,opNo:S,keys:le.keys,changeSpecs:le.changeSpecs,txid:x,userId:I}:{type:"upsert",ts:ce,opNo:S,keys:ne,values:re,txid:x,userId:I};return"isAdditionalChunk"in p&&p.isAdditionalChunk&&(De.isAdditionalChunk=!0),ne.length>0||Ie?d.mutate({type:"add",trans:b,values:[De]}).then((()=>(b.mutationsAdded=!0,j))):j}))}}})}}}function O0(t,e){return function(n,r){var i;const o=Object.assign(Object.assign({},Zo),n);Object.keys(Zo).forEach((d=>{const f=o[d];if(f==null)throw new Error(`Cannot delete table ${d} as it is needed for access control of Dexie Cloud`);if(!n[d])return;const p=f.split(",").map((b=>b.trim())),v=Zo[d].split(",").map((b=>b.trim())),y=new Set(p.map((b=>b.replace(/([&*]|\+\+)/g,""))));if(p[0]!==v[0])throw new Error(`Cannot override primary key of table ${d}. Please declare it as {${d}: ${JSON.stringify(Zo[d])}`);for(let b=1;b<v.length;++b){const k=v[b];y.has(k.replace(/([&*]|\+\+)/g,""))||(o[d]+=`,${k}`)}}));const a=e.cloud.schema||(e.cloud.schema={}),l=new Set;Object.keys(o).forEach((d=>{const f=o[d],p=a[d]||(a[d]={});f!=null?(/^\@/.test(f)&&(o[d]=o[d].substr(1),p.generatedGlobalId=!0,p.idPrefix=(function(v,y){let b=v[0].toLocaleLowerCase();for(let E=1,S=v.length;E<S&&b.length<3;++E)(C0.test(v[E])||(k=v[E])>="A"&&k<="Z")&&(b+=v[E].toLowerCase());for(var k,x,I;y.has(b);){if(/\d/g.test(b)){if(b=b.substr(0,b.length-1)+(b[b.length-1]+1),!(b.length>3))continue;b=b.substr(0,3)}else if(b.length<3){b+="2";continue}let E=1,S=b;for(;y.has(S)&&E<8;)x=b,S=(1&(I=E)?x[0].toUpperCase():x[0].toLowerCase())+(2&I?x[1].toUpperCase():x[1].toLowerCase())+(4&I?x[2].toUpperCase():x[2].toLowerCase()),++E;if(E<8)b=S;else{let D=b.charCodeAt(2)+1&127;b=b.substr(0,2)+String.fromCharCode(D)}}return b})(d,l),l.add(p.idPrefix)),/^\$/.test(d)||(o[`$${d}_mutations`]="++rev",p.markedForSync=!0),p.deleted&&(p.deleted=!1)):(p.deleted=!0,p.markedForSync=!1,o[`$${d}_mutations`]=null)}));const u=t.call(this,o,r);for(const[d,f]of Object.entries(r))if(!((i=f.yProps)===null||i===void 0)&&i.length){const p=a[d];p&&(p.yProps=f.yProps.map((v=>v.prop)))}return u}}function $h(t,e,n){return typeof navigator<"u"&&navigator.locks?navigator.locks.request(t.name+"|"+e,(()=>n())):n()}const $i=new _n(!0),Rl=new _n(!0);$i.pipe(Vt((t=>t?Wn(!0):Wn(!1).pipe(Td(2e4)))),Ad()).subscribe(Rl);const ep=typeof document<"u"?An(document,"visibilitychange"):Wn({}),M0=ep.pipe(fn((()=>document.visibilityState==="hidden"))),P0=ep.pipe(fn((()=>document.visibilityState==="visible"))),tp=typeof window<"u"?qs(P0,An(window,"mousedown"),An(window,"mousemove"),An(window,"keydown"),An(window,"wheel"),An(window,"touchmove")):Wn({});typeof document<"u"&&qs(Wn(!0),M0,tp).pipe(tn((()=>document.visibilityState==="visible")),yl((t=>{$i.value!==t&&$i.next(t)})),Vt((t=>t?Wn(0).pipe(Td(16e4),yl((()=>$i.next(!1)))):Wn(0)))).subscribe((()=>{}));class j0 extends Error{constructor(){super(...arguments),this.name="TokenExpiredError"}}const np=new WeakMap,cf=new WeakMap;function rp(t){let e=cf.get(t);return e||(e=new jr,cf.set(t,e)),e}class L0 extends At{constructor(e,n,r,i,o,a,l,u){super((d=>new U0(e,n,r,i,o,u,d,a,l)))}}let R0=0;class U0 extends gi{constructor(e,n,r,i,o,a,l,u,d){super((()=>this.teardown())),this.id=++R0,this.subscriptions=new Set,this.reconnecting=!1,this.db=e,this.databaseUrl=e.cloud.options.databaseUrl,this.rev=n,this.yrev=r,this.realmSetHash=i,this.clientIdentity=o,this.user=a,this.subscriber=l,this.lastUserActivity=new Date,this.messageProducer=u,this.webSocketStatus=d,this.connect()}teardown(){this.disconnect()}disconnect(){if(this.webSocketStatus.next("disconnected"),this.pinger&&(clearInterval(this.pinger),this.pinger=null),this.ws)try{this.ws.close()}catch{}this.ws=null;for(const e of this.subscriptions)e.unsubscribe();this.subscriptions.clear()}reconnect(){if(!this.reconnecting){this.reconnecting=!0;try{this.disconnect()}catch{}this.connect().catch((()=>{})).then((()=>this.reconnecting=!1))}}connect(){return Te(this,void 0,void 0,(function*(){if(this.lastServerActivity=new Date,this.pauseUntil&&this.pauseUntil>new Date)return;if(this.ws)throw new Error("Called connect() when a connection is already open");if(!this.databaseUrl)throw new Error("Cannot connect without a database URL");if(this.closed)return;const e=this.user.accessTokenExpiration;if(e&&e<new Date)return void this.subscriber.error(new j0);this.webSocketStatus.next("connecting"),this.pinger=setInterval((()=>Te(this,void 0,void 0,(function*(){if(this.closed)this.teardown();else if(this.ws)try{this.ws.send(JSON.stringify({type:"ping"})),setTimeout((()=>{this.pinger&&(this.closed?this.teardown():this.lastServerActivity<new Date(Date.now()-2e4)&&this.reconnect())}),2e4)}catch{this.reconnect()}else this.reconnect()}))),3e4);const n=new URL(this.databaseUrl);n.protocol=n.protocol==="http:"?"ws":"wss";const r=new URLSearchParams;if(this.subscriber.closed)return;r.set("v","2"),this.rev&&r.set("rev",this.rev),this.yrev&&r.set("yrev",this.yrev),r.set("realmsHash",this.realmSetHash),r.set("clientId",this.clientIdentity),r.set("dxcv",this.db.cloud.version),this.user.accessToken&&r.set("token",this.user.accessToken);const i=this.ws=new WebSocket(`${n}/changes?${r}`);i.binaryType="arraybuffer",i.onclose=o=>{this.pinger&&this.reconnect()},i.onmessage=o=>{if(this.pinger){this.lastServerActivity=new Date;try{const a=typeof o.data=="string"?ho.parse(o.data):(function(l){const u=new vi(l),d=hn(u);if(d==="outdated-server-rev")return{type:d};if(d==="y-complete-sync-done")return{type:d,yServerRev:hn(u)};const f=hn(u),p=hn(u);switch(d){case"u-ack":case"u-reject":return{type:d,table:f,prop:p,i:Number(wu(u))};default:{const v=fr(u);switch(d){case"in-sync":case"doc-close":return{type:d,table:f,prop:p,k:v};case"aware":return{type:d,table:f,prop:p,k:v,u:Rt(u)};case"doc-open":return{type:d,table:f,prop:p,k:v,serverRev:fr(u),sv:fr(u)};case"sv":return{type:d,table:f,prop:p,k:v,sv:Rt(u)};case"u-c":return{type:d,table:f,prop:p,k:v,u:Rt(u),i:Number(wu(u))};case"u-s":return{type:d,table:f,prop:p,k:v,u:Rt(u),r:u.pos<u.arr.length&&hn(u)||void 0};default:throw new TypeError(`Unknown message type: ${d}`)}}}})(new Uint8Array(o.data));if(a.type==="error")throw new Error(`Error message from dexie-cloud: ${a.error}`);if(a.type==="aware"){const l=zt.getDocCache(this.db.dx).find(a.table,a.k,a.prop);if(l){const u=(d=>np.get(d))(l);u&&Rb(u,a.u,"server")}}else if(a.type!=="pong")if(a.type==="doc-open"){const l=zt.getDocCache(this.db.dx).find(a.table,a.k,a.prop);l&&rp(l).next()}else a.type==="u-ack"||a.type==="u-reject"||a.type==="u-s"||a.type==="in-sync"||a.type==="outdated-server-rev"||a.type==="y-complete-sync-done"?Yh([a],this.db).then((l=>Te(this,[l],void 0,(function*({resyncNeeded:u,yServerRevision:d,receivedUntils:f}){if(d&&(yield this.db.$syncState.update("syncState",{yServerRevision:d})),a.type==="u-s"&&f){const p=Zi(this.db,a.table,a.prop);if(p){const v=f[p.name];v&&(yield p.update(hr,{receivedUntil:v}))}}u&&(yield this.db.cloud.sync({purpose:"pull",wait:!0}))})))):this.subscriber.next(a)}catch(a){this.subscriber.error(a)}}};try{let o=!1;yield new Promise(((a,l)=>{i.onopen=u=>{o=!0,a(null)},i.onerror=u=>{if(o)this.reconnect();else{const d=u.error||new Error("WebSocket Error");this.subscriber.error(d),this.webSocketStatus.next("error"),l(d)}}})),this.subscriptions.add(this.messageProducer.subscribe((a=>{var l,u;this.closed||(a.type==="ready"&&this.webSocketStatus.value!=="connected"&&this.webSocketStatus.next("connected"),a.type==="ready"?(this.rev=a.rev,(l=this.ws)===null||l===void 0||l.send(ho.stringify(a))):(u=this.ws)===null||u===void 0||u.send((function(d){const f=new hi;switch(dn(f,d.type),"table"in d&&dn(f,d.table),"prop"in d&&dn(f,d.prop),d.type){case"u-ack":case"u-reject":vu(f,BigInt(d.i));break;case"outdated-server-rev":break;case"y-complete-sync-done":dn(f,d.yServerRev);break;default:switch(ur(f,d.k),d.type){case"aware":Lt(f,d.u);break;case"doc-open":ur(f,d.serverRev),ur(f,d.sv);break;case"doc-close":break;case"sv":Lt(f,d.sv);break;case"u-c":Lt(f,d.u),vu(f,BigInt(d.i));break;case"u-s":Lt(f,d.u),dn(f,d.r||"")}}return nn(f)})(a)))}))),this.user.isLoggedIn&&!po(this.db)&&this.subscriptions.add((function(a){const l=pc(a.tables.filter((u=>{var d,f;return((f=(d=a.cloud.schema)===null||d===void 0?void 0:d[u.name])===null||f===void 0?void 0:f.markedForSync)&&u.schema.yProps})).map((u=>u.schema.yProps.map((d=>({table:u.name,ydocProp:d.prop,updatesTable:d.updatesTable}))))));return qs(...l.map((({table:u,ydocProp:d,updatesTable:f})=>{const p=a.table(f);return on(p.get(hr)).pipe(Vt((v=>{let y=(v==null?void 0:v.unsentFrom)||1;return on(cr((()=>Te(this,void 0,void 0,(function*(){return(yield Wh(p,y)).filter((b=>b.f&&1&b.f)).map((b=>({type:"u-c",table:u,prop:d,k:b.k,u:b.u,i:b.i})))}))))).pipe(yl((b=>{b.length>0&&(y=b.at(-1).i+1)})))})))}))).pipe(_o((u=>u)))})(this.db).subscribe(this.db.messageProducer))}catch{this.pauseUntil=new Date(Date.now()+6e4)}}))}}class N0 extends Error{constructor(e){super(e==="expired"?"License expired":e==="deactivated"?"User deactivated":"Invalid license"),this.name="InvalidLicenseError",e&&(this.license=e)}}function F0(t){return Te(this,void 0,void 0,(function*(){var e;yield(e=3e3,new Promise((n=>setTimeout(n,e)))),yield Tr(tp)}))}function uf(t){return Te(this,void 0,void 0,(function*(){var e;return!(!(!((e=t.cloud.options)===null||e===void 0)&&e.databaseUrl)||!t.cloud.schema)&&(yield Qs(t,t.cloud.options,t.cloud.schema,{justCheckIfNeeded:!0}))}))}const $o=new WeakMap;function ip(t,e,n,r){const i=$o.get(t);if(i){if(i.pull||(r==null?void 0:r.purpose)==="push")return i.promise;{let a=!1;const l=t.cloud.syncState.subscribe((u=>{u.phase==="pulling"&&(a=!0)}));return i.promise.then((()=>{l.unsubscribe()})).catch((u=>(l.unsubscribe(),Promise.reject(u)))).then((()=>{if(!a)return ip(t,e,n,r)}))}}const o=(function(){return Te(this,void 0,void 0,(function*(){try{yield Hh(t),yield $h(t,Gh,(()=>Qs(t,e,n,r))),$o.delete(t)}catch(a){throw $o.delete(t),a}}))})();return $o.set(t,{promise:o,pull:(r==null?void 0:r.purpose)!=="push"}),o}const B0=1e3;function K0(t,e,n){let r=null,i={cancelled:!1},o=0,a=0;function l(v=1){setTimeout((()=>{const y=u?"pull":"push";a=Date.now(),ip(t,e,n,{cancelToken:i,retryImmediatelyOnFetchError:!0,purpose:y}).then((()=>{if(i.cancelled)p();else if(u||d)return u=!1,d=!1,l();f=!1,o=0,a=0})).catch((b=>{if(i.cancelled)p(),f=!1,o=0,a=0;else if(v<5){const k=[0,20,40,300,900][v]*B0;o=Date.now()+k,a=0,setTimeout((()=>l(v+1)),k)}else f=!1,o=0,a=0}))}),0)}let u=!1,d=!1,f=!1;const p=()=>{i.cancelled=!0,r&&r.unsubscribe()};return{start:()=>{r=t.localSyncEvent.subscribe((({purpose:v})=>{(y=>{i.cancelled||(y==="pull"&&(u=!0),y==="push"&&(d=!0),f?o||a>0&&Date.now():(f=!0,l()))})(v||"pull")}))},stop:p}}function nl(t,e){if(t&&e&&e.unsyncedTables)for(const n of e.unsyncedTables)t[n]&&(t[n].markedForSync=!1)}var Xs,Qe,op,eo,ff,Ds={},sp=[],q0=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function lr(t,e){for(var n in e)t[n]=e[n];return t}function ap(t){var e=t.parentNode;e&&e.removeChild(t)}function It(t,e,n){var r,i,o,a={};for(o in e)o=="key"?r=e[o]:o=="ref"?i=e[o]:a[o]=e[o];if(arguments.length>2&&(a.children=arguments.length>3?Xs.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)a[o]===void 0&&(a[o]=t.defaultProps[o]);return us(t,a,r,i,null)}function us(t,e,n,r,i){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++op};return i==null&&Qe.vnode!=null&&Qe.vnode(o),o}function ci(t){return t.children}function to(t,e){this.props=t,this.context=e}function ui(t,e){if(e==null)return t.__?ui(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?ui(t):null}function lp(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return lp(t)}}function df(t){(!t.__d&&(t.__d=!0)&&eo.push(t)&&!Ts.__r++||ff!==Qe.debounceRendering)&&((ff=Qe.debounceRendering)||setTimeout)(Ts)}function Ts(){for(var t;Ts.__r=eo.length;)t=eo.sort((function(e,n){return e.__v.__b-n.__v.__b})),eo=[],t.some((function(e){var n,r,i,o,a,l;e.__d&&(a=(o=(n=e).__v).__e,(l=n.__P)&&(r=[],(i=lr({},o)).__v=o.__v+1,vc(l,o,i,n.__n,l.ownerSVGElement!==void 0,o.__h!=null?[a]:null,r,a??ui(o),o.__h),dp(r,o),o.__e!=a&&lp(o)))}))}function cp(t,e,n,r,i,o,a,l,u,d){var f,p,v,y,b,k,x,I=r&&r.__k||sp,E=I.length;for(n.__k=[],f=0;f<e.length;f++)if((y=n.__k[f]=(y=e[f])==null||typeof y=="boolean"?null:typeof y=="string"||typeof y=="number"||typeof y=="bigint"?us(null,y,null,null,y):Array.isArray(y)?us(ci,{children:y},null,null,null):y.__b>0?us(y.type,y.props,y.key,null,y.__v):y)!=null){if(y.__=n,y.__b=n.__b+1,(v=I[f])===null||v&&y.key==v.key&&y.type===v.type)I[f]=void 0;else for(p=0;p<E;p++){if((v=I[p])&&y.key==v.key&&y.type===v.type){I[p]=void 0;break}v=null}vc(t,y,v=v||Ds,i,o,a,l,u,d),b=y.__e,(p=y.ref)&&v.ref!=p&&(x||(x=[]),v.ref&&x.push(v.ref,null,y),x.push(p,y.__c||b,y)),b!=null?(k==null&&(k=b),typeof y.type=="function"&&y.__k===v.__k?y.__d=u=up(y,u,t):u=fp(t,y,v,I,b,u),typeof n.type=="function"&&(n.__d=u)):u&&v.__e==u&&u.parentNode!=t&&(u=ui(v))}for(n.__e=k,f=E;f--;)I[f]!=null&&(typeof n.type=="function"&&I[f].__e!=null&&I[f].__e==n.__d&&(n.__d=ui(r,f+1)),pp(I[f],I[f]));if(x)for(f=0;f<x.length;f++)hp(x[f],x[++f],x[++f])}function up(t,e,n){for(var r,i=t.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=t,e=typeof r.type=="function"?up(r,e,n):fp(n,r,r,i,r.__e,e));return e}function fp(t,e,n,r,i,o){var a,l,u;if(e.__d!==void 0)a=e.__d,e.__d=void 0;else if(n==null||i!=o||i.parentNode==null)e:if(o==null||o.parentNode!==t)t.appendChild(i),a=null;else{for(l=o,u=0;(l=l.nextSibling)&&u<r.length;u+=2)if(l==i)break e;t.insertBefore(i,o),a=o}return a!==void 0?a:i.nextSibling}function hf(t,e,n){e[0]==="-"?t.setProperty(e,n):t[e]=n==null?"":typeof n!="number"||q0.test(e)?n:n+"px"}function es(t,e,n,r,i){var o;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||hf(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||hf(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r||t.addEventListener(e,o?vf:pf,o):t.removeEventListener(e,o?vf:pf,o);else if(e!=="dangerouslySetInnerHTML"){if(i)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||e[0]==="a"&&e[1]==="r")?t.setAttribute(e,n):t.removeAttribute(e))}}function pf(t){this.l[t.type+!1](Qe.event?Qe.event(t):t)}function vf(t){this.l[t.type+!0](Qe.event?Qe.event(t):t)}function vc(t,e,n,r,i,o,a,l,u){var d,f,p,v,y,b,k,x,I,E,S,D,j,O=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,l=e.__e=n.__e,e.__h=null,o=[l]),(d=Qe.__b)&&d(e);try{e:if(typeof O=="function"){if(x=e.props,I=(d=O.contextType)&&r[d.__c],E=d?I?I.props.value:d.__:r,n.__c?k=(f=e.__c=n.__c).__=f.__E:("prototype"in O&&O.prototype.render?e.__c=f=new O(x,E):(e.__c=f=new to(x,E),f.constructor=O,f.render=V0),I&&I.sub(f),f.props=x,f.state||(f.state={}),f.context=E,f.__n=r,p=f.__d=!0,f.__h=[]),f.__s==null&&(f.__s=f.state),O.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=lr({},f.__s)),lr(f.__s,O.getDerivedStateFromProps(x,f.__s))),v=f.props,y=f.state,p)O.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(O.getDerivedStateFromProps==null&&x!==v&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(x,E),!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(x,f.__s,E)===!1||e.__v===n.__v){f.props=x,f.state=f.__s,e.__v!==n.__v&&(f.__d=!1),f.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach((function(M){M&&(M.__=e)})),f.__h.length&&a.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(x,f.__s,E),f.componentDidUpdate!=null&&f.__h.push((function(){f.componentDidUpdate(v,y,b)}))}if(f.context=E,f.props=x,f.__v=e,f.__P=t,S=Qe.__r,D=0,"prototype"in O&&O.prototype.render)f.state=f.__s,f.__d=!1,S&&S(e),d=f.render(f.props,f.state,f.context);else do f.__d=!1,S&&S(e),d=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++D<25);f.state=f.__s,f.getChildContext!=null&&(r=lr(lr({},r),f.getChildContext())),p||f.getSnapshotBeforeUpdate==null||(b=f.getSnapshotBeforeUpdate(v,y)),j=d!=null&&d.type===ci&&d.key==null?d.props.children:d,cp(t,Array.isArray(j)?j:[j],e,n,r,i,o,a,l,u),f.base=e.__e,e.__h=null,f.__h.length&&a.push(f),k&&(f.__E=f.__=null),f.__e=!1}else o==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=H0(n.__e,e,n,r,i,o,a,u);(d=Qe.diffed)&&d(e)}catch(M){e.__v=null,(u||o!=null)&&(e.__e=l,e.__h=!!u,o[o.indexOf(l)]=null),Qe.__e(M,e,n)}}function dp(t,e){Qe.__c&&Qe.__c(e,t),t.some((function(n){try{t=n.__h,n.__h=[],t.some((function(r){r.call(n)}))}catch(r){Qe.__e(r,n.__v)}}))}function H0(t,e,n,r,i,o,a,l){var u,d,f,p=n.props,v=e.props,y=e.type,b=0;if(y==="svg"&&(i=!0),o!=null){for(;b<o.length;b++)if((u=o[b])&&"setAttribute"in u==!!y&&(y?u.localName===y:u.nodeType===3)){t=u,o[b]=null;break}}if(t==null){if(y===null)return document.createTextNode(v);t=i?document.createElementNS("http://www.w3.org/2000/svg",y):document.createElement(y,v.is&&v),o=null,l=!1}if(y===null)p===v||l&&t.data===v||(t.data=v);else{if(o=o&&Xs.call(t.childNodes),d=(p=n.props||Ds).dangerouslySetInnerHTML,f=v.dangerouslySetInnerHTML,!l){if(o!=null)for(p={},b=0;b<t.attributes.length;b++)p[t.attributes[b].name]=t.attributes[b].value;(f||d)&&(f&&(d&&f.__html==d.__html||f.__html===t.innerHTML)||(t.innerHTML=f&&f.__html||""))}if((function(k,x,I,E,S){var D;for(D in I)D==="children"||D==="key"||D in x||es(k,D,null,I[D],E);for(D in x)S&&typeof x[D]!="function"||D==="children"||D==="key"||D==="value"||D==="checked"||I[D]===x[D]||es(k,D,x[D],I[D],E)})(t,v,p,i,l),f)e.__k=[];else if(b=e.props.children,cp(t,Array.isArray(b)?b:[b],e,n,r,i&&y!=="foreignObject",o,a,o?o[0]:n.__k&&ui(n,0),l),o!=null)for(b=o.length;b--;)o[b]!=null&&ap(o[b]);l||("value"in v&&(b=v.value)!==void 0&&(b!==t.value||y==="progress"&&!b||y==="option"&&b!==p.value)&&es(t,"value",b,p.value,!1),"checked"in v&&(b=v.checked)!==void 0&&b!==t.checked&&es(t,"checked",b,p.checked,!1))}return t}function hp(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(r){Qe.__e(r,n)}}function pp(t,e,n){var r,i;if(Qe.unmount&&Qe.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||hp(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){Qe.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&pp(r[i],e,typeof t.type!="function");n||t.__e==null||ap(t.__e),t.__e=t.__d=void 0}function V0(t,e,n){return this.constructor(t,n)}function gf(t,e,n){var r,i,o;Qe.__&&Qe.__(t,e),i=(r=!1)?null:e.__k,o=[],vc(e,t=e.__k=It(ci,null,[t]),i||Ds,Ds,e.ownerSVGElement!==void 0,i?null:e.firstChild?Xs.call(e.childNodes):null,o,i?i.__e:e.firstChild,r),dp(o,t)}Xs=sp.slice,Qe={__e:function(t,e,n,r){for(var i,o,a;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,r||{}),a=i.__d),a)return i.__E=i}catch(l){t=l}throw t}},op=0,to.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=lr({},this.state),typeof t=="function"&&(t=t(lr({},n),this.props)),t&&lr(n,t),t!=null&&this.__v&&(e&&this.__h.push(e),df(this))},to.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),df(this))},to.prototype.render=ci,eo=[],Ts.__r=0;const Tn={Alert:{error:{color:"red",fontWeight:"bold"},warning:{color:"#f80",fontWeight:"bold"},info:{color:"black"}},Darken:{position:"fixed",top:0,left:0,opacity:.5,backgroundColor:"#000",width:"100vw",height:"100vh",zIndex:150,webkitBackdropFilter:"blur(2px)",backdropFilter:"blur(2px)"},DialogOuter:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:150,alignItems:"center",display:"flex",justifyContent:"center"},DialogInner:{position:"relative",color:"#222",backgroundColor:"#fff",padding:"30px",marginBottom:"2em",maxWidth:"90%",maxHeight:"90%",overflowY:"auto",border:"3px solid #3d3d5d",borderRadius:"8px",boxShadow:"0 0 80px 10px #666",width:"auto",fontFamily:"sans-serif"},Input:{height:"35px",width:"17em",borderColor:"#ccf4",outline:"none",fontSize:"17pt",padding:"8px"}};function z0({children:t,className:e}){return It("div",{className:e},It("div",{style:Tn.Darken}),It("div",{style:Tn.DialogOuter},It("div",{style:Tn.DialogInner},t)))}var Zs,Dt,rl,yf,As=0,vp=[],fs=[],mf=Qe.__b,bf=Qe.__r,wf=Qe.diffed,_f=Qe.__c,kf=Qe.unmount;function gc(t,e){Qe.__h&&Qe.__h(Dt,t,As||e),As=0;var n=Dt.__H||(Dt.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({__V:fs}),n.__[t]}function W0(t){return As=1,(function(e,n,r){var i=gc(Zs++,2);if(i.t=e,!i.__c&&(i.__=[xf(void 0,n),function(a){var l=i.__N?i.__N[0]:i.__[0],u=i.t(l,a);l!==u&&(i.__N=[u,i.__[1]],i.__c.setState({}))}],i.__c=Dt,!Dt.u)){Dt.u=!0;var o=Dt.shouldComponentUpdate;Dt.shouldComponentUpdate=function(a,l,u){if(!i.__c.__H)return!0;var d=i.__c.__H.__.filter((function(p){return p.__c}));if(d.every((function(p){return!p.__N})))return!o||o.call(this,a,l,u);var f=!1;return d.forEach((function(p){if(p.__N){var v=p.__[0];p.__=p.__N,p.__N=void 0,v!==p.__[0]&&(f=!0)}})),!!f&&(!o||o.call(this,a,l,u))}}return i.__N||i.__})(xf,t)}function Y0(t){return As=5,(function(e,n){var r=gc(Zs++,7);return gp(r.__H,n)?(r.__V=e(),r.i=n,r.__h=e,r.__V):r.__})((function(){return{current:t}}),[])}function G0(){for(var t;t=vp.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(ds),t.__H.__h.forEach(Ul),t.__H.__h=[]}catch(e){t.__H.__h=[],Qe.__e(e,t.__v)}}Qe.__b=function(t){Dt=null,mf&&mf(t)},Qe.__r=function(t){bf&&bf(t),Zs=0;var e=(Dt=t.__c).__H;e&&(rl===Dt?(e.__h=[],Dt.__h=[],e.__.forEach((function(n){n.__N&&(n.__=n.__N),n.__V=fs,n.__N=n.i=void 0}))):(e.__h.forEach(ds),e.__h.forEach(Ul),e.__h=[])),rl=Dt},Qe.diffed=function(t){wf&&wf(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(vp.push(e)!==1&&yf===Qe.requestAnimationFrame||((yf=Qe.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(o),Sf&&cancelAnimationFrame(r),setTimeout(n)},o=setTimeout(i,100);Sf&&(r=requestAnimationFrame(i))})(G0)),e.__H.__.forEach((function(n){n.i&&(n.__H=n.i),n.__V!==fs&&(n.__=n.__V),n.i=void 0,n.__V=fs}))),rl=Dt=null},Qe.__c=function(t,e){e.some((function(n){try{n.__h.forEach(ds),n.__h=n.__h.filter((function(r){return!r.__||Ul(r)}))}catch(r){e.some((function(i){i.__h&&(i.__h=[])})),e=[],Qe.__e(r,n.__v)}})),_f&&_f(t,e)},Qe.unmount=function(t){kf&&kf(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach((function(r){try{ds(r)}catch(i){e=i}})),e&&Qe.__e(e,n.__v))};var Sf=typeof requestAnimationFrame=="function";function ds(t){var e=Dt,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),Dt=e}function Ul(t){var e=Dt;t.__c=t.__(),Dt=e}function gp(t,e){return!t||t.length!==e.length||e.some((function(n,r){return n!==t[r]}))}function xf(t,e){return typeof e=="function"?e(t):e}function J0({message:t,messageCode:e,messageParams:n}){return t.replace(/\{\w+\}/gi,(r=>n[r.substring(1,r.length-1)]))}function Q0({title:t,type:e,alerts:n,fields:r,submitLabel:i,cancelLabel:o,onCancel:a,onSubmit:l}){const[u,d]=W0({}),f=Y0(null);return(function(p,v){var y=gc(Zs++,4);!Qe.__s&&gp(y.__H,v)&&(y.__=p,y.i=v,Dt.__h.push(y))})((()=>{var p;return(p=f.current)===null||p===void 0?void 0:p.focus()}),[]),It(z0,{className:"dxc-login-dlg"},It(ci,null,It("h3",{style:Tn.WindowHeader},t),n.map((p=>It("p",{style:Tn.Alert[p.type]},J0(p)))),It("form",{onSubmit:p=>{p.preventDefault(),l(u)}},Object.entries(r).map((([p,{type:v,label:y,placeholder:b}],k)=>It("label",{style:Tn.Label,key:k},y?`${y}: `:"",It("input",{ref:k===0?f:void 0,type:v,name:p,autoComplete:"on",style:Tn.Input,autoFocus:!0,placeholder:b,value:u[p]||"",onInput:x=>{var I;const E=(function(D,j){switch(D){case"email":return j.toLowerCase();case"otp":return j.toUpperCase();default:return j}})(v,(I=x.target)===null||I===void 0?void 0:I.value);let S=Object.assign(Object.assign({},u),{[p]:E});d(S),v==="otp"&&(E==null?void 0:E.trim().length)===8&&l(S)}})))))),It("div",{style:Tn.ButtonsDiv},It(ci,null,It("button",{type:"submit",style:Tn.Button,onClick:()=>l(u)},i),o&&It("button",{style:Tn.Button,onClick:a},o))))}class Ef extends to{constructor(e){super(e),this.observer=n=>this.setState({userInteraction:n}),this.state={userInteraction:void 0}}componentDidMount(){this.subscription=on(this.props.db.cloud.userInteraction).subscribe(this.observer)}componentWillUnmount(){this.subscription&&(this.subscription.unsubscribe(),delete this.subscription)}render(e,{userInteraction:n}){return n?It(Q0,Object.assign({},n)):null}}function Eo(t){const e=new WeakMap;return n=>{let r=e.get(n);return r||(r=t(n),e.set(n,r)),r}}const Os=Eo((t=>new _n(Zt)));function $s(t,e){let n=e,r=on(t).pipe(tn((o=>n=o)),By({resetOnRefCountZero:()=>Dd(1e3)}));const i=new At((o=>{let a=!1;const l=r.subscribe({next(u){a=!0,o.next(u)},error(u){o.error(u)},complete(){o.complete()}});return a||l.closed||o.next(n),l}));return i.getValue=()=>n,i}const yp=Eo((t=>$s(cr((()=>t.roles.where({realmId:"rlm-public"}).toArray().then((e=>{const n={};for(const r of e.slice().sort(((i,o)=>(i.sortOrder||0)-(o.sortOrder||0))))n[r.name]=r;return n})))),{}))),mp=Eo((t=>$s(Os(t._novip).pipe(Vt((e=>cr((()=>t.transaction("r","realms","members",(()=>Promise.all([t.members.where({userId:e.userId}).toArray(),t.realms.toArray(),e.userId]).then((([n,r,i])=>({selfMembers:n,realms:r,userId:i})))))))))),{selfMembers:[],realms:[],get userId(){return t.cloud.currentUserId}})));function X0(...t){return t.length===0?{}:t.reduce(((n,r)=>{const i=Object.assign({},n);for(const[o,a]of Object.entries(r))if(o in i&&i[o]){if(i[o]==="*")continue;if(a==="*")i[o]="*";else if(Array.isArray(a)&&Array.isArray(i[o])){const l=i,u=l[o];l[o]=[...new Set([...u,...a])]}else if(typeof a=="object"&&a&&typeof i[o]=="object"){const l=i[o];for(const[u,d]of Object.entries(a))l[u]!=="*"&&(d==="*"?l[u]="*":Array.isArray(l[u])&&Array.isArray(d)&&(l[u]=[...new Set([...l[u],...d])]))}}else i[o]=r[o];return i}))}const bp=Eo((t=>(function(e,n){let r;const i=e.pipe(tn((o=>r=n(o))));return i.getValue=()=>r!==void 0?r:r=n(e.getValue()),i})($s(so([mp(t._novip),yp(t._novip)]).pipe(tn((([{selfMembers:e,realms:n,userId:r},i])=>({selfMembers:e,realms:n,userId:r,globalRoles:i})))),{selfMembers:[],realms:[],userId:Zt.userId,globalRoles:{}}),(({selfMembers:e,realms:n,userId:r,globalRoles:i})=>n.map((a=>{const l=e.filter((f=>f.realmId===a.realmId)),u=l.map((f=>f.permissions)).filter((f=>f)),d=pc(l.map((f=>f.roles)).filter((f=>f))).map((f=>i[f])).filter((f=>f)).map((f=>f.permissions));return Object.assign(Object.assign({},a),{permissions:a.owner===r?{manage:"*"}:X0(...u,...d)})})).reduce(((a,l)=>Object.assign(Object.assign({},a),{[l.realmId]:l})),{[r]:{realmId:r,owner:r,name:r,permissions:{manage:"*"}}})))));class Cf{constructor(e,n,r){this.permissions=e||{},this.tableName=n,this.isOwner=r}add(...e){var n;return this.permissions.manage==="*"||!!(!((n=this.permissions.manage)===null||n===void 0)&&n.includes(this.tableName))||this.permissions.add==="*"||!!e.every((r=>{var i;return(i=this.permissions.add)===null||i===void 0?void 0:i.includes(r)}))}update(...e){var n,r;if(this.isOwner||this.permissions.manage==="*"||!((n=this.permissions.manage)===null||n===void 0)&&n.includes(this.tableName))return!0;if(this.permissions.update==="*")return e.every((o=>o!=="owner"));const i=(r=this.permissions.update)===null||r===void 0?void 0:r[this.tableName];return i==="*"?e.every((o=>o!=="owner")):e.every((o=>i==null?void 0:i.some((a=>a===o||a==="*"&&o!=="owner"))))}delete(){var e;return!(!this.isOwner&&this.permissions.manage!=="*")||!!(!((e=this.permissions.manage)===null||e===void 0)&&e.includes(this.tableName))}}const Z0=Eo((t=>{const e=Os(t._novip).pipe(Vt((i=>cr((()=>t.members.where({email:i.email||""}).toArray()))))),n=bp(t._novip),r=mp(t._novip);return $s(so([e,r,n]).pipe(tn((([i,o,a])=>{const l=(f,p)=>Object.assign(Object.assign({},f),{[p.id]:Object.assign(Object.assign({},p),{realm:a[p.realmId]})}),u=i.reduce(l,{}),d=o.selfMembers.reduce(l,u);return Object.values(d).filter((f=>!f.accepted)).map((f=>Object.assign(Object.assign({},f),{accept(){return Te(this,void 0,void 0,(function*(){yield t.members.update(f.id,{accepted:new Date})}))},reject(){return Te(this,void 0,void 0,(function*(){yield t.members.update(f.id,{rejected:new Date})}))}})))}))),[])}));function $0(t){return e=>{var n;const r=e.doc;if(!r)throw new Error("Internal error: DexieYProvider.createYHandler called without a doc. This is unexpected.");const{parentTable:i}=r.meta||{};if(!(!((n=t.cloud.schema)===null||n===void 0)&&n[i].markedForSync))return;let o;Object.defineProperty(e,"awareness",{get:()=>o||(o=(function(a,l,u){const{parentTable:d,parentId:f,parentProp:p,updatesTable:v}=l.meta,y=new jb(l),b=rp(l);return y.on("update",(({added:k,updated:x,removed:I},E)=>{const S=k.concat(x).concat(I),D=a.cloud.currentUser.value;if(E!=="server"&&D.isLoggedIn&&!po(a)){const j=Lb(y,S);a.messageProducer.next({type:"aware",table:d,prop:p,k:l.meta.parentId,u:j}),u.destroyed&&a.messageProducer.next({type:"doc-close",table:d,prop:p,k:l.meta.parentId})}})),y.on("destroy",(()=>{Dh(y,[l.clientID],"provider destroyed")})),Te(this,void 0,void 0,(function*(){if(u.destroyed)return;let k=!1,x=1;const I=so([a.cloud.webSocketStatus,b.pipe(Od(null))]).subscribe((([S])=>{if(u.destroyed)return;k=S==="connected";const D=a.cloud.currentUser.value;S==="connected"&&D.isLoggedIn&&!po(a)&&(++x,E().catch((j=>{})))}));function E(){return Te(this,void 0,void 0,(function*(){const S=x,D=a.table(v),j=a.$syncState,[O,M]=yield a.transaction("r",j,D,(()=>Te(this,void 0,void 0,(function*(){const re=yield D.get(hr),W=yield j.get("syncState");return[(re==null?void 0:re.receivedUntil)||0,(W==null?void 0:W.yServerRevision)||(W==null?void 0:W.serverRevision)]}))));if(u.destroyed||x!==S||!k)return;const ie={type:"doc-open",table:d,prop:p,k:f,serverRev:M},ne=yield D.where("i").between(O,1/0,!1).filter((re=>Ns(re.k,f)===0&&(1&(re.f||0))==0)).toArray();if(!u.destroyed&&x===S&&k){if(ne.length>0){const re=ws(ne.map((le=>le.u))),W=ih(re);ie.sv=W}a.messageProducer.next(ie)}}))}u.addCleanupHandler(I)})),y})(t,r,e),np.set(r,o),o)})}}const ew={nameSuffix:!0};function Nl(t){const e=t.name,n=Os(t),r=[];let i=!1,o=null;t.on("ready",(f=>Te(this,void 0,void 0,(function*(){try{yield(function(p){return Te(this,void 0,void 0,(function*(){var v,y,b,k,x,I,E;a=!1;const S=qn(p);typeof window<"u"&&typeof document<"u"&&(!((v=S.cloud.options)===null||v===void 0)&&v.customLoginGui||r.push((function(W){let le=!1;const ce=document.createElement("div");return document.body?(document.body.appendChild(ce),gf(It(Ef,{db:W.vip}),ce)):addEventListener("DOMContentLoaded",(()=>{le||(document.body.appendChild(ce),gf(It(Ef,{db:W.vip}),ce))})),{unsubscribe(){try{ce.remove()}catch{}le=!0},get closed(){return le}}})(p))),S.cloud.isServiceWorkerDB||r.push((function(W){let le=W.cloud.webSocketStatus.value;const ce=W.cloud.webSocketStatus.pipe(Vt((Ie=>{const De=le;le=Ie;const te=Wn(Ie);switch(Ie){case"disconnected":return $i.value?te.pipe(Mu(500)):te;case"connecting":return De==="not-started"||De==="error"?te:te.pipe(Mu(4e3));default:return te}})));return so([ce,W.syncStateChangedEvent.pipe(Od({phase:"initial"})),Os(W.dx._novip),Rl]).pipe(tn((([Ie,De,te,$])=>{var se;if(!((se=te.license)===null||se===void 0)&&se.status&&te.license.status!=="ok")return{phase:"offline",status:"offline",license:te.license.status};let{phase:ge,error:_e,progress:G}=De,U=Ie;return ge==="error"&&(U="error"),Ie==="not-started"&&(ge!=="pushing"&&ge!=="pulling"||(U="connecting")),W.cloud.syncState.value.phase!=="error"||De.phase!=="pushing"&&De.phase!=="pulling"||(U="connecting"),$||(U="disconnected"),{phase:ge,error:_e,progress:G,status:ei?U:"offline",license:"ok"}})))})(S).subscribe(p.cloud.syncState)),r.push(S.syncCompleteEvent.subscribe(u)),S.tables.every((W=>W.core))||(function(){throw new rt.SchemaError("Version increment needed to allow dexie-cloud change tracking")})();const D="serviceWorker"in navigator?yield navigator.serviceWorker.getRegistrations():[],[j,O]=yield S.transaction("rw",S.$syncState,(()=>Te(this,void 0,void 0,(function*(){var W,le;const{options:ce,schema:Ie}=S.cloud,[De,te,$]=yield Promise.all([S.getOptions(),S.getSchema(),S.getPersistedSyncState()]);if(i){if(!De||JSON.stringify(De)!==JSON.stringify(ce)){if(!ce)throw new Error("Internal error");const se=Object.assign({},ce);delete se.fetchTokens,delete se.awarenessProtocol,yield S.$syncState.put(se,"options")}}else S.cloud.options=De||null;if(!((W=S.cloud.options)===null||W===void 0)&&W.tryUseServiceWorker&&"serviceWorker"in navigator&&D.length>0&&!S0?S.cloud.usingServiceWorker=!0:(!((le=S.cloud.options)===null||le===void 0)&&le.tryUseServiceWorker&&S.cloud.isServiceWorkerDB,S.cloud.usingServiceWorker=!1),nl(Ie,S.cloud.options),nl(te,S.cloud.options),Ie){if(!te||JSON.stringify(te)!==JSON.stringify(Ie)){const se=te||{};for(const[ge,_e]of Object.entries(Ie)){const G=se[ge];G?(G.markedForSync=_e.markedForSync,_e.deleted=G.deleted,G.generatedGlobalId=_e.generatedGlobalId):se[ge]=Object.assign({},_e)}yield S.$syncState.put(se,"schema"),Object.assign(Ie,se)}}else S.cloud.schema=te||null;return[$==null?void 0:$.initiallySynced,$==null?void 0:$.realms]}))));if(j&&S.setInitiallySynced(!0),(function(W){var le,ce;for(const Ie of W.tables)if(!((ce=(le=W.cloud.schema)===null||le===void 0?void 0:le[Ie.name])===null||ce===void 0)&&ce.markedForSync){if(Ie.schema.primKey.auto)throw new rt.SchemaError(`Table ${Ie.name} is both autoIncremented and synced. Use db.cloud.configure({unsyncedTables: [${JSON.stringify(Ie.name)}]}) to blacklist it from sync`);if(!Ie.schema.primKey.keyPath)throw new rt.SchemaError(`Table ${Ie.name} cannot be both synced and outbound. Use db.cloud.configure({unsyncedTables: [${JSON.stringify(Ie.name)}]}) to blacklist it from sync`)}})(S),l(),!S.cloud.isServiceWorkerDB){r.push(cr((()=>S.getCurrentUser())).subscribe(n)),r.push(cr((()=>S.getPersistedSyncState())).subscribe(S.cloud.persistedSyncState)),yield Tr(so([n.pipe(Pu(1),Gr(1)),S.cloud.persistedSyncState.pipe(Pu(1),Gr(1))]));const W=$0(S);zt.on.new.subscribe(W),S.dx.once("close",(()=>{zt.on.new.unsubscribe(W)}))}let M=!1;const ie=yield S.getCurrentUser(),ne=(y=S.cloud.options)===null||y===void 0?void 0:y.requireAuth;ne&&(S.cloud.isServiceWorkerDB?yield Tr(n.pipe(fn((W=>!!W.isLoggedIn)),Gr(1))):typeof ne=="object"?(!ie.isLoggedIn||ne.userId&&ie.userId!==ne.userId||ne.email&&ie.email!==ne.email)&&(M=yield Za(S,ne)):ie.isLoggedIn||(M=yield Za(S))),!ie.isLoggedIn||O&&O.includes(ie.userId)||(M=!0),o&&o.stop(),o=null,l();const re=((b=S.cloud.options)===null||b===void 0?void 0:b.databaseUrl)&&(!j||M);re&&(yield(function(W,le,ce){return Te(this,void 0,void 0,(function*(){yield $h(W,Gh,(()=>Qs(W,le,ce,{isInitialSync:!0})))}))})(S,S.cloud.options,S.cloud.schema),S.setInitiallySynced(!0)),l(),S.cloud.usingServiceWorker&&(!((k=S.cloud.options)===null||k===void 0)&&k.databaseUrl)?(re||Oh(S,"push").catch((()=>{})),(function(W){return Te(this,void 0,void 0,(function*(){var le;try{const{periodicSync:ce}=yield navigator.serviceWorker.ready;if(ce)try{yield ce.register(`dexie-cloud:${W.name}`,(le=W.cloud.options)===null||le===void 0?void 0:le.periodicSync)}catch{}}catch{}}))})(S).catch((()=>{}))):!((x=S.cloud.options)===null||x===void 0)&&x.databaseUrl&&S.cloud.schema&&!S.cloud.isServiceWorkerDB&&(o=K0(S,S.cloud.options,S.cloud.schema),o.start(),re||Vn(S,"push")),l(),S.cloud.isServiceWorkerDB||r.push(An(self,"online").subscribe((()=>{S.syncStateChangedEvent.next({phase:"not-in-sync"}),po(S)||Vn(S,"push")})),An(self,"offline").subscribe((()=>{S.syncStateChangedEvent.next({phase:"offline"})}))),!(!((I=S.cloud.options)===null||I===void 0)&&I.databaseUrl)||!((E=S.cloud.options)===null||E===void 0)&&E.disableWebSocket||x0||r.push((function(W){var le;if(!(!((le=W.cloud.options)===null||le===void 0)&&le.databaseUrl))throw new Error("No database URL to connect WebSocket to");const ce=W.messageConsumer.readyToServe.pipe(fn((De=>De)),Vt((()=>W.getPersistedSyncState())),fn((De=>De&&De.serverRevision)),Vt((De=>Te(this,void 0,void 0,(function*(){return{type:"ready",rev:De.serverRevision,realmSetHash:yield Ol(De)}}))))),Ie=qs(ce,W.messageProducer);return(function De(){return W.cloud.persistedSyncState.pipe(fn((te=>te==null?void 0:te.serverRevision)),Gr(1),Vt((te=>W.cloud.currentUser.pipe(tn(($=>[$,te]))))),Vt((([te,$])=>Rl.pipe(tn((se=>[se?te:null,$]))))),Vt((([te,$])=>te!=null&&te.isLoggedIn&&!($!=null&&$.realms.includes(te.userId))?W.cloud.persistedSyncState.pipe(fn((se=>(se==null?void 0:se.realms.includes(te.userId))||!1)),Gr(1),tn((se=>[te,se]))):new _n([te,$]))),Vt((te=>Te(this,[te],void 0,(function*([$,se]){return[$,yield Ol(se)]})))),Ad((([te,$],[se,ge])=>te===se&&$===ge)),Vt((([te,$])=>{var se;return!((se=W.cloud.persistedSyncState)===null||se===void 0)&&se.value?te?new L0(W,W.cloud.persistedSyncState.value.serverRevision,W.cloud.persistedSyncState.value.yServerRevision,$,W.cloud.persistedSyncState.value.clientIdentity,Ie,W.cloud.webSocketStatus,te):on([]):De()})),gl((te=>(te==null?void 0:te.name)==="TokenExpiredError"?Wn(!0).pipe(Vt((()=>Te(this,void 0,void 0,(function*(){const $=yield W.getCurrentUser(),se=yield Js(W.cloud.options.databaseUrl,$);yield W.table("$logins").update($.userId,{accessToken:se.accessToken,accessTokenExpiration:se.accessTokenExpiration,claims:se.claims,license:se.license,data:se.data})})))),Vt((()=>De()))):Du((()=>te)))),gl((te=>(W.cloud.webSocketStatus.next("error"),te instanceof N0?Du((()=>te)):on(F0()).pipe(Vt((()=>De())))))))})().subscribe({next:De=>{De&&W.messageConsumer.enqueue(De)},error:De=>{},complete:()=>{}})})(S))}))})(f)}catch{}}))),!0);let a=!1;function l(){if(a)throw new rt.DatabaseClosedError}t.once("close",(()=>{r.forEach((f=>f.unsubscribe())),r.splice(0,r.length),a=!0,o&&o.stop(),o=null,n.next(Zt)}));const u=new jr;var d;t.cloud={version:"4.2.0",options:Object.assign({},ew),schema:null,get currentUserId(){return n.value.userId||Zt.userId},currentUser:n,syncState:new _n({phase:"initial",status:"not-started"}),events:{syncComplete:u},persistedSyncState:new _n(void 0),userInteraction:new _n(void 0),webSocketStatus:new _n("not-started"),login(f){return Te(this,void 0,void 0,(function*(){const p=qn(t);yield p.cloud.sync(),yield Za(p,f)}))},invites:Z0(t),roles:yp(t),configure(f){f=t.cloud.options=Object.assign(Object.assign({},t.cloud.options),f),i=!0,f.databaseUrl&&f.nameSuffix&&(t.name=`${e}-${(function(p){const v=new URL(p);return v.pathname==="/"?v.hostname.split(".")[0]:v.pathname.split("/")[1]})(f.databaseUrl)}`,qn(t).reconfigure()),nl(t.cloud.schema,t.cloud.options)},logout(){return Te(this,arguments,void 0,(function*({force:f}={}){f?yield Dl(qn(t),{deleteUnsyncedData:!0}):yield Ph(qn(t))}))},sync(){return Te(this,arguments,void 0,(function*({wait:f,purpose:p}={wait:!0,purpose:"push"}){var v;f===void 0&&(f=!0);const y=qn(t);if((((v=y.cloud.currentUser.value.license)===null||v===void 0?void 0:v.status)||"ok")!=="ok"&&(yield Gs(y)),p==="pull"){const b=y.cloud.persistedSyncState.value;if(Vn(y,p),f){const k=yield Tr(y.cloud.persistedSyncState.pipe(fn((x=>(x==null?void 0:x.timestamp)!=null&&(!b||x.timestamp>b.timestamp)))));if(k!=null&&k.error)throw new Error("Sync error: "+k.error)}}else if(yield uf(y)){const b=y.cloud.persistedSyncState.value;Vn(y,p),f&&(yield Tr(on(cr((()=>Te(this,void 0,void 0,(function*(){const k=yield uf(y),x=yield y.getPersistedSyncState();if((x==null?void 0:x.timestamp)!==(b==null?void 0:b.timestamp)&&(x!=null&&x.error))throw new Error("Sync error: "+x.error);return k}))))).pipe(fn((k=>!k)))))}}))},permissions:(f,p)=>(function(v,y,b){if(!y)throw new TypeError("Cannot check permissions of undefined or null. A Dexie Cloud object with realmId and owner expected.");const{owner:k,realmId:x}=y;if(!b){if(typeof y.table!="function")throw new TypeError("Missing 'table' argument to permissions and table could not be extracted from entity");b=y.table()}const I=bp(v),E=D=>{const j=D[x||v.cloud.currentUserId];return j?new Cf(j.permissions,b,x===void 0||x===v.cloud.currentUserId||k===v.cloud.currentUserId):new Cf({},b,!k||k===v.cloud.currentUserId)},S=I.pipe(tn(E));return S.getValue=()=>E(I.getValue()),S})(t._novip,f,p)},t.Version.prototype._parseStoresSpec=rt.override(t.Version.prototype._parseStoresSpec,(f=>O0(f,t))),t.Table.prototype.newId=function({colocateWith:f}={}){const p=f&&f.substr(f.length-3);return Zh(t.cloud.schema[this.name].idPrefix||"",p)},t.Table.prototype.idPrefix=function(){var f,p;return((p=(f=this.db.cloud.schema)===null||f===void 0?void 0:f[this.name])===null||p===void 0?void 0:p.idPrefix)||""},t.use(A0({currentUserObservable:t.cloud.currentUser,db:qn(t)})),t.use((d=qn(t),{stack:"dbcore",name:"implicitPropSetterMiddleware",level:1,create:f=>Object.assign(Object.assign({},f),{table:p=>{const v=f.table(p);return Object.assign(Object.assign({},v),{mutate:y=>{var b,k,x,I,E,S;const D=y.trans;if(D.disableChangeTracking)return v.mutate(y);const j=(k=(b=D.currentUser)===null||b===void 0?void 0:b.userId)!==null&&k!==void 0?k:Zt.userId;if(!((I=(x=d.cloud.schema)===null||x===void 0?void 0:x[p])===null||I===void 0)&&I.markedForSync&&(y.type==="add"||y.type==="put")){if(p==="members")for(const O of y.values)typeof O.email=="string"&&(O.email=O.email.trim().toLowerCase());for(const O of y.values){O.owner||(O.owner=j),O.realmId||(O.realmId=j);const M=(S=(E=v.schema.primaryKey).extractKey)===null||S===void 0?void 0:S.call(E,O);typeof M=="string"&&M[0]==="#"&&y.type==="put"&&(delete y.criteria,delete y.changeSpec,delete y.updates,O.$ts=Date.now())}}return v.mutate(y)}})}})})),t.use(I0(qn(t)))}Nl.version="4.2.0",rt.Cloud=Nl;class wp{constructor(){this._db=new rt("FastingHours",{addons:[Nl]}),this._db.version(30).stores({history:"id, started",hunger:"id, created",water:"id, created",weight:"id, created"}),this._db.cloud.configure({customLoginGui:!0,databaseUrl:"https://zzcxr8dte.dexie.cloud",requireAuth:!1})}check(e){return fetch("https://ketnerlake.com/api/dexie/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server:"zzcxr8dte",email:e})})}login(e){this._db.cloud.userInteraction.onSubmit({otp:e})}logout(){return this._db.cloud.logout()}sync(){return this._db.cloud.sync({purpose:"pull",wait:!0})}ui(){return this._db.cloud.userInteraction}user(){return this._db.cloud.currentUser}verify(e){return this._db.cloud.login({email:e,grant_type:"otp"})}browseHistory(){return this._db.history.toArray()}browseHistoryByEnd(){return this._db.history.toArray().then(e=>e.filter(r=>r.ended===null)[0])}bulkHistory(e){return this._db.history.bulkAdd(e)}readHistory(e){return this._db.history.get({id:e})}editHistory(e){const n=Ri(e);return n.updated=new Date,this._db.history.put(n).then(()=>this._db.history.get({id:e.id}))}addHistory(){const e={id:crypto.randomUUID(),type:"history",created:new Date,updated:new Date,started:new Date,ended:null,notes:null};return this._db.history.add(e).then(()=>this._db.history.get({id:e.id}))}deleteHistory(e){return this._db.history.delete(e)}browseHunger(e=!1){return this._db.hunger.toArray().then(n=>e?(n.sort((r,i)=>r.created.getTime()<i.created.getTime()?1:r.created.getTime()>i.created.getTime()?-1:0),n.length===0?null:n[0]):n)}bulkHunger(e){return this._db.hunger.bulkAdd(e)}readHunger(e){return this._db.hunger.get({id:e})}editHunger(e){const n=Ri(e);return n.updated=new Date,this._db.hunger.put(n).then(()=>this._db.hunger.get({id:e.id}))}addHunger(e=5){const n={id:crypto.randomUUID(),type:"hunger",created:new Date,updated:new Date,level:e};return this._db.hunger.add(n).then(()=>this._db.hunger.get({id:n.id}))}deleteHunger(e){return this._db.hunger.delete(e)}browseWater(e=!1){return this._db.water.toArray().then(n=>{if(e){const r=new Date;r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0);const i=new Date(r.getTime());return i.setDate(i.getDate()+1),n.filter(o=>o.created.getTime()>r.getTime()&&o.created.getTime()<i.getTime())}else return n})}bulkWater(e){return this._db.water.bulkAdd(e)}readWater(e){return this._db.water.get({id:e})}editWater(e){const n=Ri(e);return n.updated=new Date,this._db.water.put(n).then(()=>this._db.water.get({id:e.id}))}addWater(e){const n={id:crypto.randomUUID(),type:"water",created:new Date,updated:new Date,volume:e};return crypto.randomUUID(),this._db.water.add(n).then(()=>this._db.water.get({id:n.id}))}deleteWater(e){return this._db.water.delete(e)}browseWeight(e=!1){return this._db.weight.toArray().then(n=>{if(e){const r=new Date;r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0);const i=new Date(r.getTime());return i.setDate(i.getDate()+1),n.filter(o=>o.created.getTime()>r.getTime()&&o.created.getTime()<i.getTime())}else return n})}bulkWeight(e){return this._db.weight.bulkAdd(e)}readWeight(e){return this._db.weight.get({id:e})}editWeight(e){const n=Ri(e);return this._db.weight.put(n).then(()=>this._db.weight.get({id:e.id}))}addWeight(e){const n=crypto.randomUUID(),r=Ri(e);return r.id=n,console.log("ADD"),console.log(r),this._db.weight.add(r).then(()=>this._db.weight.get({id:n}))}deleteWeight(e){return this._db.weight.delete(e)}}var il={exports:{}},If;function tw(){return If||(If=1,(function(t,e){(function(){var n=Math.PI,r=Math.sin,i=Math.cos,o=Math.tan,a=Math.asin,l=Math.atan2,u=Math.acos,d=n/180,f=1e3*60*60*24,p=2440588,v=2451545;function y(G){return G.valueOf()/f-.5+p}function b(G){return new Date((G+.5-p)*f)}function k(G){return y(G)-v}var x=d*23.4397;function I(G,U){return l(r(G)*i(x)-o(U)*r(x),i(G))}function E(G,U){return a(r(U)*i(x)+i(U)*r(x)*r(G))}function S(G,U,Y){return l(r(G),i(G)*r(U)-o(Y)*i(U))}function D(G,U,Y){return a(r(U)*r(Y)+i(U)*i(Y)*i(G))}function j(G,U){return d*(280.16+360.9856235*G)-U}function O(G){return G<0&&(G=0),2967e-7/Math.tan(G+.00312536/(G+.08901179))}function M(G){return d*(357.5291+.98560028*G)}function ie(G){var U=d*(1.9148*r(G)+.02*r(2*G)+3e-4*r(3*G)),Y=d*102.9372;return G+U+Y+n}function ne(G){var U=M(G),Y=ie(U);return{dec:E(Y,0),ra:I(Y,0)}}var re={};re.getPosition=function(G,U,Y){var ve=d*-Y,Ee=d*U,Me=k(G),ye=ne(Me),ke=j(Me,ve)-ye.ra;return{azimuth:S(ke,Ee,ye.dec),altitude:D(ke,Ee,ye.dec)}};var W=re.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];re.addTime=function(G,U,Y){W.push([G,U,Y])};var le=9e-4;function ce(G,U){return Math.round(G-le-U/(2*n))}function Ie(G,U,Y){return le+(G+U)/(2*n)+Y}function De(G,U,Y){return v+G+.0053*r(U)-.0069*r(2*Y)}function te(G,U,Y){return u((r(G)-r(U)*r(Y))/(i(U)*i(Y)))}function $(G){return-2.076*Math.sqrt(G)/60}function se(G,U,Y,ve,Ee,Me,ye){var ke=te(G,Y,ve),oe=Ie(ke,U,Ee);return De(oe,Me,ye)}re.getTimes=function(G,U,Y,ve){ve=ve||0;var Ee=d*-Y,Me=d*U,ye=$(ve),ke=k(G),oe=ce(ke,Ee),Pe=Ie(0,Ee,oe),Be=M(Pe),Se=ie(Be),Ne=E(Se,0),Ue=De(Pe,Be,Se),Ve,mt,kt,vt,Yt,Xt,bt={solarNoon:b(Ue),nadir:b(Ue-.5)};for(Ve=0,mt=W.length;Ve<mt;Ve+=1)kt=W[Ve],vt=(kt[0]+ye)*d,Yt=se(vt,Ee,Me,Ne,oe,Be,Se),Xt=Ue-(Yt-Ue),bt[kt[1]]=b(Xt),bt[kt[2]]=b(Yt);return bt};function ge(G){var U=d*(218.316+13.176396*G),Y=d*(134.963+13.064993*G),ve=d*(93.272+13.22935*G),Ee=U+d*6.289*r(Y),Me=d*5.128*r(ve),ye=385001-20905*i(Y);return{ra:I(Ee,Me),dec:E(Ee,Me),dist:ye}}re.getMoonPosition=function(G,U,Y){var ve=d*-Y,Ee=d*U,Me=k(G),ye=ge(Me),ke=j(Me,ve)-ye.ra,oe=D(ke,Ee,ye.dec),Pe=l(r(ke),o(Ee)*i(ye.dec)-r(ye.dec)*i(ke));return oe=oe+O(oe),{azimuth:S(ke,Ee,ye.dec),altitude:oe,distance:ye.dist,parallacticAngle:Pe}},re.getMoonIllumination=function(G){var U=k(G||new Date),Y=ne(U),ve=ge(U),Ee=149598e3,Me=u(r(Y.dec)*r(ve.dec)+i(Y.dec)*i(ve.dec)*i(Y.ra-ve.ra)),ye=l(Ee*r(Me),ve.dist-Ee*i(Me)),ke=l(i(Y.dec)*r(Y.ra-ve.ra),r(Y.dec)*i(ve.dec)-i(Y.dec)*r(ve.dec)*i(Y.ra-ve.ra));return{fraction:(1+i(ye))/2,phase:.5+.5*ye*(ke<0?-1:1)/Math.PI,angle:ke}};function _e(G,U){return new Date(G.valueOf()+U*f/24)}re.getMoonTimes=function(G,U,Y,ve){var Ee=new Date(G);ve?Ee.setUTCHours(0,0,0,0):Ee.setHours(0,0,0,0);for(var Me=.133*d,ye=re.getMoonPosition(Ee,U,Y).altitude-Me,ke,oe,Pe,Be,Se,Ne,Ue,Ve,mt,kt,vt,Yt,Xt,bt=1;bt<=24&&(ke=re.getMoonPosition(_e(Ee,bt),U,Y).altitude-Me,oe=re.getMoonPosition(_e(Ee,bt+1),U,Y).altitude-Me,Se=(ye+oe)/2-ke,Ne=(oe-ye)/2,Ue=-Ne/(2*Se),Ve=(Se*Ue+Ne)*Ue+ke,mt=Ne*Ne-4*Se*ke,kt=0,mt>=0&&(Xt=Math.sqrt(mt)/(Math.abs(Se)*2),vt=Ue-Xt,Yt=Ue+Xt,Math.abs(vt)<=1&&kt++,Math.abs(Yt)<=1&&kt++,vt<-1&&(vt=Yt)),kt===1?ye<0?Pe=bt+vt:Be=bt+vt:kt===2&&(Pe=bt+(Ve<0?Yt:vt),Be=bt+(Ve<0?vt:Yt)),!(Pe&&Be));bt+=2)ye=oe;var Ln={};return Pe&&(Ln.rise=_e(Ee,Pe)),Be&&(Ln.set=_e(Ee,Be)),!Pe&&!Be&&(Ln[Ve>0?"alwaysUp":"alwaysDown"]=!0),Ln},t.exports=re})()})(il)),il.exports}var nw=tw();const rw=td(nw),_p=/^[a-z0-9]+(-[a-z0-9]+)*$/,ea=(t,e,n,r="")=>{const i=t.split(":");if(t.slice(0,1)==="@"){if(i.length<2||i.length>3)return null;r=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){const l=i.pop(),u=i.pop(),d={provider:i.length>0?i[0]:r,prefix:u,name:l};return e&&!hs(d)?null:d}const o=i[0],a=o.split("-");if(a.length>1){const l={provider:r,prefix:a.shift(),name:a.join("-")};return e&&!hs(l)?null:l}if(n&&r===""){const l={provider:r,prefix:"",name:o};return e&&!hs(l,n)?null:l}return null},hs=(t,e)=>t?!!((e&&t.prefix===""||t.prefix)&&t.name):!1,kp=Object.freeze({left:0,top:0,width:16,height:16}),Ms=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),ta=Object.freeze({...kp,...Ms}),Fl=Object.freeze({...ta,body:"",hidden:!1});function iw(t,e){const n={};!t.hFlip!=!e.hFlip&&(n.hFlip=!0),!t.vFlip!=!e.vFlip&&(n.vFlip=!0);const r=((t.rotate||0)+(e.rotate||0))%4;return r&&(n.rotate=r),n}function Df(t,e){const n=iw(t,e);for(const r in Fl)r in Ms?r in t&&!(r in n)&&(n[r]=Ms[r]):r in e?n[r]=e[r]:r in t&&(n[r]=t[r]);return n}function ow(t,e){const n=t.icons,r=t.aliases||Object.create(null),i=Object.create(null);function o(a){if(n[a])return i[a]=[];if(!(a in i)){i[a]=null;const l=r[a]&&r[a].parent,u=l&&o(l);u&&(i[a]=[l].concat(u))}return i[a]}return Object.keys(n).concat(Object.keys(r)).forEach(o),i}function sw(t,e,n){const r=t.icons,i=t.aliases||Object.create(null);let o={};function a(l){o=Df(r[l]||i[l],o)}return a(e),n.forEach(a),Df(t,o)}function Sp(t,e){const n=[];if(typeof t!="object"||typeof t.icons!="object")return n;t.not_found instanceof Array&&t.not_found.forEach(i=>{e(i,null),n.push(i)});const r=ow(t);for(const i in r){const o=r[i];o&&(e(i,sw(t,i,o)),n.push(i))}return n}const aw={provider:"",aliases:{},not_found:{},...kp};function ol(t,e){for(const n in e)if(n in t&&typeof t[n]!=typeof e[n])return!1;return!0}function xp(t){if(typeof t!="object"||t===null)return null;const e=t;if(typeof e.prefix!="string"||!t.icons||typeof t.icons!="object"||!ol(t,aw))return null;const n=e.icons;for(const i in n){const o=n[i];if(!i||typeof o.body!="string"||!ol(o,Fl))return null}const r=e.aliases||Object.create(null);for(const i in r){const o=r[i],a=o.parent;if(!i||typeof a!="string"||!n[a]&&!r[a]||!ol(o,Fl))return null}return e}const Tf=Object.create(null);function lw(t,e){return{provider:t,prefix:e,icons:Object.create(null),missing:new Set}}function fi(t,e){const n=Tf[t]||(Tf[t]=Object.create(null));return n[e]||(n[e]=lw(t,e))}function Ep(t,e){return xp(e)?Sp(e,(n,r)=>{r?t.icons[n]=r:t.missing.add(n)}):[]}function cw(t,e,n){try{if(typeof n.body=="string")return t.icons[e]={...n},!0}catch{}return!1}let vo=!1;function Cp(t){return typeof t=="boolean"&&(vo=t),vo}function uw(t){const e=typeof t=="string"?ea(t,!0,vo):t;if(e){const n=fi(e.provider,e.prefix),r=e.name;return n.icons[r]||(n.missing.has(r)?null:void 0)}}function fw(t,e){const n=ea(t,!0,vo);if(!n)return!1;const r=fi(n.provider,n.prefix);return e?cw(r,n.name,e):(r.missing.add(n.name),!0)}function dw(t,e){if(typeof t!="object")return!1;if(typeof e!="string"&&(e=t.provider||""),vo&&!e&&!t.prefix){let i=!1;return xp(t)&&(t.prefix="",Sp(t,(o,a)=>{fw(o,a)&&(i=!0)})),i}const n=t.prefix;if(!hs({prefix:n,name:"a"}))return!1;const r=fi(e,n);return!!Ep(r,t)}const Ip=Object.freeze({width:null,height:null}),Dp=Object.freeze({...Ip,...Ms}),hw=/(-?[0-9.]*[0-9]+[0-9.]*)/g,pw=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function Af(t,e,n){if(e===1)return t;if(n=n||100,typeof t=="number")return Math.ceil(t*e*n)/n;if(typeof t!="string")return t;const r=t.split(hw);if(r===null||!r.length)return t;const i=[];let o=r.shift(),a=pw.test(o);for(;;){if(a){const l=parseFloat(o);isNaN(l)?i.push(o):i.push(Math.ceil(l*e*n)/n)}else i.push(o);if(o=r.shift(),o===void 0)return i.join("");a=!a}}function vw(t,e="defs"){let n="";const r=t.indexOf("<"+e);for(;r>=0;){const i=t.indexOf(">",r),o=t.indexOf("</"+e);if(i===-1||o===-1)break;const a=t.indexOf(">",o);if(a===-1)break;n+=t.slice(i+1,o).trim(),t=t.slice(0,r).trim()+t.slice(a+1)}return{defs:n,content:t}}function gw(t,e){return t?"<defs>"+t+"</defs>"+e:e}function yw(t,e,n){const r=vw(t);return gw(r.defs,e+r.content+n)}const mw=t=>t==="unset"||t==="undefined"||t==="none";function bw(t,e){const n={...ta,...t},r={...Dp,...e},i={left:n.left,top:n.top,width:n.width,height:n.height};let o=n.body;[n,r].forEach(k=>{const x=[],I=k.hFlip,E=k.vFlip;let S=k.rotate;I?E?S+=2:(x.push("translate("+(i.width+i.left).toString()+" "+(0-i.top).toString()+")"),x.push("scale(-1 1)"),i.top=i.left=0):E&&(x.push("translate("+(0-i.left).toString()+" "+(i.height+i.top).toString()+")"),x.push("scale(1 -1)"),i.top=i.left=0);let D;switch(S<0&&(S-=Math.floor(S/4)*4),S=S%4,S){case 1:D=i.height/2+i.top,x.unshift("rotate(90 "+D.toString()+" "+D.toString()+")");break;case 2:x.unshift("rotate(180 "+(i.width/2+i.left).toString()+" "+(i.height/2+i.top).toString()+")");break;case 3:D=i.width/2+i.left,x.unshift("rotate(-90 "+D.toString()+" "+D.toString()+")");break}S%2===1&&(i.left!==i.top&&(D=i.left,i.left=i.top,i.top=D),i.width!==i.height&&(D=i.width,i.width=i.height,i.height=D)),x.length&&(o=yw(o,'<g transform="'+x.join(" ")+'">',"</g>"))});const a=r.width,l=r.height,u=i.width,d=i.height;let f,p;a===null?(p=l===null?"1em":l==="auto"?d:l,f=Af(p,u/d)):(f=a==="auto"?u:a,p=l===null?Af(f,d/u):l==="auto"?d:l);const v={},y=(k,x)=>{mw(x)||(v[k]=x.toString())};y("width",f),y("height",p);const b=[i.left,i.top,u,d];return v.viewBox=b.join(" "),{attributes:v,viewBox:b,body:o}}const ww=/\sid="(\S+)"/g,_w="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let kw=0;function Sw(t,e=_w){const n=[];let r;for(;r=ww.exec(t);)n.push(r[1]);if(!n.length)return t;const i="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(o=>{const a=typeof e=="function"?e(o):e+(kw++).toString(),l=o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t=t.replace(new RegExp('([#;"])('+l+')([")]|\\.[a-z])',"g"),"$1"+a+i+"$3")}),t=t.replace(new RegExp(i,"g"),""),t}const Bl=Object.create(null);function xw(t,e){Bl[t]=e}function Kl(t){return Bl[t]||Bl[""]}function yc(t){let e;if(typeof t.resources=="string")e=[t.resources];else if(e=t.resources,!(e instanceof Array)||!e.length)return null;return{resources:e,path:t.path||"/",maxURL:t.maxURL||500,rotate:t.rotate||750,timeout:t.timeout||5e3,random:t.random===!0,index:t.index||0,dataAfterTimeout:t.dataAfterTimeout!==!1}}const mc=Object.create(null),Vi=["https://api.simplesvg.com","https://api.unisvg.com"],ps=[];for(;Vi.length>0;)Vi.length===1||Math.random()>.5?ps.push(Vi.shift()):ps.push(Vi.pop());mc[""]=yc({resources:["https://api.iconify.design"].concat(ps)});function Ew(t,e){const n=yc(e);return n===null?!1:(mc[t]=n,!0)}function bc(t){return mc[t]}const Cw=()=>{let t;try{if(t=fetch,typeof t=="function")return t}catch{}};let Of=Cw();function Iw(t,e){const n=bc(t);if(!n)return 0;let r;if(!n.maxURL)r=0;else{let i=0;n.resources.forEach(a=>{i=Math.max(i,a.length)});const o=e+".json?icons=";r=n.maxURL-i-n.path.length-o.length}return r}function Dw(t){return t===404}const Tw=(t,e,n)=>{const r=[],i=Iw(t,e),o="icons";let a={type:o,provider:t,prefix:e,icons:[]},l=0;return n.forEach((u,d)=>{l+=u.length+1,l>=i&&d>0&&(r.push(a),a={type:o,provider:t,prefix:e,icons:[]},l=u.length),a.icons.push(u)}),r.push(a),r};function Aw(t){if(typeof t=="string"){const e=bc(t);if(e)return e.path}return"/"}const Ow=(t,e,n)=>{if(!Of){n("abort",424);return}let r=Aw(e.provider);switch(e.type){case"icons":{const o=e.prefix,l=e.icons.join(","),u=new URLSearchParams({icons:l});r+=o+".json?"+u.toString();break}case"custom":{const o=e.uri;r+=o.slice(0,1)==="/"?o.slice(1):o;break}default:n("abort",400);return}let i=503;Of(t+r).then(o=>{const a=o.status;if(a!==200){setTimeout(()=>{n(Dw(a)?"abort":"next",a)});return}return i=501,o.json()}).then(o=>{if(typeof o!="object"||o===null){setTimeout(()=>{o===404?n("abort",o):n("next",i)});return}setTimeout(()=>{n("success",o)})}).catch(()=>{n("next",i)})},Mw={prepare:Tw,send:Ow};function Pw(t){const e={loaded:[],missing:[],pending:[]},n=Object.create(null);t.sort((i,o)=>i.provider!==o.provider?i.provider.localeCompare(o.provider):i.prefix!==o.prefix?i.prefix.localeCompare(o.prefix):i.name.localeCompare(o.name));let r={provider:"",prefix:"",name:""};return t.forEach(i=>{if(r.name===i.name&&r.prefix===i.prefix&&r.provider===i.provider)return;r=i;const o=i.provider,a=i.prefix,l=i.name,u=n[o]||(n[o]=Object.create(null)),d=u[a]||(u[a]=fi(o,a));let f;l in d.icons?f=e.loaded:a===""||d.missing.has(l)?f=e.missing:f=e.pending;const p={provider:o,prefix:a,name:l};f.push(p)}),e}function Tp(t,e){t.forEach(n=>{const r=n.loaderCallbacks;r&&(n.loaderCallbacks=r.filter(i=>i.id!==e))})}function jw(t){t.pendingCallbacksFlag||(t.pendingCallbacksFlag=!0,setTimeout(()=>{t.pendingCallbacksFlag=!1;const e=t.loaderCallbacks?t.loaderCallbacks.slice(0):[];if(!e.length)return;let n=!1;const r=t.provider,i=t.prefix;e.forEach(o=>{const a=o.icons,l=a.pending.length;a.pending=a.pending.filter(u=>{if(u.prefix!==i)return!0;const d=u.name;if(t.icons[d])a.loaded.push({provider:r,prefix:i,name:d});else if(t.missing.has(d))a.missing.push({provider:r,prefix:i,name:d});else return n=!0,!0;return!1}),a.pending.length!==l&&(n||Tp([t],o.id),o.callback(a.loaded.slice(0),a.missing.slice(0),a.pending.slice(0),o.abort))})}))}let Lw=0;function Rw(t,e,n){const r=Lw++,i=Tp.bind(null,n,r);if(!e.pending.length)return i;const o={id:r,icons:e,callback:t,abort:i};return n.forEach(a=>{(a.loaderCallbacks||(a.loaderCallbacks=[])).push(o)}),i}function Uw(t,e=!0,n=!1){const r=[];return t.forEach(i=>{const o=typeof i=="string"?ea(i,e,n):i;o&&r.push(o)}),r}var Nw={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function Fw(t,e,n,r){const i=t.resources.length,o=t.random?Math.floor(Math.random()*i):t.index;let a;if(t.random){let O=t.resources.slice(0);for(a=[];O.length>1;){const M=Math.floor(Math.random()*O.length);a.push(O[M]),O=O.slice(0,M).concat(O.slice(M+1))}a=a.concat(O)}else a=t.resources.slice(o).concat(t.resources.slice(0,o));const l=Date.now();let u="pending",d=0,f,p=null,v=[],y=[];typeof r=="function"&&y.push(r);function b(){p&&(clearTimeout(p),p=null)}function k(){u==="pending"&&(u="aborted"),b(),v.forEach(O=>{O.status==="pending"&&(O.status="aborted")}),v=[]}function x(O,M){M&&(y=[]),typeof O=="function"&&y.push(O)}function I(){return{startTime:l,payload:e,status:u,queriesSent:d,queriesPending:v.length,subscribe:x,abort:k}}function E(){u="failed",y.forEach(O=>{O(void 0,f)})}function S(){v.forEach(O=>{O.status==="pending"&&(O.status="aborted")}),v=[]}function D(O,M,ie){const ne=M!=="success";switch(v=v.filter(re=>re!==O),u){case"pending":break;case"failed":if(ne||!t.dataAfterTimeout)return;break;default:return}if(M==="abort"){f=ie,E();return}if(ne){f=ie,v.length||(a.length?j():E());return}if(b(),S(),!t.random){const re=t.resources.indexOf(O.resource);re!==-1&&re!==t.index&&(t.index=re)}u="completed",y.forEach(re=>{re(ie)})}function j(){if(u!=="pending")return;b();const O=a.shift();if(O===void 0){if(v.length){p=setTimeout(()=>{b(),u==="pending"&&(S(),E())},t.timeout);return}E();return}const M={status:"pending",resource:O,callback:(ie,ne)=>{D(M,ie,ne)}};v.push(M),d++,p=setTimeout(j,t.rotate),n(O,e,M.callback)}return setTimeout(j),I}function Ap(t){const e={...Nw,...t};let n=[];function r(){n=n.filter(l=>l().status==="pending")}function i(l,u,d){const f=Fw(e,l,u,(p,v)=>{r(),d&&d(p,v)});return n.push(f),f}function o(l){return n.find(u=>l(u))||null}return{query:i,find:o,setIndex:l=>{e.index=l},getIndex:()=>e.index,cleanup:r}}function Mf(){}const sl=Object.create(null);function Bw(t){if(!sl[t]){const e=bc(t);if(!e)return;const n=Ap(e),r={config:e,redundancy:n};sl[t]=r}return sl[t]}function Kw(t,e,n){let r,i;if(typeof t=="string"){const o=Kl(t);if(!o)return n(void 0,424),Mf;i=o.send;const a=Bw(t);a&&(r=a.redundancy)}else{const o=yc(t);if(o){r=Ap(o);const a=t.resources?t.resources[0]:"",l=Kl(a);l&&(i=l.send)}}return!r||!i?(n(void 0,424),Mf):r.query(e,i,n)().abort}function Pf(){}function qw(t){t.iconsLoaderFlag||(t.iconsLoaderFlag=!0,setTimeout(()=>{t.iconsLoaderFlag=!1,jw(t)}))}function Hw(t){const e=[],n=[];return t.forEach(r=>{(r.match(_p)?e:n).push(r)}),{valid:e,invalid:n}}function zi(t,e,n){function r(){const i=t.pendingIcons;e.forEach(o=>{i&&i.delete(o),t.icons[o]||t.missing.add(o)})}if(n&&typeof n=="object")try{if(!Ep(t,n).length){r();return}}catch(i){console.error(i)}r(),qw(t)}function jf(t,e){t instanceof Promise?t.then(n=>{e(n)}).catch(()=>{e(null)}):e(t)}function Vw(t,e){t.iconsToLoad?t.iconsToLoad=t.iconsToLoad.concat(e).sort():t.iconsToLoad=e,t.iconsQueueFlag||(t.iconsQueueFlag=!0,setTimeout(()=>{t.iconsQueueFlag=!1;const{provider:n,prefix:r}=t,i=t.iconsToLoad;if(delete t.iconsToLoad,!i||!i.length)return;const o=t.loadIcon;if(t.loadIcons&&(i.length>1||!o)){jf(t.loadIcons(i,r,n),f=>{zi(t,i,f)});return}if(o){i.forEach(f=>{const p=o(f,r,n);jf(p,v=>{const y=v?{prefix:r,icons:{[f]:v}}:null;zi(t,[f],y)})});return}const{valid:a,invalid:l}=Hw(i);if(l.length&&zi(t,l,null),!a.length)return;const u=r.match(_p)?Kl(n):null;if(!u){zi(t,a,null);return}u.prepare(n,r,a).forEach(f=>{Kw(n,f,p=>{zi(t,f.icons,p)})})}))}const zw=(t,e)=>{const n=Uw(t,!0,Cp()),r=Pw(n);if(!r.pending.length){let u=!0;return e&&setTimeout(()=>{u&&e(r.loaded,r.missing,r.pending,Pf)}),()=>{u=!1}}const i=Object.create(null),o=[];let a,l;return r.pending.forEach(u=>{const{provider:d,prefix:f}=u;if(f===l&&d===a)return;a=d,l=f,o.push(fi(d,f));const p=i[d]||(i[d]=Object.create(null));p[f]||(p[f]=[])}),r.pending.forEach(u=>{const{provider:d,prefix:f,name:p}=u,v=fi(d,f),y=v.pendingIcons||(v.pendingIcons=new Set);y.has(p)||(y.add(p),i[d][f].push(p))}),o.forEach(u=>{const d=i[u.provider][u.prefix];d.length&&Vw(u,d)}),e?Rw(e,r,o):Pf};function Ww(t,e){const n={...t};for(const r in e){const i=e[r],o=typeof i;r in Ip?(i===null||i&&(o==="string"||o==="number"))&&(n[r]=i):o===typeof n[r]&&(n[r]=r==="rotate"?i%4:i)}return n}const Yw=/[\s,]+/;function Gw(t,e){e.split(Yw).forEach(n=>{switch(n.trim()){case"horizontal":t.hFlip=!0;break;case"vertical":t.vFlip=!0;break}})}function Jw(t,e=0){const n=t.replace(/^-?[0-9.]*/,"");function r(i){for(;i<0;)i+=4;return i%4}if(n===""){const i=parseInt(t);return isNaN(i)?0:r(i)}else if(n!==t){let i=0;switch(n){case"%":i=25;break;case"deg":i=90}if(i){let o=parseFloat(t.slice(0,t.length-n.length));return isNaN(o)?0:(o=o/i,o%1===0?r(o):0)}}return e}function Qw(t,e){let n=t.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in e)n+=" "+r+'="'+e[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+t+"</svg>"}function Xw(t){return t.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function Zw(t){return"data:image/svg+xml,"+Xw(t)}function $w(t){return'url("'+Zw(t)+'")'}const Lf={...Dp,inline:!1},e_={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},t_={display:"inline-block"},ql={"background-color":"currentColor"},Op={"background-color":"transparent"},Rf={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},Uf={"-webkit-mask":ql,mask:ql,background:Op};for(const t in Uf){const e=Uf[t];for(const n in Rf)e[t+"-"+n]=Rf[n]}function n_(t){return t+(t.match(/^[-0-9.]+$/)?"px":"")}function r_(t,e){const n=Ww(Lf,e),r=e.mode||"svg",i=r==="svg"?{...e_}:{};t.body.indexOf("xlink:")===-1&&delete i["xmlns:xlink"];let o=typeof e.style=="string"?e.style:"";for(let I in e){const E=e[I];if(E!==void 0)switch(I){case"icon":case"style":case"onLoad":case"mode":case"ssr":break;case"inline":case"hFlip":case"vFlip":n[I]=E===!0||E==="true"||E===1;break;case"flip":typeof E=="string"&&Gw(n,E);break;case"color":o=o+(o.length>0&&o.trim().slice(-1)!==";"?";":"")+"color: "+E+"; ";break;case"rotate":typeof E=="string"?n[I]=Jw(E):typeof E=="number"&&(n[I]=E);break;case"ariaHidden":case"aria-hidden":E!==!0&&E!=="true"&&delete i["aria-hidden"];break;default:if(I.slice(0,3)==="on:")break;Lf[I]===void 0&&(i[I]=E)}}const a=bw(t,n),l=a.attributes;if(n.inline&&(o="vertical-align: -0.125em; "+o),r==="svg"){Object.assign(i,l),o!==""&&(i.style=o);let I=0,E=e.id;return typeof E=="string"&&(E=E.replace(/-/g,"_")),{svg:!0,attributes:i,body:Sw(a.body,E?()=>E+"ID"+I++:"iconifySvelte")}}const{body:u,width:d,height:f}=t,p=r==="mask"||(r==="bg"?!1:u.indexOf("currentColor")!==-1),v=Qw(u,{...l,width:d+"",height:f+""}),b={"--svg":$w(v)},k=I=>{const E=l[I];E&&(b[I]=n_(E))};k("width"),k("height"),Object.assign(b,t_,p?ql:Op);let x="";for(const I in b)x+=I+": "+b[I]+";";return i.style=x+o,{svg:!1,attributes:i}}Cp(!0);xw("",Mw);if(typeof document<"u"&&typeof window<"u"){const t=window;if(t.IconifyPreload!==void 0){const e=t.IconifyPreload,n="Invalid IconifyPreload syntax.";typeof e=="object"&&e!==null&&(e instanceof Array?e:[e]).forEach(r=>{try{(typeof r!="object"||r===null||r instanceof Array||typeof r.icons!="object"||typeof r.prefix!="string"||!dw(r))&&console.error(n)}catch{console.error(n)}})}if(t.IconifyProviders!==void 0){const e=t.IconifyProviders;if(typeof e=="object"&&e!==null)for(let n in e){const r="IconifyProviders["+n+"] is invalid.";try{const i=e[n];if(typeof i!="object"||!i||i.resources===void 0)continue;Ew(n,i)||console.error(r)}catch{console.error(r)}}}}function i_(t,e,n,r,i){function o(){e.loading&&(e.loading.abort(),e.loading=null)}if(typeof t=="object"&&t!==null&&typeof t.body=="string")return e.name="",o(),{data:{...ta,...t}};let a;if(typeof t!="string"||(a=ea(t,!1,!0))===null)return o(),null;const l=uw(a);if(!l)return n&&(!e.loading||e.loading.name!==t)&&(o(),e.name="",e.loading={name:t,abort:zw([a],r)}),null;o(),e.name!==t&&(e.name=t,i&&!e.destroyed&&setTimeout(()=>{i(t)}));const u=["iconify"];return a.prefix!==""&&u.push("iconify--"+a.prefix),a.provider!==""&&u.push("iconify--"+a.provider),{data:l,classes:u}}function o_(t,e){return t?r_({...ta,...t},e):null}var s_=yo("<svg><!></svg>"),a_=Le("<span></span>");function lt(t,e){ht(e,!0);const n={name:"",loading:null,destroyed:!1},r=qv(e,["$$slots","$$events","$$legacy"]);let i=Ce(!1),o=Ce(0),a=Ke(()=>!!e.ssr||_(i)),l=Ke(()=>(_(o),i_(e.icon,n,_(a),d,e.onload))),u=Ke(()=>{const y=_(l)?o_(_(l).data,r):null;return y&&_(l).classes&&(y.attributes.class=(typeof r.class=="string"?r.class+" ":"")+_(l).classes.join(" ")),y});function d(){Kv(o)}Gn(()=>{X(i,!0)}),sv(()=>{n.destroyed=!0,n.loading&&(n.loading.abort(),n.loading=null)});var f=Ft(),p=ut(f);{var v=y=>{var b=Ft(),k=ut(b);{var x=E=>{var S=s_();su(S,()=>({..._(u).attributes}));var D=V(S);Wv(D,()=>_(u).body,!0),K(S),pe(E,S)},I=E=>{var S=a_();su(S,()=>({..._(u).attributes})),pe(E,S)};st(k,E=>{_(u).svg?E(x):E(I,!1)})}pe(y,b)};st(p,y=>{_(u)&&y(v)})}pe(t,f),pt()}var l_=(t,e)=>e(0),c_=(t,e)=>e(16),u_=(t,e)=>e(18),f_=(t,e)=>e(23),d_=(t,e)=>e(40),h_=Le('<div class="svelte-ziixid"><button type="button"><!></button> <button type="button">16h</button> <button type="button">18h</button> <button type="button">23h</button> <button type="button">40h</button></div>');function p_(t,e){ht(e,!0);let n=Oe(e,"value",7,0);function r(x){n(x),e.onchange&&e.onchange(n())}var i=h_(),o=V(i);o.__click=[l_,r];let a;var l=V(o);lt(l,{height:"20",icon:"stash:infinity-duotone",width:"20"}),K(o);var u=Q(o,2);u.__click=[c_,r];let d;var f=Q(u,2);f.__click=[u_,r];let p;var v=Q(f,2);v.__click=[f_,r];let y;var b=Q(v,2);b.__click=[d_,r];let k;K(i),qe((x,I,E,S,D)=>{a=at(o,1,"svelte-ziixid",null,a,x),d=at(u,1,"svelte-ziixid",null,d,I),p=at(f,1,"svelte-ziixid",null,p,E),y=at(v,1,"svelte-ziixid",null,y,S),k=at(b,1,"svelte-ziixid",null,k,D)},[()=>({selected:n()===0}),()=>({selected:n()===16}),()=>({selected:n()===18}),()=>({selected:n()===23}),()=>({selected:n()===40})]),pe(t,i),pt()}_t(["click"]);var v_=Le('<div class="hour svelte-z94qzf"></div>'),g_=Le('<div class="day svelte-z94qzf"><!></div>'),y_=Le('<p class="day svelte-z94qzf"> </p> <!>',1),m_=Le('<div class="day svelte-z94qzf"><div class="hour svelte-z94qzf"></div></div>'),b_=Le('<figure class="svelte-z94qzf"><div class="labels svelte-z94qzf"><p class="date svelte-z94qzf">Date</p> <p class="hour svelte-z94qzf">0</p> <p class="hour svelte-z94qzf">12</p> <p class="hour svelte-z94qzf">24</p></div> <div class="grid svelte-z94qzf"><!></div> <div class="average grid svelte-z94qzf"><p class="day svelte-z94qzf">Avg</p> <!></div></figure>');function w_(t,e){ht(e,!0);let n=Oe(e,"average",19,()=>[]),r=Oe(e,"daily",3,null);Oe(e,"days",3,10);function i(v){return v=new Date(v+"T00:00:00"),new Intl.DateTimeFormat(navigator.language,{month:"short",day:"numeric"}).format(v)}function o(v,y){return v===0||y[v-1]===0?(1-y[v])*100+"%":0}var a=b_(),l=Q(V(a),2),u=V(l);{var d=v=>{var y=Ft(),b=ut(y);Qt(b,17,()=>Object.keys(r()),Jt,(k,x)=>{const I=Ke(()=>r()[_(x)]);var E=y_(),S=ut(E),D=V(S,!0);K(S);var j=Q(S,2);Qt(j,16,()=>({length:24}),Jt,(O,M,ie)=>{var ne=g_(),re=V(ne);{var W=le=>{var ce=v_();let Ie;qe(De=>Ie=Qr(ce,"",Ie,De),[()=>({"margin-left":o(ie,_(I)),width:100*_(I)[ie]+"%"})]),pe(le,ce)};st(re,le=>{_(I)[ie]!==0&&le(W)})}K(ne),pe(O,ne)}),qe(O=>Re(D,O),[()=>i(_(x))]),pe(k,E)}),pe(v,y)};st(u,v=>{r()!==null&&v(d)})}K(l);var f=Q(l,2),p=Q(V(f),2);Qt(p,16,()=>({length:24}),Jt,(v,y,b)=>{var k=m_(),x=V(k);let I;K(k),qe(E=>I=Qr(x,"",I,E),[()=>({opacity:n()[b],width:"100%"})]),pe(v,k)}),K(f),K(a),pe(t,a),pt()}function __(t,e,n,r){const i=_(e).getBoundingClientRect();_(n).style.width=i.width-2+"px",X(r,!_(r))}var k_=(t,e,n)=>e(_(n)),S_=Le('<li><button type="button" class="svelte-y3d9rs"><!> <span class="svelte-y3d9rs"> </span> <!></button></li>'),x_=Le('<label class="svelte-y3d9rs"><button tabindex="0" type="button" class="svelte-y3d9rs"><!> <span class="svelte-y3d9rs"> </span> <!></button> <ul></ul></label>');function E_(t,e){ht(e,!0);let n=Oe(e,"items",19,()=>[]),r=Oe(e,"value",7,0),i=Ce(!1),o=Ce(void 0),a=Ce(void 0),l=Ke(()=>n().length>0?n()[r()].icon:""),u=Ke(()=>n().length>0?n()[r()].label:"");Gn(()=>(document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}));function d(S){!_(o).contains(S.target)&&!_(a).contains(S.target)&&X(i,!1)}function f(S){r(S.value),X(i,!1),e.onchange&&e.onchange(S)}var p=x_(),v=V(p);v.__click=[__,o,a,i];var y=V(v);lt(y,{height:"20",get icon(){return _(l)},width:"20"});var b=Q(y,2),k=V(b,!0);K(b);var x=Q(b,2);lt(x,{height:"20",icon:"material-symbols:keyboard-arrow-down-rounded",width:"20"}),K(v),yt(v,S=>X(o,S),()=>_(o));var I=Q(v,2);let E;Qt(I,21,n,Jt,(S,D)=>{var j=S_();let O;var M=V(j);M.__click=[k_,f,D];var ie=V(M);lt(ie,{height:"20",get icon(){return _(D).icon},width:"20"});var ne=Q(ie,2),re=V(ne,!0);K(ne);var W=Q(ne,2);{var le=ce=>{lt(ce,{height:"20",icon:"material-symbols:check-rounded",width:"20"})};st(W,ce=>{_(D).value===r()&&ce(le)})}K(M),K(j),qe(ce=>{O=at(j,1,"svelte-y3d9rs",null,O,ce),Re(re,_(D).label)},[()=>({selected:r()===_(D).value})]),pe(S,j)}),K(I),yt(I,S=>X(a,S),()=>_(a)),K(p),qe(S=>{Re(k,_(u)),E=at(I,1,"svelte-y3d9rs",null,E,S)},[()=>({open:_(i)})]),pe(t,p),pt()}_t(["click"]);var C_=Le('<p class="svelte-1lve2pk">0</p>'),I_=Le('<p class="svelte-1lve2pk"> </p>'),D_=Le('<p class="svelte-1lve2pk"> </p>'),T_=Le('<div class="column svelte-1lve2pk"><p class="svelte-1lve2pk"> </p></div>'),A_=Le('<div class="line svelte-1lve2pk"></div>'),O_=Le('<div class="average svelte-1lve2pk"></div>'),M_=Le('<figure class="svelte-1lve2pk"><div class="labels svelte-1lve2pk"><!></div> <div class="chart svelte-1lve2pk"><div class="labels svelte-1lve2pk"></div> <div class="columns svelte-1lve2pk"><!> <!> <!></div></div></figure>');function P_(t,e){ht(e,!0);let n=Oe(e,"average",3,0),r=Oe(e,"daily",19,()=>[]),i=Ke(()=>r().reduce((D,j)=>(D=j.volume>D?j.volume:D,D),0)),o=Ke(()=>{const D=Math.floor(_(i)+_(i)*.1);return[0,Math.round(D/4)*1,Math.round(D/4)*2,Math.round(D/4)*3,D]});function a(D){return new Intl.DateTimeFormat(navigator.language,{month:"short",day:"numeric"}).format(D)}var l=M_(),u=V(l),d=V(u);{var f=D=>{var j=C_();pe(D,j)},p=D=>{var j=Ft(),O=ut(j);Qt(O,17,()=>_(o),Jt,(M,ie)=>{const ne=Ke(()=>_(ie)===0?"0":_(ie)+" oz");var re=I_(),W=V(re,!0);K(re),qe(()=>Re(W,_(ne))),pe(M,re)}),pe(D,j)};st(d,D=>{_(i)===0?D(f):D(p,!1)})}K(u);var v=Q(u,2),y=V(v);Qt(y,21,r,Jt,(D,j)=>{var O=D_(),M=V(O,!0);K(O),qe(ie=>Re(M,ie),[()=>a(_(j).created)]),pe(D,O)}),K(y);var b=Q(y,2),k=V(b);{var x=D=>{var j=Ft(),O=ut(j);Qt(O,17,r,Jt,(M,ie)=>{var ne=T_();let re;var W=V(ne),le=V(W);K(W),K(ne),qe(ce=>{re=Qr(ne,"",re,ce),Re(le,`${_(ie).volume??""} oz`)},[()=>({width:`${_(ie).volume/Math.floor(_(i)+_(i)*.1)*100}%`})]),pe(M,ne)}),pe(D,j)};st(k,D=>{_(i)!==0&&D(x)})}var I=Q(k,2);Qt(I,16,()=>({length:4}),Jt,(D,j,O)=>{var M=A_();Ct(M,"data-value",O),Qr(M,"",{},{left:`${25*(O+1)}%`}),pe(D,M)});var E=Q(I,2);{var S=D=>{var j=O_();let O;qe(M=>{Ct(j,"data-value",n()),O=Qr(j,"",O,M)},[()=>({left:`${n()/Math.floor(_(i)+_(i)*.1)*100}%`})]),pe(D,j)};st(E,D=>{n()>0&&D(S)})}K(b),K(v),K(l),pe(t,l),pt()}var j_=(t,e)=>e(0),L_=(t,e)=>e(1),R_=(t,e)=>e(2),U_=(t,e)=>e(3),N_=yo('<text class="axis svelte-1y2p92y"> </text><path></path>',1),F_=yo('<text class="label svelte-1y2p92y"> </text>'),B_=yo('<text class="label svelte-1y2p92y"> </text>'),K_=yo('<text class="label first svelte-1y2p92y" x="40"> </text><text class="label last svelte-1y2p92y"> </text>',1),q_=Le('<figure class="svelte-1y2p92y"><div class="svelte-1y2p92y"><button type="button">Week</button> <button type="button">Month</button> <button type="button">Year</button> <button type="button">All</button></div> <svg class="svelte-1y2p92y"><!><!><path class="area svelte-1y2p92y"></path><path class="plot svelte-1y2p92y"></path></svg></figure>');function H_(t,e){ht(e,!0);let n=Oe(e,"value",19,()=>[]),r=Ce(0),i=Ce(0),o=Ce(3),a=Ke(()=>{let U=null;switch(_(o)){case 0:return _(x);case 1:return _(I);case 2:return _(E);default:U=[...n()],U.sort((Y,ve)=>Y.created.getTime()>ve.created.getTime()?1:Y.created.getTime()<ve.created.getTime()?-1:0);break}return U}),l=Ke(()=>{if(_(a).length===0)return Date.now();const U=_(a).map(Y=>Y.created.getTime());return Math.max(...U)}),u=Ke(()=>{if(_(a).length===0)return 300;const U=_(a).map(Y=>Y.weight);return Math.max(...U)}),d=Ke(()=>{if(_(a).length===0)return Date.now();const U=_(a).map(Y=>Y.created.getTime());return Math.min(...U)}),f=Ke(()=>{if(_(a).length===0)return 0;const U=_(a).map(Y=>Y.weight);return Math.min(...U)}),p=Ke(()=>_(a).length===0?300:Math.floor(_(u)*1.1)),v=Ke(()=>_(a).length===0?0:Math.floor(_(f)*.9)),y=Ke(()=>{const ve=_(r)-24;if(!_(a)||_(a).length===0)return"";let Ee=new String(_(k));return Ee+=` L ${_(i)} ${ve} L 40 ${ve} Z`}),b=Ke(()=>{const ve=_(i)-40,Ee=_(r)-24;if(!_(a)||_(a).length===0)return[];const Me=ke=>40+(ke-_(d))/(_(l)-_(d)||1)*ve,ye=ke=>(_(p)-ke)/(_(p)-_(v))*Ee;if(_(a).length===1){const ke=ye(_(a)[0].weight);return[[40,ye(_(a)[0].weight)],[_(i),ke]]}return _(a).map(ke=>[Me(ke.created.getTime()),ye(ke.weight)])}),k=Ke(()=>{if(!_(a)||_(a).length===0)return"";let U=`M ${_(b)[0][0]} ${_(b)[0][1]}`;for(let Y=1;Y<_(b).length;Y++)U+=` L ${_(b)[Y][0]} ${_(b)[Y][1]}`;return U}),x=Ke(()=>{const U=new Date;return U.setDate(U.getDate()-7),U.setHours(0),U.setMinutes(0),U.setSeconds(0),U.setMilliseconds(0),n().filter(Y=>Y.created.getTime()>U.getTime()).sort((Y,ve)=>Y.created.getTime()>ve.created.getTime()?1:Y.created.getTime()<ve.created.getTime()?-1:0)}),I=Ke(()=>{const U=new Date;return U.setDate(U.getDate()-30),U.setHours(0),U.setMinutes(0),U.setSeconds(0),U.setMilliseconds(0),n().filter(Y=>Y.created.getTime()>U.getTime()).sort((Y,ve)=>Y.created.getTime()>ve.created.getTime()?1:Y.created.getTime()<ve.created.getTime()?-1:0)}),E=Ke(()=>{const U=new Date;return U.setFullYear(U.getFullYear()-1),U.setHours(0),U.setMinutes(0),U.setSeconds(0),U.setMilliseconds(0),n().filter(Y=>Y.created.getTime()>U.getTime()).sort((Y,ve)=>Y.created.getTime()>ve.created.getTime()?1:Y.created.getTime()<ve.created.getTime()?-1:0)});Gn(()=>{const U=window.localStorage.getItem("fh_timeline");X(o,U===null?3:parseInt(U),!0)});function S(U){X(o,U,!0),window.localStorage.setItem("fh_timeline",U)}function D(U){return new Intl.DateTimeFormat(navigator.language,{month:"short",day:"numeric",year:"numeric"}).format(U)}var j=q_(),O=V(j),M=V(O);M.__click=[j_,S];let ie;var ne=Q(M,2);ne.__click=[L_,S];let re;var W=Q(ne,2);W.__click=[R_,S];let le;var ce=Q(W,2);ce.__click=[U_,S];let Ie;K(O);var De=Q(O,2),te=V(De);Qt(te,16,()=>({length:6}),Jt,(U,Y,ve)=>{const Ee=Ke(()=>ve/5),Me=Ke(()=>_(p)-_(Ee)*(_(p)-_(v))),ye=Ke(()=>_(Ee)*(_(r)-24)),ke=Ke(()=>ve===0||ve===5?null:Math.floor(_(Me)));var oe=N_(),Pe=ut(oe),Be=V(Pe,!0);K(Pe);var Se=Q(Pe);at(Se,0,"axis svelte-1y2p92y",null,{},{last:ve===5}),qe(()=>{Ct(Pe,"y",_(ye)?_(ye):0),Re(Be,_(ke)),Ct(Se,"d",`M 40 ${_(ye)===0?1:_(ye)} L ${_(i)} ${_(ye)===0?1:_(ye)}`)}),pe(U,oe)});var $=Q(te);{var se=U=>{var Y=F_(),ve=V(Y,!0);K(Y),qe(Ee=>{Ct(Y,"x",40+(_(i)-40)/2),Ct(Y,"y",_(r)-12),Re(ve,Ee)},[()=>D(new Date)]),pe(U,Y)},ge=U=>{var Y=Ft(),ve=ut(Y);{var Ee=ye=>{var ke=B_(),oe=V(ke,!0);K(ke),qe(Pe=>{Ct(ke,"x",40+(_(i)-40)/2),Ct(ke,"y",_(r)-12),Re(oe,Pe)},[()=>D(_(a)[0].created)]),pe(ye,ke)},Me=ye=>{var ke=K_(),oe=ut(ke),Pe=V(oe,!0);K(oe);var Be=Q(oe),Se=V(Be,!0);K(Be),qe((Ne,Ue)=>{Ct(oe,"y",_(r)-12),Re(Pe,Ne),Ct(Be,"x",_(i)),Ct(Be,"y",_(r)-12),Re(Se,Ue)},[()=>D(_(a)[0].created),()=>D(_(a)[_(a).length-1].created)]),pe(ye,ke)};st(ve,ye=>{_(a).length===1?ye(Ee):ye(Me,!1)},!0)}pe(U,Y)};st($,U=>{_(a).length===0?U(se):U(ge,!1)})}var _e=Q($),G=Q(_e);K(De),K(j),qe((U,Y,ve,Ee)=>{ie=at(M,1,"svelte-1y2p92y",null,ie,U),re=at(ne,1,"svelte-1y2p92y",null,re,Y),le=at(W,1,"svelte-1y2p92y",null,le,ve),Ie=at(ce,1,"svelte-1y2p92y",null,Ie,Ee),Ct(_e,"d",_(y)),Ct(G,"d",_(k))},[()=>({selected:_(o)===0}),()=>({selected:_(o)===1}),()=>({selected:_(o)===2}),()=>({selected:_(o)===3})]),lu(De,"clientWidth",U=>X(i,U)),lu(De,"clientHeight",U=>X(r,U)),pe(t,j),pt()}_t(["click"]);var V_=Le('<button class="sun svelte-1x88gms" type="button">Sunrise/sunset</button>'),z_=Le('<!> <p class="svelte-1x88gms"> </p>',1),W_=Le('<section class="svelte-1x88gms"><!> <footer class="svelte-1x88gms"><div class="daynight svelte-1x88gms"><!></div> <!></footer></section>');function Mp(t,e){ht(e,!0);let n=Oe(e,"activity",3,null),r=Oe(e,"days",3,10),i=Oe(e,"water",3,null),o=Oe(e,"weight",19,()=>[]);const a=[{icon:"material-symbols:local-fire-department-outline-rounded",label:"Fasting",value:0},{icon:"material-symbols:water-drop-outline-rounded",label:"Water",value:1},{icon:"hugeicons:weight-scale",label:"Weight",value:2}];let l=Ce(0);Gn(()=>{const D=window.localStorage.getItem("fh_graph");X(l,D===null?0:parseInt(D),!0)});function u(D){window.localStorage.setItem("fh_graph",D.value),X(l,D.value,!0)}function d(D){return new Intl.DateTimeFormat(navigator.language,{hour:"numeric",minute:"2-digit"}).format(D)}var f=W_(),p=V(f);{var v=D=>{{let j=Ke(()=>n()&&n().average?n().average:[]),O=Ke(()=>n()&&n().daily?n().daily:[]);w_(D,{get average(){return _(j)},get daily(){return _(O)},get days(){return r()}})}},y=D=>{var j=Ft(),O=ut(j);{var M=ne=>{{let re=Ke(()=>i()&&i().average?i().average:null),W=Ke(()=>i()&&i().daily?i().daily:null);P_(ne,{get average(){return _(re)},get daily(){return _(W)}})}},ie=ne=>{var re=Ft(),W=ut(re);{var le=ce=>{H_(ce,{get value(){return o()}})};st(W,ce=>{_(l)===2&&ce(le)},!0)}pe(ne,re)};st(O,ne=>{_(l)===1?ne(M):ne(ie,!1)},!0)}pe(D,j)};st(p,D=>{_(l)===0?D(v):D(y,!1)})}var b=Q(p,2),k=V(b),x=V(k);{var I=D=>{var j=V_();j.__click=function(...O){var M;(M=e.onsun)==null||M.apply(this,O)},pe(D,j)},E=D=>{var j=z_(),O=ut(j);{let ne=Ke(()=>e.sun&&e.sun.icon?e.sun.icon:null);lt(O,{height:"16",get icon(){return _(ne)},width:"16"})}var M=Q(O,2),ie=V(M,!0);K(M),qe(ne=>Re(ie,ne),[()=>e.sun&&e.sun.timing?d(e.sun.timing):""]),pe(D,j)};st(x,D=>{e.sun===null?D(I):D(E,!1)})}K(k);var S=Q(k,2);E_(S,{get items(){return a},mount:"top",onchange:D=>u(D),get value(){return _(l)}}),K(b),K(f),pe(t,f),pt()}_t(["click"]);function Y_(t,e){X(e,!_(e))}var G_=(t,e,n)=>e(_(n)),J_=Le('<li class="svelte-13e0nbd"><button type="button" class="svelte-13e0nbd"><span class="svelte-13e0nbd"> </span></button></li>'),Q_=Le('<label class="svelte-13e0nbd"><button tabindex="0" type="button" class="svelte-13e0nbd"><!> <span class="svelte-13e0nbd"> </span> <!></button> <ul></ul></label>');function X_(t,e){ht(e,!0);let n=Oe(e,"items",19,()=>[]),r=Oe(e,"value",3,5),i=Ce(!1),o=Ce(void 0),a=Ce(void 0),l=Ke(()=>n().find(S=>S.value===r()).label);Gn(()=>(document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}));function u(E){!_(o).contains(E.target)&&!_(a).contains(E.target)&&X(i,!1)}function d(E){X(i,!1),e.onchange&&e.onchange(E.value)}var f=Q_(),p=V(f);p.__click=[Y_,i];var v=V(p);lt(v,{height:"20",icon:"material-symbols:fork-spoon-rounded",width:"20"});var y=Q(v,2),b=V(y,!0);K(y);var k=Q(y,2);lt(k,{height:"20",icon:"material-symbols:keyboard-arrow-down-rounded",width:"20"}),K(p),yt(p,E=>X(o,E),()=>_(o));var x=Q(p,2);let I;Qt(x,21,n,Jt,(E,S)=>{var D=J_(),j=V(D);j.__click=[G_,d,S];var O=V(j),M=V(O,!0);K(O),K(j),K(D),qe(()=>Re(M,_(S).label)),pe(E,D)}),K(x),yt(x,E=>X(a,E),()=>_(a)),K(f),qe(E=>{Re(b,_(l)),I=at(x,1,"svelte-13e0nbd",null,I,E)},[()=>({open:_(i)})]),pe(t,f),pt()}_t(["click"]);var Z_=Le('<article><p class="svelte-1yn3hhw"><span class="svelte-1yn3hhw"> </span> <span class="units svelte-1yn3hhw">hrs</span></p> <p class="colon svelte-1yn3hhw">:</p> <p class="svelte-1yn3hhw"><span class="svelte-1yn3hhw"> </span> <span class="units svelte-1yn3hhw">min</span></p> <p class="colon svelte-1yn3hhw">:</p> <p class="svelte-1yn3hhw"><span class="svelte-1yn3hhw"> </span> <span class="units svelte-1yn3hhw">sec</span></p></article>');function $_(t,e){ht(e,!0);let n=Oe(e,"duration",3,0),r=Oe(e,"now",3,null),i=Oe(e,"started",3,null),o=Ke(()=>{let E=Math.floor((r()-i().getTime())/1e3);if(n()!==0){const S=new Date(i().getTime()+n()*36e5);E=Math.floor((S.getTime()-r())/1e3)}return E}),a=Ke(()=>{if(i()===null)return{hours:0,minutes:"00",seconds:"00"};let E=Math.floor(_(o)/3600);return E=E<0?"+"+Math.abs(E).toString(10):Math.abs(E).toString(10),{hours:E,minutes:Math.abs(Math.floor(_(o)%3600/60)).toString(10).padStart(2,"0"),seconds:Math.abs(_(o)%60).toString(10).padStart(2,"0")}});var l=Z_();let u;var d=V(l),f=V(d),p=V(f,!0);K(f),Ar(2),K(d);var v=Q(d,4),y=V(v),b=V(y,!0);K(y),Ar(2),K(v);var k=Q(v,4),x=V(k),I=V(x,!0);K(x),Ar(2),K(k),K(l),qe(E=>{u=at(l,1,"svelte-1yn3hhw",null,u,E),Re(p,_(a).hours),Re(b,_(a).minutes),Re(I,_(a).seconds)},[()=>({complete:_(o)<0})]),pe(t,l),pt()}function ek(t,e){X(e,!_(e))}var tk=(t,e,n)=>e(_(n)),nk=Le('<li class="svelte-1aqe5wr"><button type="button" class="svelte-1aqe5wr"><span class="svelte-1aqe5wr"> </span> <span class="svelte-1aqe5wr"> </span></button></li>'),rk=Le('<label class="svelte-1aqe5wr"><button tabindex="0" type="button" class="svelte-1aqe5wr"><!> <span class="svelte-1aqe5wr"> </span> <!></button> <ul></ul></label>');function ik(t,e){ht(e,!0);let n=Oe(e,"items",19,()=>[]),r=Oe(e,"units",3,"oz"),i=Oe(e,"value",3,0),o=Ce(!1),a=Ce(void 0),l=Ce(void 0);Gn(()=>(document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}));function u(E){!_(a).contains(E.target)&&!_(l).contains(E.target)&&X(o,!1)}function d(E){X(o,!1),e.onchange&&e.onchange(E.value)}var f=rk(),p=V(f);p.__click=[ek,o];var v=V(p);lt(v,{height:"20",icon:"material-symbols:water-drop-outline-rounded",width:"20"});var y=Q(v,2),b=V(y);K(y);var k=Q(y,2);lt(k,{height:"20",icon:"material-symbols:keyboard-arrow-down-rounded",width:"20"}),K(p),yt(p,E=>X(a,E),()=>_(a));var x=Q(p,2);let I;Qt(x,21,n,Jt,(E,S)=>{var D=nk(),j=V(D);j.__click=[tk,d,S];var O=V(j),M=V(O,!0);K(O);var ie=Q(O,2),ne=V(ie);K(ie),K(j),K(D),qe(()=>{Re(M,_(S).label),Re(ne,`${_(S).value??""} ${r()??""}`)}),pe(E,D)}),K(x),yt(x,E=>X(l,E),()=>_(l)),K(f),qe(E=>{Re(b,`${i()??""} ${r()??""}`),I=at(x,1,"svelte-1aqe5wr",null,I,E)},[()=>({open:_(o)})]),pe(t,f),pt()}_t(["click"]);function ok(t,e,n){e()===null?n.onstart&&n.onstart():n.onend&&n.onend()}function sk(t,e){e.onweight&&e.onweight()}var ak=Le('<p class="started ended svelte-70rgm">Your last fast ended<br/> </p>'),lk=Le('<p class="svelte-70rgm">You are not fasting.</p> <!>',1),ck=Le('<p class="svelte-70rgm">You are fasting.</p> <!> <!> <p class="started svelte-70rgm"> </p>',1),uk=Le('<section class="svelte-70rgm"><header class="svelte-70rgm"><h3 class="svelte-70rgm">Fasting</h3> <button class="icon svelte-70rgm" type="button"><!></button> <button class="icon svelte-70rgm" type="button"><!></button></header> <article class="svelte-70rgm"><!> <button class="primary svelte-70rgm" type="button"> </button></article> <div class="graph svelte-70rgm"><!></div> <footer class="svelte-70rgm"><!> <!></footer></section>');function fk(t,e){ht(e,!0);let n=Oe(e,"activity",3,null),r=Oe(e,"duration",3,0),i=Oe(e,"ended",3,null),o=Oe(e,"hunger",3,5),a=Oe(e,"levels",19,()=>[]),l=Oe(e,"now",3,null),u=Oe(e,"started",3,null),d=Oe(e,"sun",3,null),f=Oe(e,"volume",3,null),p=Oe(e,"volumes",19,()=>[]),v=Oe(e,"water",3,0),y=Oe(e,"weight",19,()=>[]);function b(te){return te===null?null:new Intl.DateTimeFormat(navigator.language,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}).format(te)}var k=uk(),x=V(k),I=Q(V(x),2);I.__click=[sk,e];var E=V(I);lt(E,{height:"20",icon:"hugeicons:weight-scale",width:"20"}),K(I);var S=Q(I,2);S.__click=function(...te){var $;($=e.onsettings)==null||$.apply(this,te)};var D=V(S);lt(D,{height:"20",icon:"material-symbols:person-outline-rounded",width:"20"}),K(S),K(x);var j=Q(x,2),O=V(j);{var M=te=>{var $=lk(),se=Q(ut($),2);{var ge=_e=>{var G=ak(),U=Q(V(G),2,!0);K(G),qe(Y=>Re(U,Y),[()=>b(i())]),pe(_e,G)};st(se,_e=>{i()!==null&&_e(ge)})}pe(te,$)},ie=te=>{var $=ck(),se=Q(ut($),2);$_(se,{get duration(){return r()},get now(){return l()},get started(){return u()}});var ge=Q(se,2);p_(ge,{get onchange(){return e.onduration},get value(){return r()}});var _e=Q(ge,2),G=V(_e);K(_e),qe(U=>Re(G,`Started ${U??""}`),[()=>b(u())]),pe(te,$)};st(O,te=>{u()===null?te(M):te(ie,!1)})}var ne=Q(O,2);ne.__click=[ok,u,e];var re=V(ne);K(ne),K(j);var W=Q(j,2),le=V(W);Mp(le,{get activity(){return n()},days:7,get onsun(){return e.onsun},get sun(){return d()},get water(){return f()},get weight(){return y()}}),K(W);var ce=Q(W,2),Ie=V(ce);X_(Ie,{get items(){return a()},get onchange(){return e.onhunger},get value(){return o()}});var De=Q(Ie,2);ik(De,{get items(){return p()},get onchange(){return e.onwater},get value(){return v()}}),K(ce),K(k),qe(()=>Re(re,`${u()===null?"Start":"Stop"} fasting`)),pe(t,k),pt()}_t(["click"]);function dk(t,e,n,r){const i=new Date(parseInt(t.currentTarget.getAttribute("data-year")),parseInt(t.currentTarget.getAttribute("data-month")),parseInt(t.currentTarget.getAttribute("data-date")));i.getMonth()!==e().getMonth()&&e(new Date(i.getTime())),n(new Date(i.getTime())),r.onchange&&r.onchange(n())}var hk=Le('<button type="button"> </button>'),pk=Le('<section><header class="svelte-1ll096s"><h3 class="svelte-1ll096s"> </h3> <button type="button" class="svelte-1ll096s"><!></button> <button type="button" class="svelte-1ll096s"><!></button></header> <article class="svelte-1ll096s"><p class="svelte-1ll096s">Sun</p> <p class="svelte-1ll096s">Mon</p> <p class="svelte-1ll096s">Tue</p> <p class="svelte-1ll096s">Wed</p> <p class="svelte-1ll096s">Thu</p> <p class="svelte-1ll096s">Fri</p> <p class="svelte-1ll096s">Sat</p></article> <article class="svelte-1ll096s"></article></section>');function vk(t,e){ht(e,!0);let n=Oe(e,"display",23,()=>new Date),r=Oe(e,"value",23,()=>new Date),i=Ke(()=>new Intl.DateTimeFormat(navigator.language,{month:"long",year:"numeric"}).format(n())),o=Ke(()=>{const I=[],E=new Date,S=new Date(n().getFullYear(),n().getMonth(),1);S.setDate(S.getDate()-S.getDay());for(let D=0;D<42;D++){const j={date:S.getDate(),month:S.getMonth(),year:S.getFullYear(),outside:!0,today:!1,selected:!1,after:!1};S.getFullYear()===n().getFullYear()&&S.getMonth()===n().getMonth()&&(j.outside=!1),S.getTime()>Date.now()&&(j.after=!0),S.getFullYear()===E.getFullYear()&&S.getMonth()===E.getMonth()&&S.getDate()===E.getDate()&&(j.today=!0),S.getFullYear()===r().getFullYear()&&S.getMonth()===r().getMonth()&&S.getDate()===r().getDate()&&(j.selected=!0),S.setDate(S.getDate()+1),I.push(j)}return I});function a(){let I=n().getMonth(),E=n().getFullYear();E=I===0?E-1:E,I=I===0?11:I-1,n(new Date(E,I,n().getDate()))}function l(){let I=n().getMonth(),E=n().getFullYear();E=I===11?E+1:E,I=(I+1)%12,n(new Date(E,I,n().getDate()))}var u=pk(),d=V(u),f=V(d),p=V(f,!0);K(f);var v=Q(f,2);v.__click=a;var y=V(v);lt(y,{height:"24",icon:"material-symbols:navigate-before",width:"24"}),K(v);var b=Q(v,2);b.__click=l;var k=V(b);lt(k,{height:"24",icon:"material-symbols:navigate-next",width:"24"}),K(b),K(d);var x=Q(d,4);Qt(x,21,()=>_(o),Jt,(I,E)=>{var S=hk();S.__click=[dk,n,r,e];let D;var j=V(S,!0);K(S),qe(O=>{Ct(S,"data-year",_(E).year),Ct(S,"data-month",_(E).month),Ct(S,"data-date",_(E).date),S.disabled=_(E).after,D=at(S,1,"svelte-1ll096s",null,D,O),Re(j,_(E).date)},[()=>({outside:_(E).outside,today:_(E).today,selected:_(E).selected})]),pe(I,S)}),K(x),K(u),qe(()=>Re(p,_(i))),pe(t,u),pt()}_t(["click"]);function gk(t,e,n){const r=new Date(e().getTime());r.getHours()>=12?r.getHours()===12?r.setHours(23):r.setHours(r.getHours()-1):r.getHours()===0?r.setHours(11):r.setHours(r.getHours()-1),e(new Date(r.getTime())),n.onchange&&n.onchange(e())}function yk(t,e,n){const r=new Date(e().getTime());r.getHours()>=12?r.getHours()===23?r.setHours(12):r.setHours(r.getHours()+1):r.getHours()===11?r.setHours(0):r.setHours(r.getHours()+1),e(new Date(r.getTime())),n.onchange&&n.onchange(e())}function mk(t,e,n){const r=new Date(e().getTime());r.getHours()>=12&&r.setHours(r.getHours()-12),e(new Date(r.getTime())),n.onchange&&n.onchange(e())}function bk(t,e,n){const r=new Date(e().getTime());r.getHours()<12&&r.setHours(r.getHours()+12),e(new Date(r.getTime())),n.onchange&&n.onchange(e())}function wk(t,e,n){const r=new Date(e().getTime());r.getMinutes()===0?r.setMinutes(59):r.setMinutes(r.getMinutes()-1),e(new Date(r.getTime())),n.onchange&&n.onchange(e())}function _k(t,e,n){const r=new Date(e().getTime());r.getMinutes()===59?r.setMinutes(0):r.setMinutes(r.getMinutes()+1),e(new Date(r.getTime())),n.onchange&&n.onchange(e())}var kk=Le('<article class="svelte-1bevvpj"><div class="time svelte-1bevvpj"><div class="dial svelte-1bevvpj"><button type="button" class="svelte-1bevvpj"><!></button> <p class="svelte-1bevvpj"> </p> <button type="button" class="svelte-1bevvpj"><!></button></div> <p class="svelte-1bevvpj">:</p> <div class="dial svelte-1bevvpj"><button type="button" class="svelte-1bevvpj"><!></button> <p class="svelte-1bevvpj"> </p> <button type="button" class="svelte-1bevvpj"><!></button></div></div> <div class="meridian svelte-1bevvpj"><button type="button">AM</button> <button type="button">PM</button></div></article>');function Sk(t,e){ht(e,!0);let n=Oe(e,"value",23,()=>new Date),r=Ke(()=>n().getHours()%12||12),i=Ke(()=>n().getMinutes().toString(10).padStart(2,"0")),o=Ke(()=>n().getHours()>=12?"PM":"AM");var a=kk(),l=V(a),u=V(l),d=V(u);d.__click=[yk,n,e];var f=V(d);lt(f,{height:"24",icon:"material-symbols:keyboard-arrow-up-rounded",width:"24"}),K(d);var p=Q(d,2),v=V(p,!0);K(p);var y=Q(p,2);y.__click=[gk,n,e];var b=V(y);lt(b,{height:"24",icon:"material-symbols:keyboard-arrow-down-rounded",width:"24"}),K(y),K(u);var k=Q(u,4),x=V(k);x.__click=[_k,n,e];var I=V(x);lt(I,{height:"24",icon:"material-symbols:keyboard-arrow-up-rounded",width:"24"}),K(x);var E=Q(x,2),S=V(E,!0);K(E);var D=Q(E,2);D.__click=[wk,n,e];var j=V(D);lt(j,{height:"24",icon:"material-symbols:keyboard-arrow-down-rounded",width:"24"}),K(D),K(k),K(l);var O=Q(l,2),M=V(O);M.__click=[mk,n,e];let ie;var ne=Q(M,2);ne.__click=[bk,n,e];let re;K(O),K(a),qe((W,le)=>{Re(v,_(r)),Re(S,_(i)),ie=at(M,1,"svelte-1bevvpj",null,ie,W),re=at(ne,1,"svelte-1bevvpj",null,re,le)},[()=>({selected:_(o)==="AM"}),()=>({selected:_(o)==="PM"})]),pe(t,a),pt()}_t(["click"]);function xk(t,e){X(e,"calendar")}function Ek(t,e){X(e,"clock")}var Ck=Le('<article class="svelte-1tr6oad"><header class="svelte-1tr6oad"><button type="button"><p class="svelte-1tr6oad"> </p> <p class="svelte-1tr6oad"> </p></button> <button type="button"><p class="svelte-1tr6oad"> </p></button></header> <!></article>');function na(t,e){ht(e,!0);let n=Oe(e,"value",23,()=>new Date),r=Ce("calendar");function i(M){return new Intl.DateTimeFormat(navigator.language,{month:"short",day:"numeric"}).format(M)}function o(M){return new Intl.DateTimeFormat(navigator.language,{hour:"numeric",minute:"2-digit"}).format(M)}function a(M){M.setHours(n().getHours()),M.setMinutes(n().getMinutes()),M.setSeconds(n().getSeconds()),n(new Date(M.getTime())),e.onchange&&e.onchange(n())}function l(M){M.setFullYear(n().getFullYear()),M.getMonth(n().getMonth()),M.getDate(n().getDate()),n(new Date(M.getTime())),e.onchange&&e.onchange(n())}var u=Ck(),d=V(u),f=V(d);f.__click=[xk,r];let p;var v=V(f),y=V(v,!0);K(v);var b=Q(v,2),k=V(b,!0);K(b),K(f);var x=Q(f,2);x.__click=[Ek,r];let I;var E=V(x),S=V(E,!0);K(E),K(x),K(d);var D=Q(d,2);{var j=M=>{vk(M,{onchange:a,get value(){return n()}})},O=M=>{Sk(M,{onchange:l,get value(){return n()}})};st(D,M=>{_(r)===null||_(r)==="calendar"?M(j):M(O,!1)})}K(u),qe((M,ie,ne,re)=>{p=at(f,1,"svelte-1tr6oad",null,p,M),Re(y,e.label),Re(k,ie),I=at(x,1,"svelte-1tr6oad",null,I,ne),Re(S,re)},[()=>({selected:_(r)==="calendar"}),()=>i(n()),()=>({selected:_(r)==="clock"}),()=>o(n())]),pe(t,u),pt()}_t(["click"]);function Ik(t,e,n,r){e(),n(null),r.oncancel&&r.oncancel()}function Dk(t,e,n,r){e.ondelete&&e.ondelete(n(),r().id)}function Tk(t,e){const n=t.currentTarget.value.trim().length===0?null:t.currentTarget.value;e({...e(),notes:n})}function Ak(t,e,n){e.onsave&&e.onsave(n())}var Ok=Le('<dialog class="svelte-13glclx"><h3 class="svelte-13glclx"> </h3> <!> <textarea placeholder="Notes" class="svelte-13glclx"></textarea> <footer class="svelte-13glclx"><button class="delete svelte-13glclx" type="button">Delete</button> <button class="cancel svelte-13glclx" type="button">Cancel</button> <button type="button" class="svelte-13glclx">Save</button></footer></dialog>');function Mk(t,e){ht(e,!0);let n=Oe(e,"field",3,"started"),r=Oe(e,"item",7,null),i=Oe(e,"label",3,"Started"),o=Oe(e,"title",3,"Edit Fast Start"),a=Ce(void 0);function l(S){const D={...r()};D[n()]=new Date(S.getTime()),r({...D})}function u(){_(a).close()}function d(){_(a).showModal()}var f=Ok(),p=V(f),v=V(p,!0);K(p);var y=Q(p,2);{let S=Ke(()=>r()&&r().id&&r().id!==null?r()[n()]:new Date);na(y,{get label(){return i()},onchange:l,get value(){return _(S)}})}var b=Q(y,2);Yf(b),b.__input=[Tk,r];var k=Q(b,2),x=V(k);x.__click=[Dk,e,n,r];var I=Q(x,2);I.__click=[Ik,u,r,e];var E=Q(I,2);return E.__click=[Ak,e,r],K(k),K(f),yt(f,S=>X(a,S),()=>_(a)),qe(()=>{Re(v,o()),Zf(b,r()&&r().id&&r().id!==null?r().notes:"")}),pe(t,f),pt({close:u,showModal:d})}_t(["input","click"]);var Pk=Le('<article class="svelte-1vxkmhw"><p class="svelte-1vxkmhw">Your fasting history<br/>will be displayed here.</p></article>'),jk=Le('<li class="header svelte-1vxkmhw"><p class="svelte-1vxkmhw"> </p></li>'),Lk=(t,e,n)=>e(_(n).type,_(n).id),Rk=Le('<p class="svelte-1vxkmhw">Started Fast</p> <p class="svelte-1vxkmhw"></p> <p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"> </p>',1),Uk=Le('<p class="svelte-1vxkmhw">Water</p> <p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"> </p>',1),Nk=Le('<p class="svelte-1vxkmhw">Weight</p> <p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"> </p>',1),Fk=Le('<p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"></p> <p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"> </p>',1),Bk=Le('<p class="svelte-1vxkmhw">Ended Fast</p> <p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"> </p> <p class="svelte-1vxkmhw"> </p>',1),Kk=Le('<li class="svelte-1vxkmhw"><button type="button" class="svelte-1vxkmhw"><!></button></li>'),qk=Le('<ul class="svelte-1vxkmhw"></ul>');function Hk(t,e){ht(e,!0);let n=Oe(e,"items",19,()=>[]);function r(y){return new Intl.DateTimeFormat(navigator.language,{month:"short",day:"numeric",year:"numeric"}).format(y)}function i(y,b){const k=b.getTime()-y.getTime(),x=Math.floor(k/1e3),I=Math.floor(x/3600),E=Math.floor(x%3600/60);return new Intl.DurationFormat(navigator.language,{style:"short",units:["hour","minute"]}).format({hours:I,minutes:E})}function o(y){return new Intl.DateTimeFormat(navigator.language,{weekday:"long",month:"short",day:"numeric"}).format(y)}function a(y){return new Intl.NumberFormat(navigator.language).format(y)}function l(y){return new Intl.DateTimeFormat(navigator.language,{hour:"numeric",minute:"2-digit"}).format(y)}function u(y,b){e.onchange&&e.onchange(y,b)}var d=Ft(),f=ut(d);{var p=y=>{var b=Pk();pe(y,b)},v=y=>{var b=qk();Qt(b,21,n,Jt,(k,x)=>{var I=Ft(),E=ut(I);{var S=j=>{var O=jk(),M=V(O),ie=V(M,!0);K(M),K(O),qe(ne=>Re(ie,ne),[()=>o(_(x).timed)]),pe(j,O)},D=j=>{var O=Kk(),M=V(O);M.__click=[Lk,u,x];var ie=V(M);{var ne=W=>{var le=Rk(),ce=Q(ut(le),4),Ie=V(ce,!0);K(ce);var De=Q(ce,2),te=V(De,!0);K(De),qe(($,se)=>{Re(Ie,$),Re(te,se)},[()=>r(_(x).timed),()=>l(_(x).timed)]),pe(W,le)},re=W=>{var le=Ft(),ce=ut(le);{var Ie=te=>{var $=Uk(),se=Q(ut($),2),ge=V(se);K(se);var _e=Q(se,2),G=V(_e,!0);K(_e);var U=Q(_e,2),Y=V(U,!0);K(U),qe((ve,Ee)=>{Re(ge,`${_(x).volume??""} oz`),Re(G,ve),Re(Y,Ee)},[()=>r(_(x).timed),()=>l(_(x).timed)]),pe(te,$)},De=te=>{var $=Ft(),se=ut($);{var ge=G=>{var U=Nk(),Y=Q(ut(U),2),ve=V(Y);K(Y);var Ee=Q(Y,2),Me=V(Ee,!0);K(Ee);var ye=Q(Ee,2),ke=V(ye,!0);K(ye),qe((oe,Pe,Be)=>{Re(ve,`${oe??""} ${_(x).units??""}`),Re(Me,Pe),Re(ke,Be)},[()=>a(_(x).weight),()=>r(_(x).timed),()=>l(_(x).timed)]),pe(G,U)},_e=G=>{var U=Ft(),Y=ut(U);{var ve=Me=>{var ye=Fk(),ke=ut(ye),oe=V(ke,!0);K(ke);var Pe=Q(ke,4),Be=V(Pe,!0);K(Pe);var Se=Q(Pe,2),Ne=V(Se,!0);K(Se),qe((Ue,Ve)=>{Re(oe,_(x).level),Re(Be,Ue),Re(Ne,Ve)},[()=>r(_(x).timed),()=>l(_(x).timed)]),pe(Me,ye)},Ee=Me=>{var ye=Ft(),ke=ut(ye);{var oe=Pe=>{var Be=Bk(),Se=Q(ut(Be),2),Ne=V(Se,!0);K(Se);var Ue=Q(Se,2),Ve=V(Ue,!0);K(Ue);var mt=Q(Ue,2),kt=V(mt,!0);K(mt),qe((vt,Yt,Xt)=>{Re(Ne,vt),Re(Ve,Yt),Re(kt,Xt)},[()=>i(_(x).started,_(x).ended),()=>r(_(x).timed),()=>l(_(x).timed)]),pe(Pe,Be)};st(ke,Pe=>{_(x).type==="end"&&Pe(oe)},!0)}pe(Me,ye)};st(Y,Me=>{_(x).type==="hunger"?Me(ve):Me(Ee,!1)},!0)}pe(G,U)};st(se,G=>{_(x).type==="weight"?G(ge):G(_e,!1)},!0)}pe(te,$)};st(ce,te=>{_(x).type==="water"?te(Ie):te(De,!1)},!0)}pe(W,le)};st(ie,W=>{_(x).type==="start"?W(ne):W(re,!1)})}K(M),K(O),pe(j,O)};st(E,j=>{_(x).type==="header"?j(S):j(D,!1)})}pe(k,I)}),K(b),pe(y,b)};st(f,y=>{n().length===0?y(p):y(v,!1)})}pe(t,d),pt()}_t(["click"]);var Vk=Le('<section class="svelte-1moll0f"><header class="svelte-1moll0f"><h3 class="svelte-1moll0f">Hours</h3></header> <div class="svelte-1moll0f"><!></div> <article class="svelte-1moll0f"><!></article></section>');function zk(t,e){let n=Oe(e,"activity",3,null),r=Oe(e,"history",19,()=>[]);Oe(e,"levels",19,()=>[]);let i=Oe(e,"sun",3,null);var o=Vk(),a=Q(V(o),2),l=V(a);Mp(l,{get activity(){return n()},days:7,get onsun(){return e.onsun},get sun(){return i()},get water(){return e.volume},get weight(){return e.weight}}),K(a);var u=Q(a,2),d=V(u);Hk(d,{get items(){return r()},get onchange(){return e.onchange}}),K(u),K(o),pe(t,o)}function Wk(t,e,n,r){const i=_(e).getBoundingClientRect();_(n).style.width=i.width-2+"px",X(r,!_(r))}var Yk=(t,e,n)=>e(_(n)),Gk=Le('<li><button type="button" class="svelte-5n0me"><span class="svelte-5n0me"> </span> <!></button></li>'),Jk=Le('<label class="svelte-5n0me"><button tabindex="-1" type="button" class="svelte-5n0me"><!> <span class="svelte-5n0me"> </span> <!></button> <ul></ul></label>');function Qk(t,e){ht(e,!0);let n=Oe(e,"items",19,()=>[]),r=Oe(e,"value",7,0),i=Ce(!1),o=Ce(void 0),a=Ce(void 0),l=Ke(()=>n().length===0?"":n().find(S=>S.value===r()).label);Gn(()=>(document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}));function u(E){!_(o).contains(E.target)&&!_(a).contains(E.target)&&X(i,!1)}function d(E){r(E.value),X(i,!1),e.onchange&&e.onchange(E.value)}var f=Jk(),p=V(f);p.__click=[Wk,o,a,i];var v=V(p);lt(v,{height:"20",icon:"material-symbols:fork-spoon-rounded",width:"20"});var y=Q(v,2),b=V(y,!0);K(y);var k=Q(y,2);lt(k,{height:"20",icon:"material-symbols:keyboard-arrow-down-rounded",width:"20"}),K(p),yt(p,E=>X(o,E),()=>_(o));var x=Q(p,2);let I;Qt(x,21,n,Jt,(E,S)=>{var D=Gk();let j;var O=V(D);O.__click=[Yk,d,S];var M=V(O),ie=V(M,!0);K(M);var ne=Q(M,2);{var re=W=>{lt(W,{height:"20",icon:"material-symbols:check-rounded",width:"20"})};st(ne,W=>{_(S).value===r()&&W(re)})}K(O),K(D),qe(W=>{j=at(D,1,"svelte-5n0me",null,j,W),Re(ie,_(S).label)},[()=>({selected:r()===_(S).value})]),pe(E,D)}),K(x),yt(x,E=>X(a,E),()=>_(a)),K(f),qe(E=>{Re(b,_(l)),I=at(x,1,"svelte-5n0me",null,I,E)},[()=>({open:_(i)})]),pe(t,f),pt()}_t(["click"]);function Xk(t,e,n,r){e(),n(null),r.oncancel&&r.oncancel()}function Zk(t,e,n){e.ondelete&&e.ondelete(n().id)}function $k(t,e,n){e.onsave&&e.onsave(n())}var e1=Le('<dialog class="svelte-1hqchgg"><h3 class="svelte-1hqchgg">Edit Hunger</h3> <!> <!> <footer class="svelte-1hqchgg"><button class="delete svelte-1hqchgg" type="button">Delete</button> <button class="cancel svelte-1hqchgg" type="button">Cancel</button> <button type="button" class="svelte-1hqchgg">Save</button></footer></dialog>');function t1(t,e){ht(e,!0);let n=Oe(e,"item",7,null),r=Oe(e,"levels",19,()=>[]),i=Ce(void 0),o=Ke(()=>n()&&n().level&&n().level!==null?n().level:5);function a(I){const E=new Date(I.getTime());n({...n(),created:E})}function l(I){const E=I;n({...n(),level:E})}function u(){_(i).close(),n(null)}function d(){_(i).showModal()}var f=e1(),p=Q(V(f),2);Qk(p,{get items(){return r()},onchange:l,get value(){return _(o)}});var v=Q(p,2);{let I=Ke(()=>n()&&n().created?n().created:new Date);na(v,{label:"Checked",onchange:a,get value(){return _(I)}})}var y=Q(v,2),b=V(y);b.__click=[Zk,e,n];var k=Q(b,2);k.__click=[Xk,u,n,e];var x=Q(k,2);return x.__click=[$k,e,n],K(y),K(f),yt(f,I=>X(i,I),()=>_(i)),pe(t,f),pt({close:u,showModal:d})}_t(["click"]);function n1(t,e,n){e()!==0&&(e(0),n.onchange&&n.onchange(e()))}function r1(t,e,n){e()!==1&&(e(1),n.onchange&&n.onchange(e()))}var i1=Le('<ul class="svelte-tu3q0a"><li><button type="button">Fasting</button></li> <li><button type="button">Hours</button></li></ul>');function o1(t,e){ht(e,!0);let n=Oe(e,"value",7,0);var r=i1(),i=V(r),o=V(i);let a;o.__click=[n1,n,e],K(i);var l=Q(i,2),u=V(l);let d;u.__click=[r1,n,e],K(l),K(r),qe((f,p)=>{a=at(o,1,"fasting svelte-tu3q0a",null,a,f),d=at(u,1,"hours svelte-tu3q0a",null,d,p)},[()=>({selected:n()===0}),()=>({selected:n()===1})]),pe(t,r),pt()}_t(["click"]);function s1(t,e,n,r){e(""),X(n,!1),r.oncancel&&r.oncancel()}function a1(t,e,n,r){e(""),X(n,!1),r.ondone&&r.ondone()}function l1(t,e,n,r,i){if(e().trim().length===0){X(n,!0),_(r).focus();return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e())){X(n,!0),_(r).focus();return}X(n,!1),i.onverify&&i.onverify(e())}var c1=Le('<section class="svelte-gtv1v9"><figure class="svelte-gtv1v9"><button type="button" class="svelte-gtv1v9"><!></button> <div class="svelte-gtv1v9"><h3 class="svelte-gtv1v9">Thank you!</h3> <p class="svelte-gtv1v9">Thank you for being a valued member of the Fasting Hours community, and for supporting future development.</p></div></figure> <form class="svelte-gtv1v9"><div class="svelte-gtv1v9"><p>Email address</p> <input type="text" class="svelte-gtv1v9"/></div></form> <footer class="svelte-gtv1v9"><button class="cancel svelte-gtv1v9" type="button">Cancel</button> <button type="button" class="svelte-gtv1v9">Verify</button></footer></section>');function u1(t,e){ht(e,!0);let n=Oe(e,"disabled",3,!1),r=Oe(e,"email",7,null),i=Ce(!1),o=Ce(void 0);var a=c1(),l=V(a),u=V(l);u.__click=[a1,r,i,e];var d=V(u);lt(d,{height:"24",icon:"material-symbols:cancel-rounded",width:"24"}),K(u),Ar(2),K(l);var f=Q(l,2),p=V(f),v=V(p);let y;var b=Q(v,2);Us(b),yt(b,E=>X(o,E),()=>_(o)),K(p),K(f);var k=Q(f,2),x=V(k);x.__click=[s1,r,i,e];var I=Q(x,2);I.__click=[l1,r,i,o,e],K(k),K(a),qe(E=>{y=at(v,1,"svelte-gtv1v9",null,y,E),b.disabled=n(),x.disabled=n(),I.disabled=n()},[()=>({error:_(i)})]),vs(b,r),pe(t,a),pt()}_t(["click"]);function f1(t,e){e.ondone&&e.ondone()}function d1(t,e){e.onexport&&e.onexport()}function h1(t,e){const n=event.target.files[0],r=new FileReader;r.addEventListener("load",i=>{const o=JSON.parse(i.target.result);e.onimport&&e.onimport(o)}),r.readAsText(n)}function p1(t,e){_(e).click()}function v1(t,e){e.onlogout&&e.onlogout()}var g1=Le('<section class="svelte-1oua0go"><figure class="svelte-1oua0go"><button type="button" class="svelte-1oua0go"><!></button> <div class="svelte-1oua0go"><h3 class="svelte-1oua0go">Thank you!</h3> <p class="svelte-1oua0go">Your support means everything to a solo developer like me. All the best in your fasting journey.</p></div></figure> <article class="svelte-1oua0go"><input accept=".json" type="file" class="svelte-1oua0go"/> <button class="cancel svelte-1oua0go" type="button">Export data</button> <button class="cancel svelte-1oua0go" type="button">Import data</button> <button type="button" class="svelte-1oua0go">Logout</button></article></section>');function y1(t,e){ht(e,!0);let n=Ce(void 0);var r=g1(),i=V(r),o=V(i);o.__click=[f1,e];var a=V(o);lt(a,{height:"24",icon:"material-symbols:cancel-rounded",width:"24"}),K(o),Ar(2),K(i);var l=Q(i,2),u=V(l);u.__change=[h1,e],yt(u,v=>X(n,v),()=>_(n));var d=Q(u,2);d.__click=[d1,e];var f=Q(d,2);f.__click=[p1,n];var p=Q(f,2);p.__click=[v1,e],K(l),K(r),pe(t,r),pt()}_t(["click","change"]);function m1(t,e,n,r){e(""),n(""),r.ondone&&r.ondone()}function b1(t,e){e.onlogin&&e.onlogin()}function w1(t,e,n,r,i,o,a,l){if(e().trim().length===0){X(n,!0),_(r).focus();return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e())){X(n,!0),_(r).focus();return}if(X(n,!1),i().trim().length===0){X(o,!0),_(a).focus();return}X(o,!1),l.onsend&&l.onsend({email:e(),message:i()})}var _1=Le('<section class="svelte-cr8czn"><figure class="svelte-cr8czn"><button type="button" class="svelte-cr8czn"><!></button> <div class="svelte-cr8czn"><h3 class="svelte-cr8czn">Fasting Hours</h3> <p class="svelte-cr8czn">Want more features?</p> <ul class="svelte-cr8czn"><li class="svelte-cr8czn">Automated backup</li> <li class="svelte-cr8czn">Sync across devices</li> <li class="svelte-cr8czn">Export/import data</li></ul> <p class="svelte-cr8czn">Send me a message with the login email address that you would like to use. The first ten messages get a lifetime account for <span class="svelte-cr8czn">FREE</span>.</p></div></figure> <form class="svelte-cr8czn"><div class="svelte-cr8czn"><p>Email address</p> <input type="text" class="svelte-cr8czn"/></div> <div class="svelte-cr8czn"><p>Message</p> <textarea class="svelte-cr8czn"></textarea></div></form> <footer class="svelte-cr8czn"><button class="login svelte-cr8czn" type="button">Login</button> <button type="button" class="svelte-cr8czn">Send</button></footer></section>');function k1(t,e){ht(e,!0);let n=Oe(e,"disabled",3,!1),r=Oe(e,"email",7,null),i=Oe(e,"message",7,null),o=Ce(!1),a=Ce(void 0),l=Ce(!1),u=Ce(void 0);var d=_1(),f=V(d),p=V(f);p.__click=[m1,r,i,e];var v=V(p);lt(v,{height:"24",icon:"material-symbols:cancel-rounded",width:"24"}),K(p),Ar(2),K(f);var y=Q(f,2),b=V(y),k=V(b);let x;var I=Q(k,2);Us(I),yt(I,ne=>X(a,ne),()=>_(a)),K(b);var E=Q(b,2),S=V(E);let D;var j=Q(S,2);Yf(j),yt(j,ne=>X(u,ne),()=>_(u)),K(E),K(y);var O=Q(y,2),M=V(O);M.__click=[b1,e];var ie=Q(M,2);ie.__click=[w1,r,o,a,i,l,u,e],K(O),K(d),qe((ne,re)=>{x=at(k,1,"svelte-cr8czn",null,x,ne),I.disabled=n(),D=at(S,1,"svelte-cr8czn",null,D,re),j.disabled=n(),M.disabled=n(),ie.disabled=n()},[()=>({error:_(o)}),()=>({error:_(l)})]),vs(I,r),vs(j,i),pe(t,d),pt()}_t(["click"]);function S1(t,e,n,r){e(""),X(n,!1),r.oncancel&&r.oncancel()}function x1(t,e,n,r){e(""),X(n,!1),r.ondone&&r.ondone()}function E1(t,e,n,r,i){if(e().trim().length===0){X(n,!0),_(r).focus();return}X(n,!1),i.onlogin&&i.onlogin(e())}var C1=Le('<section class="svelte-1rh2cl1"><figure class="svelte-1rh2cl1"><button type="button" class="svelte-1rh2cl1"><!></button> <div class="svelte-1rh2cl1"><h3 class="svelte-1rh2cl1">Check your email</h3> <p class="svelte-1rh2cl1">A one-time password has been sent to the email address you provided. You will remain logged in on this device as long as you visit within 30 days (rolling).</p></div></figure> <form class="svelte-1rh2cl1"><div class="svelte-1rh2cl1"><p>One-time password</p> <input type="text" class="svelte-1rh2cl1"/></div></form> <footer class="svelte-1rh2cl1"><button class="cancel svelte-1rh2cl1" type="button">Cancel</button> <button type="button" class="svelte-1rh2cl1">Login</button></footer></section>');function I1(t,e){ht(e,!0);let n=Oe(e,"disabled",3,!1),r=Oe(e,"value",7,null),i=Ce(!1),o=Ce(void 0);var a=C1(),l=V(a),u=V(l);u.__click=[x1,r,i,e];var d=V(u);lt(d,{height:"24",icon:"material-symbols:cancel-rounded",width:"24"}),K(u),Ar(2),K(l);var f=Q(l,2),p=V(f),v=V(p);let y;var b=Q(v,2);Us(b),yt(b,E=>X(o,E),()=>_(o)),K(p),K(f);var k=Q(f,2),x=V(k);x.__click=[S1,r,i,e];var I=Q(x,2);I.__click=[E1,r,i,o,e],K(k),K(a),qe(E=>{y=at(v,1,"svelte-1rh2cl1",null,y,E),b.disabled=n(),x.disabled=n(),I.disabled=n()},[()=>({error:_(i)})]),vs(b,r),pe(t,a),pt()}_t(["click"]);var D1=Le('<dialog class="svelte-1jngsku"><!></dialog>');function T1(t,e){ht(e,!0);let n=Oe(e,"authenticated",7,!1);const r=new wp;r.ui().subscribe($=>{$&&$.type&&$.type==="otp"&&(i=$.onSubmit)});let i=null,o=Ce(void 0),a=Ce(!1),l=Ce(""),u=Ce("signup"),d=Ce(!1),f=Ce(""),p=Ce(""),v=Ce(!1),y=Ce("");function b(){X(u,"signup"),X(a,!1)}function k(){W()}function x($){X(l,$,!0),X(a,!0),r.check($).then(se=>se.json()).then(se=>{se===null?(X(a,!1),alert("User not found.")):(r.verify($),X(u,"token"),X(a,!1))})}function I(){W()}async function E(){const $={history:await r.browseHistory(),hunger:await r.browseHunger(),water:await r.browseWater(),weight:await r.browseWeight()},se=JSON.stringify($,null,2),ge=new Blob([se],{type:"application/json"}),_e=URL.createObjectURL(ge),G=document.createElement("a");G.href=_e,G.download="fasting-hours.json",document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(_e)}async function S($){console.log("IMPORT"),console.log($),$.history.length>0&&await r.bulkHistory($.history),$.hunger.length>0&&await r.bulkHunger($.hunger),$.water.length>0&&await r.bulkWater($.water),$.weight.length>0&&await r.bulkWeight($.weight),await r.sync(),_(o).close()}function D(){r.logout().then(()=>{n(!1),X(u,"signup"),_(o).close()})}function j(){W()}function O(){X(u,"login")}function M($){X(d,!0),fetch("https://ketnerlake.com/api/message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:"Fasting Hours",email:$.email,category:"Sign Up",subject:"Sync Interest",message:$.message})}).then(se=>se.text()).then(se=>{console.log(se),X(f,null),X(p,null),_(o).close(),X(d,!1),alert("Thanks for your message!")})}function ie(){X(u,"signup"),X(v,!1)}function ne(){W()}function re($){X(y,$,!0),X(v,!0),i({otp:$})}function W(){_(o).close(),X(u,"signup"),X(d,!1),X(f,null),X(p,null),X(a,!1),X(l,null),X(v,!1),X(y,null)}function le(){_(o).showModal()}var ce=D1(),Ie=V(ce);{var De=$=>{y1($,{ondone:I,onexport:E,onimport:S,onlogout:D})},te=$=>{var se=Ft(),ge=ut(se);{var _e=U=>{k1(U,{get disabled(){return _(d)},get email(){return _(f)},get message(){return _(p)},ondone:j,onlogin:O,onsend:M})},G=U=>{var Y=Ft(),ve=ut(Y);{var Ee=ye=>{u1(ye,{get disabled(){return _(a)},get email(){return _(l)},oncancel:b,ondone:k,onverify:x})},Me=ye=>{var ke=Ft(),oe=ut(ke);{var Pe=Be=>{I1(Be,{get disabled(){return _(v)},oncancel:ie,ondone:ne,onlogin:re,get value(){return _(y)}})};st(oe,Be=>{_(u)==="token"&&Be(Pe)},!0)}pe(ye,ke)};st(ve,ye=>{_(u)==="login"?ye(Ee):ye(Me,!1)},!0)}pe(U,Y)};st(ge,U=>{_(u)==="signup"?U(_e):U(G,!1)})}pe($,se)};st(Ie,$=>{n()?$(De):$(te,!1)})}return K(ce),yt(ce,$=>X(o,$),()=>_(o)),pe(t,ce),pt({close:W,showModal:le})}function A1(t,e,n,r){const i=_(e).getBoundingClientRect();_(n).style.width=i.width-2+"px",X(r,!_(r))}var O1=(t,e,n)=>e(_(n)),M1=Le('<li><button type="button" class="svelte-10gmc7n"><span class="svelte-10gmc7n"> </span> <span class="svelte-10gmc7n"> </span> <!></button></li>'),P1=Le('<label class="svelte-10gmc7n"><button tabindex="-1" type="button" class="svelte-10gmc7n"><!> <span class="svelte-10gmc7n"> </span> <span class="svelte-10gmc7n"> </span> <!></button> <ul></ul></label>');function j1(t,e){ht(e,!0);let n=Oe(e,"items",19,()=>[]),r=Oe(e,"units",3,"oz"),i=Oe(e,"value",7,0),o=Ce(!1),a=Ce(void 0),l=Ce(void 0),u=Ke(()=>n().length===0?"":n().find(O=>O.value===i()).label);Gn(()=>(document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}));function d(j){!_(a).contains(j.target)&&!_(l).contains(j.target)&&X(o,!1)}function f(j){i(j.value),X(o,!1),e.onchange&&e.onchange(j.value)}var p=P1(),v=V(p);v.__click=[A1,a,l,o];var y=V(v);lt(y,{height:"20",icon:"material-symbols:water-drop-outline-rounded",width:"20"});var b=Q(y,2),k=V(b,!0);K(b);var x=Q(b,2),I=V(x);K(x);var E=Q(x,2);lt(E,{height:"20",icon:"material-symbols:keyboard-arrow-down-rounded",width:"20"}),K(v),yt(v,j=>X(a,j),()=>_(a));var S=Q(v,2);let D;Qt(S,21,n,Jt,(j,O)=>{var M=M1();let ie;var ne=V(M);ne.__click=[O1,f,O];var re=V(ne),W=V(re,!0);K(re);var le=Q(re,2),ce=V(le);K(le);var Ie=Q(le,2);{var De=te=>{lt(te,{height:"20",icon:"material-symbols:check-rounded",width:"20"})};st(Ie,te=>{_(O).value===i()&&te(De)})}K(ne),K(M),qe(te=>{ie=at(M,1,"svelte-10gmc7n",null,ie,te),Re(W,_(O).label),Re(ce,`${_(O).value??""} oz`)},[()=>({selected:i()===_(O).value})]),pe(j,M)}),K(S),yt(S,j=>X(l,j),()=>_(l)),K(p),qe(j=>{Re(k,_(u)),Re(I,`${i()??""} ${r()??""}`),D=at(S,1,"svelte-10gmc7n",null,D,j)},[()=>({open:_(o)})]),pe(t,p),pt()}_t(["click"]);function L1(t,e,n,r){e(),n(null),r.oncancel&&r.oncancel()}function R1(t,e,n){e.ondelete&&e.ondelete(n().id)}function U1(t,e,n){e.onsave&&e.onsave(n())}var N1=Le('<dialog class="svelte-1kewhwu"><h3 class="svelte-1kewhwu">Edit Water</h3> <!> <!> <footer class="svelte-1kewhwu"><button class="delete svelte-1kewhwu" type="button">Delete</button> <button class="cancel svelte-1kewhwu" type="button">Cancel</button> <button type="button" class="svelte-1kewhwu">Save</button></footer></dialog>');function F1(t,e){ht(e,!0);let n=Oe(e,"item",7,null),r=Oe(e,"options",19,()=>[]),i=Oe(e,"units",3,"oz"),o=Ce(void 0),a=Ke(()=>n()&&n().volume&&n().volume!==null?n().volume:8);function l(E){const S=new Date(E.getTime());n({...n(),created:S})}function u(E){const S=E;n({...n(),volume:S})}function d(){_(o).close(),n(null)}function f(){_(o).showModal()}var p=N1(),v=Q(V(p),2);j1(v,{get items(){return r()},onchange:u,get units(){return i()},get value(){return _(a)}});var y=Q(v,2);{let E=Ke(()=>n()&&n().created?n().created:new Date);na(y,{label:"Finished",onchange:l,get value(){return _(E)}})}var b=Q(y,2),k=V(b);k.__click=[R1,e,n];var x=Q(k,2);x.__click=[L1,d,n,e];var I=Q(x,2);return I.__click=[U1,e,n],K(b),K(p),yt(p,E=>X(o,E),()=>_(o)),pe(t,p),pt({close:d,showModal:f})}_t(["click"]);function B1(t,e,n,r){e(),n(null),r.oncancel&&r.oncancel()}function K1(t,e,n){e.ondelete&&e.ondelete(n().id)}function q1(t,e){const n=t.currentTarget.value;e({...e(),weight:n})}function H1(t,e,n,r,i,o){console.log(e(),"Item"),console.log(_(n),"Weight");const a=r(_(n));if(console.log(a,"Parsed"),a===null){_(i).focus();return}else e({...e(),weight:a});e().type||e({...e(),type:"weight"}),e().created||e({...e(),created:new Date}),e({...e(),updated:new Date}),e().units||e({...e(),units:"lbs"}),o.onsave&&o.onsave(e())}var V1=(t,e,n)=>e(_(n)),z1=Le('<button class="delete svelte-1hw3www" type="button">Delete</button>'),W1=Le('<dialog class="svelte-1hw3www"><h3 class="svelte-1hw3www"> </h3> <label class="svelte-1hw3www"><!> <input inputmode="decimal" placeholder="Weight" type="text" class="svelte-1hw3www"/> <button type="button" class="svelte-1hw3www"> </button></label> <!> <footer class="svelte-1hw3www"><!> <button class="cancel svelte-1hw3www" type="button">Cancel</button> <button type="button" class="svelte-1hw3www">Save</button></footer></dialog>');function Y1(t,e){ht(e,!0);let n=Oe(e,"item",7,null),r=Ce(void 0),i=Ce(void 0),o=Ke(()=>n()&&n().units&&n().units!==null?n().units:"lbs"),a=Ke(()=>n()&&n().weight&&n().weight!==null?n().weight:"");function l(re){const W=new Date(re.getTime());n({...n(),created:W})}function u(re){const W=re==="lbs"?"kg":"lbs";n({...n(),units:W})}function d(re){if(typeof re=="number")return re;if(typeof re=="string"){const W=re.trim();if(W==="")return null;const le=navigator.language||"en-US",ce=Intl.NumberFormat(le).format(12345.6),Ie=ce.match(/12(.*?)345/)[1],De=ce.match(/345(.*?)6/)[1],te=ge=>ge.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&");let $=W.replace(new RegExp(te(Ie),"g"),"").replace(new RegExp(te(De)),".");if(/^[+-]?(?:\d+\.?\d*|\.\d+)(?:[eE][+-]?\d+)?$/.test($))return parseFloat($)}return null}function f(){_(r).close(),n(null)}function p(){_(r).showModal()}var v=W1(),y=V(v),b=V(y);K(y);var k=Q(y,2),x=V(k);lt(x,{height:"20",icon:"hugeicons:weight-scale",width:"20"});var I=Q(x,2);Us(I),I.__input=[q1,n],yt(I,re=>X(i,re),()=>_(i));var E=Q(I,2);E.__click=[V1,u,o];var S=V(E,!0);K(E),K(k);var D=Q(k,2);{let re=Ke(()=>n()&&n().created?n().created:new Date);na(D,{label:"Measured",onchange:l,get value(){return _(re)}})}var j=Q(D,2),O=V(j);{var M=re=>{var W=z1();W.__click=[K1,e,n],pe(re,W)};st(O,re=>{n()&&n().id&&n().id!==null&&re(M)})}var ie=Q(O,2);ie.__click=[B1,f,n,e];var ne=Q(ie,2);return ne.__click=[H1,n,a,d,i,e],K(j),K(v),yt(v,re=>X(r,re),()=>_(r)),qe(()=>{Re(b,`${n()===null||!n().id||n().id===null?"New":"Edit"} Weight`),Zf(I,_(a)),Re(S,_(o))}),pe(t,v),pt({close:f,showModal:p})}_t(["input","click"]);var G1=Le('<main class="svelte-s80twj"><header class="svelte-s80twj"><button class="icon svelte-s80twj" type="button"><!></button> <!> <button type="button" class="svelte-s80twj"><!></button></header> <section class="svelte-s80twj"><article class="svelte-s80twj"><!></article> <article class="svelte-s80twj"><!></article></section></main> <!> <!> <!> <!> <!>',1);function lS(t,e){ht(e,!0);let n=Ce(!1);const r=new wp;r.user().subscribe(ue=>{ue&&ue.isLoggedIn?(X(n,!0),_(j).close(),r.sync()):X(n,!1)});const o=rw;let a=0,l=Ce(null),u=Ce(0),d=Ce(null),f=Ce(zo([])),p=Ce(void 0),v=Ce("started"),y=Ce(null),b=Ce("Started"),k=Ce("Edit Fast Started"),x=Ce(void 0),I=Ce(null),E=Ce(5),S=Ce(null),D=Ce(0),j=Ce(void 0),O=Ce(null),M=Ce(null),ie=Ce(null),ne=Ce(0),re=Ce(void 0),W=Ce(null),le=Ce(zo([])),ce=Ce(void 0),Ie=Ce(null),De=zo([{value:1,label:"Starving"},{value:2,label:"Very hungry"},{value:3,label:"Pretty hungry"},{value:4,label:"Snacky"},{value:5,label:"Satisfied"},{value:6,label:"Slightly full"},{value:7,label:"Uncomfortable"},{value:8,label:"Stuffed"},{value:9,label:"Stomach aches"},{value:10,label:"Sick"}]),te=zo([{value:8,label:"Cup"},{value:12,label:"Can"},{value:16,label:"Bottle"},{value:20,label:"Medium"},{value:30,label:"Gatorade"},{value:32,label:"Big Q"},{value:44,label:"QT Large"},{value:52,label:"Extra Large"}]);Gn(()=>{let ue=window.localStorage.getItem("fh_screen");X(D,ue===null?0:parseInt(ue),!0);let Ae=window.localStorage.getItem("fh_duration");X(u,Ae===null?0:parseInt(Ae),!0);const Fe=window.localStorage.getItem("fh_latitude");Fe!==null&&Fe!=="DENIED"&&U(),setInterval(()=>{if(a===60){se();const Je=window.localStorage.getItem("fh_latitude");Je!==null&&Je!=="DENIED"&&U(),a=0}else a=a+1;_(O)!==null&&X(S,Date.now(),!0)},1e3),G(),se(),_e(),Y(),ve(),ge(),new URLSearchParams(window.location.search).has("signup")&&_(j).showModal()});function $(ue){const Ae=ue.getFullYear(),Fe=String(ue.getMonth()+1).padStart(2,"0"),ct=String(ue.getDate()).padStart(2,"0");return`${Ae}-${Fe}-${ct}`}function se(ue=7){r.browseHistory().then(Ae=>{const Fe={},ct=new Date,Je=new Date(ct.getFullYear(),ct.getMonth(),ct.getDate()),$e=new Date(Je);if($e.setDate(Je.getDate()-(ue-1)),!Array.isArray(Ae)||Ae.length===0){const ze=new Date($e);for(;ze<=Je;){const et=$(ze);Fe[et]=Array(24).fill(0),ze.setDate(ze.getDate()+1)}}else{for(const et of Ae){const Ei=new Date(et.started),Br=et.ended?new Date(et.ended):new Date,wr=new Date(Ei.getTime());wr.setSeconds(0,0);const _r=new Date(Br.getTime());_r.setSeconds(0,0);let Sn=new Date(wr);for(;Sn<_r;){const cn=$(Sn),Un=new Date(Sn.getFullYear(),Sn.getMonth(),Sn.getDate());if(Un>=$e&&Un<=Je){const xn=Sn.getHours();Fe[cn]||(Fe[cn]=Array(24).fill(0)),Fe[cn][xn]+=1}Sn.setMinutes(Sn.getMinutes()+1)}}for(const et in Fe)Fe[et]=Fe[et].map(Ei=>+(Math.min(Ei,60)/60).toFixed(6));const ze=new Date($e);for(;ze<=Je;){const et=$(ze);Fe[et]||(Fe[et]=Array(24).fill(0)),ze.setDate(ze.getDate()+1)}}const Xe=Object.keys(Fe).sort((ze,et)=>et.localeCompare(ze)),nt={};for(const ze of Xe)nt[ze]=Fe[ze];const wn=Array(24).fill(0);for(const ze of Array(24).keys())for(const et of Xe)wn[ze]+=nt[et][ze];const Fr=wn.map(ze=>+(ze/ue).toFixed(6));X(l,{daily:nt,average:Fr},!0)})}function ge(){r.browseHistory().then(ue=>{let Ae=null,Fe=structuredClone(ue);Fe.forEach(Je=>{Je.type="start",Je.timed=new Date(Je.started.getTime())});let ct=structuredClone(ue);ct=ct.filter(Je=>Je.ended!==null),ct.forEach(Je=>{Je.type="end",Je.timed=new Date(Je.ended.getTime())}),Fe=Fe.concat(ct),Ae=[...Fe],r.browseHunger().then(Je=>(Je=Je.map($e=>{const Xe=De.find(nt=>nt.value===$e.level);return $e.level=Xe.label,$e.timed=new Date($e.created.getTime()),$e}),Ae=Ae.concat(Je),r.browseWeight())).then(Je=>(Je=Je.map($e=>($e.timed=new Date($e.created.getTime()),$e)),Ae=Ae.concat(Je),r.browseWater())).then(Je=>{Je=Je.map(Xe=>(Xe.timed=new Date(Xe.created.getTime()),Xe)),Ae=Ae.concat(Je),Ae.sort((Xe,nt)=>Xe.timed.getTime()<nt.timed.getTime()?1:Xe.timed.getTime()>nt.timed.getTime()?-1:0);const $e=[];for(let Xe=0;Xe<Ae.length;Xe++){const nt=new Date(Ae[Xe].timed.getTime());nt.setHours(23),nt.setMinutes(59),nt.setSeconds(59),nt.setMilliseconds(999),$e.length===0?$e.push({type:"header",timed:nt}):($e[$e.length-1].timed.getDate()!==Ae[Xe].timed.getDate()||$e[$e.length-1].timed.getMonth()!==Ae[Xe].timed.getMonth()||$e[$e.length-1].timed.getFullYear()!==Ae[Xe].timed.getFullYear())&&$e.push({type:"header",timed:nt})}Ae=Ae.concat($e),Ae.sort((Xe,nt)=>Xe.timed.getTime()<nt.timed.getTime()?1:Xe.timed.getTime()>nt.timed.getTime()?-1:0),X(f,[...Ae],!0)})})}function _e(){r.browseHunger(!0).then(ue=>{if(ue===null)X(E,5);else{const Ae=new Date,Fe=new Date(ue.created);Ae.getFullYear()===Fe.getFullYear()&&Ae.getMonth()===Fe.getMonth()&&Ae.getDate()===Fe.getDate()?X(E,ue.level,!0):X(E,5)}})}function G(){r.browseHistory().then(ue=>{ue.length===0&&(X(O,null),X(S,null),X(d,null)),ue.sort((Ae,Fe)=>Ae.started.getTime()>Fe.started.getTime()?-1:Ae.started.getTime()<Fe.started.getTime()?1:0),ue[0].ended===null?(X(O,new Date(ue[0].started.getTime()),!0),X(S,Date.now(),!0),X(d,null)):X(d,new Date(ue[0].ended.getTime()),!0)})}function U(){const ue=parseFloat(window.localStorage.getItem("fh_latitude")),Ae=parseFloat(window.localStorage.getItem("fh_longitude")),Fe=new Date;let ct=null,Je=o.getTimes(Fe,ue,Ae),$e=null;if(Date.now()<Je.sunrise.getTime())$e=new Date(Je.sunrise.getTime()),ct="material-symbols:wb-sunny-outline-rounded";else if(Date.now()>Je.sunrise.getTime()&&Date.now()<Je.sunset.getTime())$e=new Date(Je.sunset.getTime()),ct="material-symbols:moon-stars-outline-rounded";else{const Xe=new Date;Xe.setDate(Fe.getDate()+1),Je=o.getTimes(Xe,ue,Ae),$e=new Date(Je.sunrise.getTime()),ct="material-symbols:wb-sunny-outline-rounded"}X(M,{icon:ct,timing:$e},!0)}function Y(){r.browseWater(!0).then(ue=>{const Ae=ue.reduce((Fe,ct)=>Fe+ct.volume,0);return X(ne,Ae,!0),r.browseWater()}).then(ue=>{const Ae=new Date;Ae.setHours(0,0,0,0);const Fe={};for(const{created:Xe,volume:nt}of ue){const wn=Ee(Xe);Fe[wn]=(Fe[wn]||0)+nt}const ct=[];for(let Xe=0;Xe<7;Xe++){const nt=new Date(Ae.getTime());nt.setDate(Ae.getDate()-Xe);const wn=Ee(nt);ct.push({created:new Date(nt.getTime()),volume:Fe[wn]||0})}const $e=ct.reduce((Xe,{volume:nt})=>Xe+nt,0)/ct.length;X(ie,{average:$e,daily:[...ct]},!0)})}function ve(){r.browseWeight().then(ue=>X(le,ue===null?[]:[...ue],!0))}function Ee(ue){const Ae=ue.getFullYear(),Fe=String(ue.getMonth()+1).padStart(2,"0"),ct=String(ue.getDate()).padStart(2,"0");return`${Ae}-${Fe}-${ct}`}function Me(ue){X(u,ue,!0),window.localStorage.setItem("fh_duration",_(u))}function ye(){X(O,null),X(S,null),r.browseHistoryByEnd().then(ue=>(ue.ended=new Date,r.editHistory(ue))).then(()=>{G(),se(),ge()})}function ke(){r.addHistory().then(()=>{G(),se(),ge()})}function oe(){_(ce).showModal()}function Pe(ue,Ae){console.log("Delete: "+Ae),_(O)!==null&&_(y).started.getTime()===_(O).getTime()&&(X(O,null),X(S,null)),r.deleteHistory(Ae).then(()=>{_(p).close(),X(y,null),G(),se(),ge()})}function Be(ue){r.editHistory(ue).then(()=>{_(p).close(),X(y,null),G(),se(),ge()})}function Se(ue,Ae){ue==="start"?(X(v,"started"),X(b,"Started"),X(k,"Edit Fast Started"),r.readHistory(Ae).then(Fe=>{X(y,{...Fe},!0),_(p).showModal()})):ue==="end"?(X(v,"ended"),X(b,"Ended"),X(k,"Edit Fast Ended"),r.readHistory(Ae).then(Fe=>{X(y,{...Fe},!0),_(p).showModal()})):ue==="water"?r.readWater(Ae).then(Fe=>{X(W,{...Fe},!0),_(re).showModal()}):ue==="weight"?r.readWeight(Ae).then(Fe=>{X(Ie,{...Fe},!0),_(ce).showModal()}):ue==="hunger"&&r.readHunger(Ae).then(Fe=>{X(I,{...Fe},!0),_(x).showModal()})}function Ne(ue){r.addHunger(ue).then(Ae=>{_e(),ge()})}function Ue(ue){r.deleteHunger(ue).then(()=>{_(x).close(),X(I,null),_e(),ge()})}function Ve(ue){r.editHunger(ue).then(Ae=>{_(x).close(),X(I,null),_e(),ge()})}function mt(ue){_(D)!==ue&&(window.localStorage.setItem("fh_screen",ue),X(D,ue,!0))}function kt(){_(j).showModal()}function vt(){confirm("Sunrise/set (important for religious observations) needs to know your location? Enable location detection?")?navigator.geolocation.getCurrentPosition(Ae=>{window.localStorage.setItem("fh_latitude",Ae.coords.latitude),window.localStorage.setItem("fh_longitude",Ae.coords.longitude),U()}):window.localStorage.setItem("fh_latitude","DENIED")}function Yt(ue){r.addWater(ue).then(Ae=>{Y(),ge()})}function Xt(ue){r.deleteWater(ue).then(()=>{_(re).close(),X(W,null),Y(),ge()})}function bt(ue){r.editWater(ue).then(Ae=>{_(re).close(),X(W,null),Y(),ge()})}function Ln(ue){r.deleteWeight(ue).then(()=>{_(ce).close(),X(Ie,null),ve(),ge()})}function yr(ue){console.log(ue),ue.id?r.editWeight(ue).then(Ae=>{_(ce).close(),X(Ie,null),ve(),ge()}):r.addWeight(ue).then(Ae=>{_(ce).close(),X(Ie,null),ve(),ge()})}var _i=G1(),Rn=ut(_i),yn=V(Rn),ln=V(yn);ln.__click=oe;var ki=V(ln);lt(ki,{height:"20",icon:"hugeicons:weight-scale",width:"20"}),K(ln);var $n=Q(ln,2);o1($n,{onchange:mt,get value(){return _(D)}});var mr=Q($n,2);mr.__click=kt;var Nr=V(mr);lt(Nr,{height:"20",icon:"material-symbols:person-outline-rounded",width:"20"}),K(mr),K(yn);var mn=Q(yn,2),er=V(mn),Si=V(er);fk(Si,{get activity(){return _(l)},get duration(){return _(u)},get ended(){return _(d)},get hunger(){return _(E)},get levels(){return De},get now(){return _(S)},onduration:Me,onend:ye,onhunger:Ne,onsettings:kt,onstart:ke,onsun:vt,onwater:Yt,onweight:oe,get started(){return _(O)},get sun(){return _(M)},get volume(){return _(ie)},get volumes(){return te},get water(){return _(ne)},get weight(){return _(le)}}),K(er);var bn=Q(er,2),je=V(bn);zk(je,{get activity(){return _(l)},get history(){return _(f)},get levels(){return De},onchange:Se,onsun:vt,get sun(){return _(M)},get volume(){return _(ie)},get weight(){return _(le)}}),K(bn),K(mn),K(Rn);var tr=Q(Rn,2);yt(Mk(tr,{get field(){return _(v)},get item(){return _(y)},get label(){return _(b)},ondelete:Pe,onsave:Be,get title(){return _(k)}}),ue=>X(p,ue,!0),()=>_(p));var kn=Q(tr,2);yt(t1(kn,{get item(){return _(I)},get levels(){return De},ondelete:Ue,onsave:Ve}),ue=>X(x,ue,!0),()=>_(x));var br=Q(kn,2);yt(F1(br,{get item(){return _(W)},ondelete:Xt,onsave:bt,get options(){return te}}),ue=>X(re,ue,!0),()=>_(re));var be=Q(br,2);yt(Y1(be,{get item(){return _(Ie)},ondelete:Ln,onsave:yr}),ue=>X(ce,ue,!0),()=>_(ce));var xi=Q(be,2);yt(T1(xi,{get authenticated(){return _(n)}}),ue=>X(j,ue,!0),()=>_(j)),qe(()=>Ct(mn,"data-screen",_(D)===0?"fasting":"hours")),pe(t,_i),pt()}_t(["click"]);export{lS as component};
